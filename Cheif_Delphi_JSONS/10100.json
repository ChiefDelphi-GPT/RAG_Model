{
    "data": {
        "post_stream": {
            "posts": [
                {
                    "id": 3237518,
                    "name": "",
                    "username": "SirFire",
                    "avatar_template": "/user_avatar/www.chiefdelphi.com/sirfire/{size}/222590_2.png",
                    "created_at": "2023-10-04T16:33:49.709Z",
                    "cooked": "Greetings,\n\nThe Problem I am the only programmer on a small team, and I’ve been trying to get out WCP swerve drive modules working since last build season until now. We’ve tried many things, but so far we just can’t hit the nail on the head, as it were. I’ve tried posting more specific questions here along the way, but I am now so completely lost that I’m not sure what to check next.\n\nI understand that the question I’m asking is extremely vague, and I will do my best to provide as much information as I can to make it less so.\n\nBackground Knowledge The code repository in question is https://github.com/SirFireE/Swerve8551 . Please note that I may be actively making new commits to this repository in the future. Our swerve modules, as mentioned, are WCP swerve drive modules with Rev NEO motors and CTRE CANCoders. We have confirmed that all of this hardware works as expected. Our spark motor controllers are currently factory reset, and our CANCoders are factory settings except for absolute magnetic offset.\n\nProgram History We received our CANCoders about a month ago, and since then, we have been trying to simply set the position of one module. Our first attempt was to use the WPILib PIDController class, and call .calculate() periodically, every 20ms, and set the returned value directly to the motor using the CANSparkMax ’s set() method. The result of this was that the motor always overshot the target and was shaking violently, or sometimes the motor did not move at all, even though the PID error was large.\n\nWe also tried using the PIDController for all four modules in the code repo mentioned above, but they were not outputting any value no matter what the setpoint was. We did confirm that the SwerveModuleState s were updating and working as expected based on the Joystick inputs.\n\nEven before this, we’ve had much better success with the SparkMaxPIDController , but it does not take the CANCoder as an argument for setFeedbackDevice() . My weird idea to fix this was to get a RelativeEncoder object and set its position to the CANCoder ’s absolute position periodically, again, every 20ms, and set the SparkMaxPIDController ’s feedback device to the RelativeEncoder . This actually did work, but only with a very low PID proportional term (0.2) and a very high PID derivative term (0.7). The movement of the motor was fairly slow, (As expected) and sometimes the motor wouldn’t move for some reason, but we were willing to start with that as that was the best we had.\n\nWith that, we set up the same thing with all four swerve modules, as can be seen in our code repo here . The result of this was that all of the modules were overshooting their setpoint and shaking, even with the same PID terms as before (P: 0.2, D: 0.7). This was all in our last meeting, so that’s as much as we’ve found thus far.\n\nConclusion All of this has been very frustrating to me personally as the only programmer because I do feel like I’m missing something obvious, but I’m not sure… We’re really hoping that we can get our swerve drive working before the 2024 reveal. I’m wondering if there is something completely obvious in our existing code that I’m just not seeing. I will try my best to provide more information as this goes along, and even if it only barely works at the end of this, I and my team will be so so so thankful for your help! We are still a relatively new and small team, so swerve drive was a big thing for us. Hope y’all have a fantastic day.",
                    "post_number": 1,
                    "post_type": 1,
                    "posts_count": 24,
                    "updated_at": "2023-10-04T16:33:49.709Z",
                    "reply_count": 1,
                    "reply_to_post_number": null,
                    "quote_count": 0,
                    "incoming_link_count": 184,
                    "reads": 402,
                    "readers_count": 401,
                    "score": 1005.4,
                    "yours": false,
                    "topic_id": 441868,
                    "topic_slug": "why-doesnt-this-swerve-code-work",
                    "display_username": "",
                    "primary_group_name": null,
                    "flair_name": null,
                    "flair_url": null,
                    "flair_bg_color": null,
                    "flair_color": null,
                    "flair_group_id": null,
                    "badges_granted": [],
                    "version": 1,
                    "can_edit": false,
                    "can_delete": false,
                    "can_recover": false,
                    "can_see_hidden_post": true,
                    "can_wiki": false,
                    "link_counts": [
                        {
                            "url": "https://github.com/SirFireE/Swerve8551",
                            "internal": false,
                            "reflection": false,
                            "title": "GitHub - SirFireE/Swerve8551",
                            "clicks": 53
                        },
                        {
                            "url": "https://github.com/SirFireE/Swerve8551/blob/main/src/main/java/frc/robot/subsystems/SwerveModule.java",
                            "internal": false,
                            "reflection": false,
                            "clicks": 7
                        }
                    ],
                    "read": true,
                    "user_title": null,
                    "bookmarked": false,
                    "actions_summary": [],
                    "moderator": false,
                    "admin": false,
                    "staff": false,
                    "user_id": 54317,
                    "hidden": false,
                    "trust_level": 2,
                    "deleted_at": null,
                    "user_deleted": false,
                    "edit_reason": null,
                    "can_view_edit_history": true,
                    "wiki": false,
                    "user_custom_fields": {
                        "user_field_4": "Main Programmer Dude | 8551"
                    },
                    "post_url": "/t/why-doesnt-this-swerve-code-work/441868/1",
                    "custom_user_title": "Main Programmer Dude | 8551",
                    "reactions": [],
                    "current_user_reaction": null,
                    "reaction_users_count": 0,
                    "current_user_used_main_reaction": false,
                    "can_accept_answer": false,
                    "can_unaccept_answer": false,
                    "accepted_answer": false,
                    "topic_accepted_answer": true,
                    "can_vote": false
                },
                {
                    "id": 3237553,
                    "name": null,
                    "username": "shush",
                    "avatar_template": "/letter_avatar_proxy/v4/letter/s/aeb1de/{size}.png",
                    "created_at": "2023-10-04T18:09:52.114Z",
                    "cooked": "SirFire:\n\nMy weird idea to fix this was to get a RelativeEncoder object and set its position to the CANCoder ’s absolute position periodically, again, every 20ms, and set the SparkMaxPIDController ’s feedback device to the RelativeEncoder . This actually did work, but only with a very low PID proportional term (0.2) and a very high PID derivative term (0.7). The movement of the motor was fairly slow, (As expected) and sometimes the motor wouldn’t move for some reason, but we were willing to start with that as that was the best we had.\n\nThe relative encoder measures the position of the motor shaft. For this solution to work, you’ ll have to set a conversion factor equal to the gear ratio, so the relative encoder will measure the position of module. I glanced at your code and didn’t see you do that, but maybe I just missed it.",
                    "post_number": 2,
                    "post_type": 1,
                    "posts_count": 24,
                    "updated_at": "2023-10-04T18:14:54.650Z",
                    "reply_count": 1,
                    "reply_to_post_number": null,
                    "quote_count": 1,
                    "incoming_link_count": 2,
                    "reads": 323,
                    "readers_count": 322,
                    "score": 94.6,
                    "yours": false,
                    "topic_id": 441868,
                    "topic_slug": "why-doesnt-this-swerve-code-work",
                    "display_username": null,
                    "primary_group_name": null,
                    "flair_name": null,
                    "flair_url": null,
                    "flair_bg_color": null,
                    "flair_color": null,
                    "flair_group_id": null,
                    "badges_granted": [],
                    "version": 2,
                    "can_edit": false,
                    "can_delete": false,
                    "can_recover": false,
                    "can_see_hidden_post": true,
                    "can_wiki": false,
                    "read": true,
                    "user_title": null,
                    "bookmarked": false,
                    "actions_summary": [
                        {
                            "id": 2,
                            "count": 1
                        }
                    ],
                    "moderator": false,
                    "admin": false,
                    "staff": false,
                    "user_id": 51472,
                    "hidden": false,
                    "trust_level": 2,
                    "deleted_at": null,
                    "user_deleted": false,
                    "edit_reason": null,
                    "can_view_edit_history": true,
                    "wiki": false,
                    "user_custom_fields": {
                        "user_field_4": "Programming"
                    },
                    "post_url": "/t/why-doesnt-this-swerve-code-work/441868/2",
                    "custom_user_title": "Programming",
                    "reactions": [
                        {
                            "id": "heart",
                            "type": "emoji",
                            "count": 1
                        }
                    ],
                    "current_user_reaction": null,
                    "reaction_users_count": 1,
                    "current_user_used_main_reaction": false,
                    "can_accept_answer": false,
                    "can_unaccept_answer": false,
                    "accepted_answer": false,
                    "topic_accepted_answer": true
                },
                {
                    "id": 3237682,
                    "name": "",
                    "username": "SirFire",
                    "avatar_template": "/user_avatar/www.chiefdelphi.com/sirfire/{size}/222590_2.png",
                    "created_at": "2023-10-04T23:16:01.659Z",
                    "cooked": "That is an excellent point, and I do know that it’s the ideal way to do it, but I chose to do my weird way at the time because I’m not entirely sure what our gear ratio actually is. That will be my goal for next meeting. I’ll post an update here as to what we get from that.",
                    "post_number": 3,
                    "post_type": 1,
                    "posts_count": 24,
                    "updated_at": "2023-10-04T23:16:01.659Z",
                    "reply_count": 0,
                    "reply_to_post_number": 2,
                    "quote_count": 0,
                    "incoming_link_count": 1,
                    "reads": 295,
                    "readers_count": 294,
                    "score": 64.0,
                    "yours": false,
                    "topic_id": 441868,
                    "topic_slug": "why-doesnt-this-swerve-code-work",
                    "display_username": "",
                    "primary_group_name": null,
                    "flair_name": null,
                    "flair_url": null,
                    "flair_bg_color": null,
                    "flair_color": null,
                    "flair_group_id": null,
                    "badges_granted": [],
                    "version": 1,
                    "can_edit": false,
                    "can_delete": false,
                    "can_recover": false,
                    "can_see_hidden_post": true,
                    "can_wiki": false,
                    "read": true,
                    "user_title": null,
                    "reply_to_user": {
                        "id": 51472,
                        "username": "shush",
                        "name": null,
                        "avatar_template": "/letter_avatar_proxy/v4/letter/s/aeb1de/{size}.png"
                    },
                    "bookmarked": false,
                    "actions_summary": [],
                    "moderator": false,
                    "admin": false,
                    "staff": false,
                    "user_id": 54317,
                    "hidden": false,
                    "trust_level": 2,
                    "deleted_at": null,
                    "user_deleted": false,
                    "edit_reason": null,
                    "can_view_edit_history": true,
                    "wiki": false,
                    "user_custom_fields": {
                        "user_field_4": "Main Programmer Dude | 8551"
                    },
                    "post_url": "/t/why-doesnt-this-swerve-code-work/441868/3",
                    "custom_user_title": "Main Programmer Dude | 8551",
                    "reactions": [],
                    "current_user_reaction": null,
                    "reaction_users_count": 0,
                    "current_user_used_main_reaction": false,
                    "can_accept_answer": false,
                    "can_unaccept_answer": false,
                    "accepted_answer": false,
                    "topic_accepted_answer": true
                },
                {
                    "id": 3239099,
                    "name": "",
                    "username": "SirFire",
                    "avatar_template": "/user_avatar/www.chiefdelphi.com/sirfire/{size}/222590_2.png",
                    "created_at": "2023-10-10T23:45:53.577Z",
                    "cooked": "Hello again, I’m currently at a meeting but taking a break from programming because some mechanical work is being done to the robot. I’ve attempted to set up a normal PIDController setup with two of our modules. (the other two are under maintenance) I’ve updated the code repository to the code I’ve tried tonight. The results of running this code was that the the motors, again, would either spin or shake rapidly, or the motor simply wouldn’t move at all, despite the PIDController outputting a sufficient value to move the motor, and despite testing several different PID values. Currently one of the turn motors actually froze after running this code, but the other ones are fine. Not sure if that’s related or not. It’d be great if I could get some feedback before I leave the shop. Please let me know what other info I need to send.",
                    "post_number": 4,
                    "post_type": 1,
                    "posts_count": 24,
                    "updated_at": "2023-10-10T23:45:53.577Z",
                    "reply_count": 1,
                    "reply_to_post_number": null,
                    "quote_count": 0,
                    "incoming_link_count": 0,
                    "reads": 245,
                    "readers_count": 244,
                    "score": 54.0,
                    "yours": false,
                    "topic_id": 441868,
                    "topic_slug": "why-doesnt-this-swerve-code-work",
                    "display_username": "",
                    "primary_group_name": null,
                    "flair_name": null,
                    "flair_url": null,
                    "flair_bg_color": null,
                    "flair_color": null,
                    "flair_group_id": null,
                    "badges_granted": [],
                    "version": 1,
                    "can_edit": false,
                    "can_delete": false,
                    "can_recover": false,
                    "can_see_hidden_post": true,
                    "can_wiki": false,
                    "read": true,
                    "user_title": null,
                    "bookmarked": false,
                    "actions_summary": [],
                    "moderator": false,
                    "admin": false,
                    "staff": false,
                    "user_id": 54317,
                    "hidden": false,
                    "trust_level": 2,
                    "deleted_at": null,
                    "user_deleted": false,
                    "edit_reason": null,
                    "can_view_edit_history": true,
                    "wiki": false,
                    "user_custom_fields": {
                        "user_field_4": "Main Programmer Dude | 8551"
                    },
                    "post_url": "/t/why-doesnt-this-swerve-code-work/441868/4",
                    "custom_user_title": "Main Programmer Dude | 8551",
                    "reactions": [],
                    "current_user_reaction": null,
                    "reaction_users_count": 0,
                    "current_user_used_main_reaction": false,
                    "can_accept_answer": false,
                    "can_unaccept_answer": false,
                    "accepted_answer": false,
                    "topic_accepted_answer": true
                },
                {
                    "id": 3240131,
                    "name": null,
                    "username": "shush",
                    "avatar_template": "/letter_avatar_proxy/v4/letter/s/aeb1de/{size}.png",
                    "created_at": "2023-10-13T05:55:42.625Z",
                    "cooked": "You don’t call configAbslouteSensorRange on your CANCoder, nor do you call restoreFactoryDefaults. And since this is a persistent config, you don’t know if your CANCoder is measuring 0 to 360, or 180 to -180. So you should take care of that.\n\nYou don’t call configAbslouteSensorRange on your CANCoder, nor do you call restoreFactoryDefaults. And since this is a persistent config, you don’t know if your CANCoder is measuring 0 to 360, or 180 to -180. So you should take care of that.\n\nMake sure anything that needs to be inverted is, and nothing else. I’m not familiar with the WCP swerve, so that’s up to you. (Side note, instead of adding a minus sign like you did, you can call configSensorDirection).\n\nMake sure anything that needs to be inverted is, and nothing else. I’m not familiar with the WCP swerve, so that’s up to you. (Side note, instead of adding a minus sign like you did, you can call configSensorDirection).\n\nSpin the module by hand, look at the CANCoder’s measurements, and make sure they’re really what your code expects them to be.\n\nSpin the module by hand, look at the CANCoder’s measurements, and make sure they’re really what your code expects them to be.",
                    "post_number": 5,
                    "post_type": 1,
                    "posts_count": 24,
                    "updated_at": "2023-10-13T05:55:42.625Z",
                    "reply_count": 1,
                    "reply_to_post_number": 4,
                    "quote_count": 0,
                    "incoming_link_count": 0,
                    "reads": 202,
                    "readers_count": 201,
                    "score": 45.4,
                    "yours": false,
                    "topic_id": 441868,
                    "topic_slug": "why-doesnt-this-swerve-code-work",
                    "display_username": null,
                    "primary_group_name": null,
                    "flair_name": null,
                    "flair_url": null,
                    "flair_bg_color": null,
                    "flair_color": null,
                    "flair_group_id": null,
                    "badges_granted": [],
                    "version": 1,
                    "can_edit": false,
                    "can_delete": false,
                    "can_recover": false,
                    "can_see_hidden_post": true,
                    "can_wiki": false,
                    "read": true,
                    "user_title": null,
                    "reply_to_user": {
                        "id": 54317,
                        "username": "SirFire",
                        "name": "",
                        "avatar_template": "/user_avatar/www.chiefdelphi.com/sirfire/{size}/222590_2.png"
                    },
                    "bookmarked": false,
                    "actions_summary": [],
                    "moderator": false,
                    "admin": false,
                    "staff": false,
                    "user_id": 51472,
                    "hidden": false,
                    "trust_level": 2,
                    "deleted_at": null,
                    "user_deleted": false,
                    "edit_reason": null,
                    "can_view_edit_history": true,
                    "wiki": false,
                    "user_custom_fields": {
                        "user_field_4": "Programming"
                    },
                    "post_url": "/t/why-doesnt-this-swerve-code-work/441868/5",
                    "custom_user_title": "Programming",
                    "reactions": [],
                    "current_user_reaction": null,
                    "reaction_users_count": 0,
                    "current_user_used_main_reaction": false,
                    "can_accept_answer": false,
                    "can_unaccept_answer": false,
                    "accepted_answer": false,
                    "topic_accepted_answer": true
                },
                {
                    "id": 3241260,
                    "name": "Allen Nuttle",
                    "username": "nuttle",
                    "avatar_template": "/user_avatar/www.chiefdelphi.com/nuttle/{size}/124105_2.png",
                    "created_at": "2023-10-16T01:30:10.879Z",
                    "cooked": "If you have the positive rotation of the motor backwards from the sensor, this can make your PID control unworkable.  (As shush has pointed out.)  Check this very carefully.\n\nProfiledPIDController works much better than regular PIDController, in my experience.  You should be able to set I and D to 0 this way, so you only have to tune P.  You do have to provide max. velocity and max. acceleration with this class, but you can measure max. velocity pretty easily.  Max. acceleration isn’t much harder to measure, but you can start with a low estimate and see how that works – maybe take the motor’s theoretical max. acceleration with no load and divide by two or three.\n\nI’d start with just using the absolute encoder to control things.  Trying to reset the built-in relative encoder every 20ms is probably not going to work well.  One issue is there are small time delays in all of the CAN messages, so doing this properly when things are moving can be really hard to do.  Since you are effectively running at least part of the control loop on the RIO anyhow, there’s not much point in using the built-in relative encoder.  It has pretty low resolution, and it’s really more for where you don’t have any other sensor or are running control directly on the motor controller.\n\nTaking a step back, getting swerve working on your own code can be fairly involved, so you really want to go step-by-step in a systematic way.  Make sure you can run your motor controllers, and check that when you command positive rotation, the steering turns counter-clockwise (as viewed from above).  Then check that your sensors are returning reasonable values and that positive rotation of the steering results in increasing steering angle readings.  You can check to be sure your offsets are at least close at this point.  If you are doing your own code, the zero position is up to you, but having zero be straight ahead is the usual convention and works best when using WPILib.  (See https://docs.wpilib.org/en/stable/docs/software/advanced-controls/geometry/coordinate-systems.html. )\n\nOnce you are sure this is all good, you can focus on the code.  Start with the general algorithm and know how you want things to work, then work through the code a step at a time.  At a high level, you want to find the steering angle by reading the absolute sensor, to compute the desired steering angle, and to derive an error from the difference between the two.  Then, use the error to work out what to command the motor to do.  The ProfiledPIDController class does most of the control for you, and the WPILib SwerveDrive classes can give you the desired steering angle for each module.\n\nThe other part of this is using information from past computations and sensor readings to do things like find the D and I values that are used in PID computations.  Or, in the case of ProfiledPID controller, to do motion planning.  This is where you are probably best off reading the docs, or starting from some code that’s already been debugged.  You can simplify though, for example by commanding your steering angles based only on button pressed for a few fixed angles.\n\nIf your issues are things like improperly tuned PID or not having directions inverted in the right places, it’s generally hard to work out from just the code.  On the other side of things, a problem in the algorithm/approach can sometimes be found just from a high-level description.  If nothing else, the relative encoder is complicating things, so my recommendation is to take that out, at least until things are working with a simpler set up.",
                    "post_number": 6,
                    "post_type": 1,
                    "posts_count": 24,
                    "updated_at": "2023-10-16T01:35:18.984Z",
                    "reply_count": 0,
                    "reply_to_post_number": null,
                    "quote_count": 0,
                    "incoming_link_count": 1,
                    "reads": 192,
                    "readers_count": 191,
                    "score": 43.4,
                    "yours": false,
                    "topic_id": 441868,
                    "topic_slug": "why-doesnt-this-swerve-code-work",
                    "display_username": "Allen Nuttle",
                    "primary_group_name": null,
                    "flair_name": null,
                    "flair_url": null,
                    "flair_bg_color": null,
                    "flair_color": null,
                    "flair_group_id": null,
                    "badges_granted": [],
                    "version": 2,
                    "can_edit": false,
                    "can_delete": false,
                    "can_recover": false,
                    "can_see_hidden_post": true,
                    "can_wiki": false,
                    "link_counts": [
                        {
                            "url": "https://docs.wpilib.org/en/stable/docs/software/advanced-controls/geometry/coordinate-systems.html.",
                            "internal": false,
                            "reflection": false,
                            "clicks": 4
                        }
                    ],
                    "read": true,
                    "user_title": "",
                    "bookmarked": false,
                    "actions_summary": [],
                    "moderator": false,
                    "admin": false,
                    "staff": false,
                    "user_id": 14283,
                    "hidden": false,
                    "trust_level": 2,
                    "deleted_at": null,
                    "user_deleted": false,
                    "edit_reason": null,
                    "can_view_edit_history": true,
                    "wiki": false,
                    "user_custom_fields": {
                        "user_field_4": ""
                    },
                    "post_url": "/t/why-doesnt-this-swerve-code-work/441868/6",
                    "custom_user_title": null,
                    "reactions": [],
                    "current_user_reaction": null,
                    "reaction_users_count": 0,
                    "current_user_used_main_reaction": false,
                    "can_accept_answer": false,
                    "can_unaccept_answer": false,
                    "accepted_answer": false,
                    "topic_accepted_answer": true
                },
                {
                    "id": 3241712,
                    "name": "",
                    "username": "SirFire",
                    "avatar_template": "/user_avatar/www.chiefdelphi.com/sirfire/{size}/222590_2.png",
                    "created_at": "2023-10-16T23:42:07.186Z",
                    "cooked": "I’ve set that setting via the Tuner X tool and saved it. Is there an advantage to 0 to 360 or 180 to -180 or does it matter?\n\nI believe that everything that should be inverted is, though I will verify this. I should be expecting positive voltage and positive encoder position to be the same direction once properly inverted, correct?\n\nI have done this, though my measurements are entirely dependent on the question in my second point.",
                    "post_number": 7,
                    "post_type": 1,
                    "posts_count": 24,
                    "updated_at": "2023-10-16T23:42:07.186Z",
                    "reply_count": 1,
                    "reply_to_post_number": 5,
                    "quote_count": 0,
                    "incoming_link_count": 0,
                    "reads": 139,
                    "readers_count": 138,
                    "score": 32.8,
                    "yours": false,
                    "topic_id": 441868,
                    "topic_slug": "why-doesnt-this-swerve-code-work",
                    "display_username": "",
                    "primary_group_name": null,
                    "flair_name": null,
                    "flair_url": null,
                    "flair_bg_color": null,
                    "flair_color": null,
                    "flair_group_id": null,
                    "badges_granted": [],
                    "version": 1,
                    "can_edit": false,
                    "can_delete": false,
                    "can_recover": false,
                    "can_see_hidden_post": true,
                    "can_wiki": false,
                    "read": true,
                    "user_title": null,
                    "reply_to_user": {
                        "id": 51472,
                        "username": "shush",
                        "name": null,
                        "avatar_template": "/letter_avatar_proxy/v4/letter/s/aeb1de/{size}.png"
                    },
                    "bookmarked": false,
                    "actions_summary": [],
                    "moderator": false,
                    "admin": false,
                    "staff": false,
                    "user_id": 54317,
                    "hidden": false,
                    "trust_level": 2,
                    "deleted_at": null,
                    "user_deleted": false,
                    "edit_reason": null,
                    "can_view_edit_history": true,
                    "wiki": false,
                    "user_custom_fields": {
                        "user_field_4": "Main Programmer Dude | 8551"
                    },
                    "post_url": "/t/why-doesnt-this-swerve-code-work/441868/7",
                    "custom_user_title": "Main Programmer Dude | 8551",
                    "reactions": [],
                    "current_user_reaction": null,
                    "reaction_users_count": 0,
                    "current_user_used_main_reaction": false,
                    "can_accept_answer": false,
                    "can_unaccept_answer": false,
                    "accepted_answer": false,
                    "topic_accepted_answer": true
                },
                {
                    "id": 3241891,
                    "name": null,
                    "username": "shush",
                    "avatar_template": "/letter_avatar_proxy/v4/letter/s/aeb1de/{size}.png",
                    "created_at": "2023-10-17T07:25:28.269Z",
                    "cooked": "SirFire:\n\nI’ve set that setting via the Tuner X tool\n\nI reccomend setting configs in the code, not in the Tuner. That way you always get the settings you want, even if you have to change an encoder or motor controller, or if you run different code that uses different settings.\n\nSirFire:\n\nIs there an advantage to 0 to 360 or 180 to -180\n\nThere isn’t an advantage to one or the other, but there are certain pieces of code that rely on it being one or the other, and if it isn’t, the code doesn’t do what you want (e.g. enableContinousInput). Also, if I remember correctly, the kinematics supplies SwerveModuleStates that have -180 to 180 rotation.\n\nSirFire:\n\nI should be expecting positive voltage and positive encoder position to be the same direction once properly inverted, correct?\n\nCorrect! And as @nuttle pointed out, this should be counter-clockwise.\n\nSirFire:\n\nI have done this\n\nGreat",
                    "post_number": 8,
                    "post_type": 1,
                    "posts_count": 24,
                    "updated_at": "2023-10-17T08:02:24.455Z",
                    "reply_count": 1,
                    "reply_to_post_number": 7,
                    "quote_count": 1,
                    "incoming_link_count": 4,
                    "reads": 131,
                    "readers_count": 130,
                    "score": 51.2,
                    "yours": false,
                    "topic_id": 441868,
                    "topic_slug": "why-doesnt-this-swerve-code-work",
                    "display_username": null,
                    "primary_group_name": null,
                    "flair_name": null,
                    "flair_url": null,
                    "flair_bg_color": null,
                    "flair_color": null,
                    "flair_group_id": null,
                    "badges_granted": [],
                    "version": 3,
                    "can_edit": false,
                    "can_delete": false,
                    "can_recover": false,
                    "can_see_hidden_post": true,
                    "can_wiki": false,
                    "read": true,
                    "user_title": null,
                    "bookmarked": false,
                    "actions_summary": [],
                    "moderator": false,
                    "admin": false,
                    "staff": false,
                    "user_id": 51472,
                    "hidden": false,
                    "trust_level": 2,
                    "deleted_at": null,
                    "user_deleted": false,
                    "edit_reason": null,
                    "can_view_edit_history": true,
                    "wiki": false,
                    "user_custom_fields": {
                        "user_field_4": "Programming"
                    },
                    "post_url": "/t/why-doesnt-this-swerve-code-work/441868/8",
                    "custom_user_title": "Programming",
                    "reactions": [],
                    "current_user_reaction": null,
                    "reaction_users_count": 0,
                    "current_user_used_main_reaction": false,
                    "can_accept_answer": false,
                    "can_unaccept_answer": false,
                    "accepted_answer": false,
                    "topic_accepted_answer": true
                },
                {
                    "id": 3242264,
                    "name": "",
                    "username": "SirFire",
                    "avatar_template": "/user_avatar/www.chiefdelphi.com/sirfire/{size}/222590_2.png",
                    "created_at": "2023-10-17T23:26:12.221Z",
                    "cooked": "I’m now setting the CANCoder configuration via the code. I am running this to set the encoder range:\n\nFor some reason, however, the readings from m_canCoder.getAbsolutePosition() are still showing 0 to 360. For example, when the wheel is turned 45 degrees to the left, it shows 315 degrees instead of -45. Any idea why this is happening? This is not inside the code repository in the original post by the way. Any idea why this is happening? EDIT: Always learning things the hard way here at RoNex Robotics… Using the Shuffleboard gyro widget will convert -180 to 180, to 0 to 360. Not sure why it does that but in any case, that problem is solved.\n\nOn another note, I have confirmed that the motor and the encoder are working as intended. They are rotating in the same direction.",
                    "post_number": 9,
                    "post_type": 1,
                    "posts_count": 24,
                    "updated_at": "2023-10-17T23:30:23.108Z",
                    "reply_count": 0,
                    "reply_to_post_number": 8,
                    "quote_count": 0,
                    "incoming_link_count": 0,
                    "reads": 109,
                    "readers_count": 108,
                    "score": 21.8,
                    "yours": false,
                    "topic_id": 441868,
                    "topic_slug": "why-doesnt-this-swerve-code-work",
                    "display_username": "",
                    "primary_group_name": null,
                    "flair_name": null,
                    "flair_url": null,
                    "flair_bg_color": null,
                    "flair_color": null,
                    "flair_group_id": null,
                    "badges_granted": [],
                    "version": 2,
                    "can_edit": false,
                    "can_delete": false,
                    "can_recover": false,
                    "can_see_hidden_post": true,
                    "can_wiki": false,
                    "read": true,
                    "user_title": null,
                    "reply_to_user": {
                        "id": 51472,
                        "username": "shush",
                        "name": null,
                        "avatar_template": "/letter_avatar_proxy/v4/letter/s/aeb1de/{size}.png"
                    },
                    "bookmarked": false,
                    "actions_summary": [],
                    "moderator": false,
                    "admin": false,
                    "staff": false,
                    "user_id": 54317,
                    "hidden": false,
                    "trust_level": 2,
                    "deleted_at": null,
                    "user_deleted": false,
                    "edit_reason": null,
                    "can_view_edit_history": true,
                    "wiki": false,
                    "user_custom_fields": {
                        "user_field_4": "Main Programmer Dude | 8551"
                    },
                    "post_url": "/t/why-doesnt-this-swerve-code-work/441868/9",
                    "custom_user_title": "Main Programmer Dude | 8551",
                    "reactions": [],
                    "current_user_reaction": null,
                    "reaction_users_count": 0,
                    "current_user_used_main_reaction": false,
                    "can_accept_answer": false,
                    "can_unaccept_answer": false,
                    "accepted_answer": false,
                    "topic_accepted_answer": true
                },
                {
                    "id": 3242275,
                    "name": "",
                    "username": "SirFire",
                    "avatar_template": "/user_avatar/www.chiefdelphi.com/sirfire/{size}/222590_2.png",
                    "created_at": "2023-10-17T23:51:49.774Z",
                    "cooked": "Alright here’s a problem that’s been persistent among the last several meetings. I have a PIDController with a P term of 1, I and D terms of 0. If I supply a setpoint of Math.PI / 4, (45deg) the PID error is 0.78 when the wheel is at 0 degrees. This seems pretty high to me already, and then if I turn the wheel to -45 degrees, the PID error is 1.5. At -135 degrees, the PID error inverts itself to -3.1. The problem is, if I’m going to supply this value to the motor, doesn’t it need to be -1 to 1?",
                    "post_number": 10,
                    "post_type": 1,
                    "posts_count": 24,
                    "updated_at": "2023-10-17T23:51:49.774Z",
                    "reply_count": 1,
                    "reply_to_post_number": null,
                    "quote_count": 0,
                    "incoming_link_count": 1,
                    "reads": 105,
                    "readers_count": 104,
                    "score": 31.0,
                    "yours": false,
                    "topic_id": 441868,
                    "topic_slug": "why-doesnt-this-swerve-code-work",
                    "display_username": "",
                    "primary_group_name": null,
                    "flair_name": null,
                    "flair_url": null,
                    "flair_bg_color": null,
                    "flair_color": null,
                    "flair_group_id": null,
                    "badges_granted": [],
                    "version": 1,
                    "can_edit": false,
                    "can_delete": false,
                    "can_recover": false,
                    "can_see_hidden_post": true,
                    "can_wiki": false,
                    "read": true,
                    "user_title": null,
                    "bookmarked": false,
                    "actions_summary": [],
                    "moderator": false,
                    "admin": false,
                    "staff": false,
                    "user_id": 54317,
                    "hidden": false,
                    "trust_level": 2,
                    "deleted_at": null,
                    "user_deleted": false,
                    "edit_reason": null,
                    "can_view_edit_history": true,
                    "wiki": false,
                    "user_custom_fields": {
                        "user_field_4": "Main Programmer Dude | 8551"
                    },
                    "post_url": "/t/why-doesnt-this-swerve-code-work/441868/10",
                    "custom_user_title": "Main Programmer Dude | 8551",
                    "reactions": [],
                    "current_user_reaction": null,
                    "reaction_users_count": 0,
                    "current_user_used_main_reaction": false,
                    "can_accept_answer": false,
                    "can_unaccept_answer": false,
                    "accepted_answer": false,
                    "topic_accepted_answer": true
                },
                {
                    "id": 3242375,
                    "name": null,
                    "username": "shush",
                    "avatar_template": "/letter_avatar_proxy/v4/letter/s/aeb1de/{size}.png",
                    "created_at": "2023-10-18T07:01:30.513Z",
                    "cooked": "SirFire:\n\nIf I supply a setpoint of Math.PI / 4, (45deg) the PID error is 0.78 when the wheel is at 0 degrees. This seems pretty high to me already\n\nThe error is just the setpoint minus the measurement. So (seeing your controller uses radians) this makes perfect sense.\n\nSirFire:\n\nif I’m going to supply this value to the motor, doesn’t it need to be -1 to 1\n\nThe output of the PID controller depends not only on the error, but also on the PID terms.\n\nIf you only use a P term, then the output is simply P times the error.\n\nSo if you want a smaller output… make P a smaller number.",
                    "post_number": 11,
                    "post_type": 1,
                    "posts_count": 24,
                    "updated_at": "2023-10-18T07:01:30.513Z",
                    "reply_count": 1,
                    "reply_to_post_number": 10,
                    "quote_count": 1,
                    "incoming_link_count": 0,
                    "reads": 92,
                    "readers_count": 91,
                    "score": 23.4,
                    "yours": false,
                    "topic_id": 441868,
                    "topic_slug": "why-doesnt-this-swerve-code-work",
                    "display_username": null,
                    "primary_group_name": null,
                    "flair_name": null,
                    "flair_url": null,
                    "flair_bg_color": null,
                    "flair_color": null,
                    "flair_group_id": null,
                    "badges_granted": [],
                    "version": 1,
                    "can_edit": false,
                    "can_delete": false,
                    "can_recover": false,
                    "can_see_hidden_post": true,
                    "can_wiki": false,
                    "read": true,
                    "user_title": null,
                    "bookmarked": false,
                    "actions_summary": [],
                    "moderator": false,
                    "admin": false,
                    "staff": false,
                    "user_id": 51472,
                    "hidden": false,
                    "trust_level": 2,
                    "deleted_at": null,
                    "user_deleted": false,
                    "edit_reason": null,
                    "can_view_edit_history": true,
                    "wiki": false,
                    "user_custom_fields": {
                        "user_field_4": "Programming"
                    },
                    "post_url": "/t/why-doesnt-this-swerve-code-work/441868/11",
                    "custom_user_title": "Programming",
                    "reactions": [],
                    "current_user_reaction": null,
                    "reaction_users_count": 0,
                    "current_user_used_main_reaction": false,
                    "can_accept_answer": false,
                    "can_unaccept_answer": false,
                    "accepted_answer": false,
                    "topic_accepted_answer": true
                },
                {
                    "id": 3242467,
                    "name": "",
                    "username": "SirFire",
                    "avatar_template": "/user_avatar/www.chiefdelphi.com/sirfire/{size}/222590_2.png",
                    "created_at": "2023-10-18T16:20:23.236Z",
                    "cooked": "shush:\n\nThe output of the PID controller depends not only on the error, but also on the PID terms.\n\nIf you only use a P term, then the output is simply P times the error.\n\nSo if you want a smaller output… make P a smaller number.\n\nThat makes sense. I did try to use a smaller P value of 0.5, which worked but with a considerable amount of shaking before it finally settled at it’s setpoint. To solve this, I tried adding a D value of 0.1 which made it far worse, making it not settle at the setpoint at all. I reduced the D value to 0.01 and this worked, but still with some amount of shaking still. I then added a position tolerance of 1, which actually made it work perfectly the first time with resistance from the floor. We kept running it over and over again to confirm that it was not a fluke, and it always worked, though the shaking was variable each time. We’re going to try to run this code on all four modules next week, as before we’ve only been testing one at a time. We would very much like to eliminate the shaking, especially with the setpoint changing many times a second when driving.",
                    "post_number": 12,
                    "post_type": 1,
                    "posts_count": 24,
                    "updated_at": "2023-10-18T16:20:23.236Z",
                    "reply_count": 2,
                    "reply_to_post_number": 11,
                    "quote_count": 1,
                    "incoming_link_count": 1,
                    "reads": 78,
                    "readers_count": 77,
                    "score": 45.6,
                    "yours": false,
                    "topic_id": 441868,
                    "topic_slug": "why-doesnt-this-swerve-code-work",
                    "display_username": "",
                    "primary_group_name": null,
                    "flair_name": null,
                    "flair_url": null,
                    "flair_bg_color": null,
                    "flair_color": null,
                    "flair_group_id": null,
                    "badges_granted": [],
                    "version": 1,
                    "can_edit": false,
                    "can_delete": false,
                    "can_recover": false,
                    "can_see_hidden_post": true,
                    "can_wiki": false,
                    "read": true,
                    "user_title": null,
                    "bookmarked": false,
                    "actions_summary": [
                        {
                            "id": 2,
                            "count": 1
                        }
                    ],
                    "moderator": false,
                    "admin": false,
                    "staff": false,
                    "user_id": 54317,
                    "hidden": false,
                    "trust_level": 2,
                    "deleted_at": null,
                    "user_deleted": false,
                    "edit_reason": null,
                    "can_view_edit_history": true,
                    "wiki": false,
                    "user_custom_fields": {
                        "user_field_4": "Main Programmer Dude | 8551"
                    },
                    "post_url": "/t/why-doesnt-this-swerve-code-work/441868/12",
                    "custom_user_title": "Main Programmer Dude | 8551",
                    "reactions": [
                        {
                            "id": "heart",
                            "type": "emoji",
                            "count": 1
                        }
                    ],
                    "current_user_reaction": null,
                    "reaction_users_count": 1,
                    "current_user_used_main_reaction": false,
                    "can_accept_answer": false,
                    "can_unaccept_answer": false,
                    "accepted_answer": false,
                    "topic_accepted_answer": true
                },
                {
                    "id": 3242493,
                    "name": "joel truher",
                    "username": "truher",
                    "avatar_template": "/user_avatar/www.chiefdelphi.com/truher/{size}/172222_2.png",
                    "created_at": "2023-10-18T17:01:08.723Z",
                    "cooked": "Position tolerance of 1 (radian?) sounds like a lot.\n\nFWIW, for nonzero “D”, it is common to low-pass filter the input, since “D” amplifies high-frequency noise.\n\nIn our experience it’s also helpful to use a feedforward term using the profile’s target velocity, so that “P” doesn’t have to do all the work.",
                    "post_number": 13,
                    "post_type": 1,
                    "posts_count": 24,
                    "updated_at": "2023-10-18T17:01:08.723Z",
                    "reply_count": 1,
                    "reply_to_post_number": 12,
                    "quote_count": 0,
                    "incoming_link_count": 0,
                    "reads": 74,
                    "readers_count": 73,
                    "score": 19.8,
                    "yours": false,
                    "topic_id": 441868,
                    "topic_slug": "why-doesnt-this-swerve-code-work",
                    "display_username": "joel truher",
                    "primary_group_name": null,
                    "flair_name": null,
                    "flair_url": null,
                    "flair_bg_color": null,
                    "flair_color": null,
                    "flair_group_id": null,
                    "badges_granted": [],
                    "version": 1,
                    "can_edit": false,
                    "can_delete": false,
                    "can_recover": false,
                    "can_see_hidden_post": true,
                    "can_wiki": false,
                    "read": true,
                    "user_title": null,
                    "reply_to_user": {
                        "id": 54317,
                        "username": "SirFire",
                        "name": "",
                        "avatar_template": "/user_avatar/www.chiefdelphi.com/sirfire/{size}/222590_2.png"
                    },
                    "bookmarked": false,
                    "actions_summary": [],
                    "moderator": false,
                    "admin": false,
                    "staff": false,
                    "user_id": 53190,
                    "hidden": false,
                    "trust_level": 2,
                    "deleted_at": null,
                    "user_deleted": false,
                    "edit_reason": null,
                    "can_view_edit_history": true,
                    "wiki": false,
                    "user_custom_fields": {
                        "user_field_4": ""
                    },
                    "post_url": "/t/why-doesnt-this-swerve-code-work/441868/13",
                    "custom_user_title": null,
                    "reactions": [],
                    "current_user_reaction": null,
                    "reaction_users_count": 0,
                    "current_user_used_main_reaction": false,
                    "can_accept_answer": false,
                    "can_unaccept_answer": false,
                    "accepted_answer": false,
                    "topic_accepted_answer": true
                },
                {
                    "id": 3242497,
                    "name": "",
                    "username": "SirFire",
                    "avatar_template": "/user_avatar/www.chiefdelphi.com/sirfire/{size}/222590_2.png",
                    "created_at": "2023-10-18T17:14:22.154Z",
                    "cooked": "truher:\n\nPosition tolerance of 1 (radian?) sounds like a lot.\n\nYes, it does seem large. (Yes, radians) We’re using the .setTolerance() method of the PIDController . In my mind, position tolerance is the range around the setpoint that will make the error effectively 0, therefore giving the motor a larger space to stop and not overshoot. We initially chose 1 because we assumed that if we set the motor to a position less than 1rad, the motor would not move. Instead, it worked perfectly as stated above. I don’t know why it did that, but it did so I wasn’t going to question it at the time. I get the feeling that I’m incorrect about what position tolerance is.\n\nEDIT: After looking at the docs for PIDController , it looks as if .setTolerance() only affects the .atSetpoint() method. Would be be effective to run something like this?",
                    "post_number": 14,
                    "post_type": 1,
                    "posts_count": 24,
                    "updated_at": "2023-10-18T17:21:54.412Z",
                    "reply_count": 1,
                    "reply_to_post_number": 13,
                    "quote_count": 1,
                    "incoming_link_count": 1,
                    "reads": 69,
                    "readers_count": 68,
                    "score": 23.8,
                    "yours": false,
                    "topic_id": 441868,
                    "topic_slug": "why-doesnt-this-swerve-code-work",
                    "display_username": "",
                    "primary_group_name": null,
                    "flair_name": null,
                    "flair_url": null,
                    "flair_bg_color": null,
                    "flair_color": null,
                    "flair_group_id": null,
                    "badges_granted": [],
                    "version": 2,
                    "can_edit": false,
                    "can_delete": false,
                    "can_recover": false,
                    "can_see_hidden_post": true,
                    "can_wiki": false,
                    "read": true,
                    "user_title": null,
                    "bookmarked": false,
                    "actions_summary": [],
                    "moderator": false,
                    "admin": false,
                    "staff": false,
                    "user_id": 54317,
                    "hidden": false,
                    "trust_level": 2,
                    "deleted_at": null,
                    "user_deleted": false,
                    "edit_reason": null,
                    "can_view_edit_history": true,
                    "wiki": false,
                    "user_custom_fields": {
                        "user_field_4": "Main Programmer Dude | 8551"
                    },
                    "post_url": "/t/why-doesnt-this-swerve-code-work/441868/14",
                    "custom_user_title": "Main Programmer Dude | 8551",
                    "reactions": [],
                    "current_user_reaction": null,
                    "reaction_users_count": 0,
                    "current_user_used_main_reaction": false,
                    "can_accept_answer": false,
                    "can_unaccept_answer": false,
                    "accepted_answer": false,
                    "topic_accepted_answer": true
                },
                {
                    "id": 3242513,
                    "name": "joel truher",
                    "username": "truher",
                    "avatar_template": "/user_avatar/www.chiefdelphi.com/truher/{size}/172222_2.png",
                    "created_at": "2023-10-18T17:45:45.607Z",
                    "cooked": "yeah, that would work, and you’re right that the controller itself doesn’t listen to the tolerance.  it’s true that deadbanding around the goal is a normal way to prevent chatter, but you’d want the deadband to be quite small, like 0.02 radians, to prevent tire scrub, so the deadband would probably within the lash of the steering gears.\n\nteam100 noticed the same sort of chattering that you’re describing and attributed it to low-level high-frequency noise in the measurement (we use analog steering sensors, we know they’re kinda noisy), so you might look at that too.",
                    "post_number": 15,
                    "post_type": 1,
                    "posts_count": 24,
                    "updated_at": "2023-10-18T17:45:45.607Z",
                    "reply_count": 0,
                    "reply_to_post_number": 14,
                    "quote_count": 0,
                    "incoming_link_count": 0,
                    "reads": 59,
                    "readers_count": 58,
                    "score": 11.8,
                    "yours": false,
                    "topic_id": 441868,
                    "topic_slug": "why-doesnt-this-swerve-code-work",
                    "display_username": "joel truher",
                    "primary_group_name": null,
                    "flair_name": null,
                    "flair_url": null,
                    "flair_bg_color": null,
                    "flair_color": null,
                    "flair_group_id": null,
                    "badges_granted": [],
                    "version": 1,
                    "can_edit": false,
                    "can_delete": false,
                    "can_recover": false,
                    "can_see_hidden_post": true,
                    "can_wiki": false,
                    "read": true,
                    "user_title": null,
                    "reply_to_user": {
                        "id": 54317,
                        "username": "SirFire",
                        "name": "",
                        "avatar_template": "/user_avatar/www.chiefdelphi.com/sirfire/{size}/222590_2.png"
                    },
                    "bookmarked": false,
                    "actions_summary": [],
                    "moderator": false,
                    "admin": false,
                    "staff": false,
                    "user_id": 53190,
                    "hidden": false,
                    "trust_level": 2,
                    "deleted_at": null,
                    "user_deleted": false,
                    "edit_reason": null,
                    "can_view_edit_history": true,
                    "wiki": false,
                    "user_custom_fields": {
                        "user_field_4": ""
                    },
                    "post_url": "/t/why-doesnt-this-swerve-code-work/441868/15",
                    "custom_user_title": null,
                    "reactions": [],
                    "current_user_reaction": null,
                    "reaction_users_count": 0,
                    "current_user_used_main_reaction": false,
                    "can_accept_answer": false,
                    "can_unaccept_answer": false,
                    "accepted_answer": false,
                    "topic_accepted_answer": true
                },
                {
                    "id": 3242774,
                    "name": null,
                    "username": "shush",
                    "avatar_template": "/letter_avatar_proxy/v4/letter/s/aeb1de/{size}.png",
                    "created_at": "2023-10-19T13:32:20.189Z",
                    "cooked": "SirFire:\n\nI did try to use a smaller P value of 0.5\n\nDid you try other values as well, before settling on 0.5? Finding the best numbers for the PID terms takes systematic trial and error.\n\nIt might be helpful for you to graph the error and measurement, and look at how the module moves with different PID terms.",
                    "post_number": 16,
                    "post_type": 1,
                    "posts_count": 24,
                    "updated_at": "2023-10-19T13:32:20.189Z",
                    "reply_count": 0,
                    "reply_to_post_number": 12,
                    "quote_count": 1,
                    "incoming_link_count": 0,
                    "reads": 54,
                    "readers_count": 53,
                    "score": 10.8,
                    "yours": false,
                    "topic_id": 441868,
                    "topic_slug": "why-doesnt-this-swerve-code-work",
                    "display_username": null,
                    "primary_group_name": null,
                    "flair_name": null,
                    "flair_url": null,
                    "flair_bg_color": null,
                    "flair_color": null,
                    "flair_group_id": null,
                    "badges_granted": [],
                    "version": 1,
                    "can_edit": false,
                    "can_delete": false,
                    "can_recover": false,
                    "can_see_hidden_post": true,
                    "can_wiki": false,
                    "read": true,
                    "user_title": null,
                    "bookmarked": false,
                    "actions_summary": [],
                    "moderator": false,
                    "admin": false,
                    "staff": false,
                    "user_id": 51472,
                    "hidden": false,
                    "trust_level": 2,
                    "deleted_at": null,
                    "user_deleted": false,
                    "edit_reason": null,
                    "can_view_edit_history": true,
                    "wiki": false,
                    "user_custom_fields": {
                        "user_field_4": "Programming"
                    },
                    "post_url": "/t/why-doesnt-this-swerve-code-work/441868/16",
                    "custom_user_title": "Programming",
                    "reactions": [],
                    "current_user_reaction": null,
                    "reaction_users_count": 0,
                    "current_user_used_main_reaction": false,
                    "can_accept_answer": false,
                    "can_unaccept_answer": false,
                    "accepted_answer": false,
                    "topic_accepted_answer": true
                },
                {
                    "id": 3242775,
                    "name": "Allen Nuttle",
                    "username": "nuttle",
                    "avatar_template": "/user_avatar/www.chiefdelphi.com/nuttle/{size}/124105_2.png",
                    "created_at": "2023-10-19T13:32:50.991Z",
                    "cooked": "This type of thing (hard to tune PID) is why ProfiledPIDController is there…",
                    "post_number": 17,
                    "post_type": 1,
                    "posts_count": 24,
                    "updated_at": "2023-10-19T13:32:50.991Z",
                    "reply_count": 1,
                    "reply_to_post_number": null,
                    "quote_count": 0,
                    "incoming_link_count": 0,
                    "reads": 55,
                    "readers_count": 54,
                    "score": 16.0,
                    "yours": false,
                    "topic_id": 441868,
                    "topic_slug": "why-doesnt-this-swerve-code-work",
                    "display_username": "Allen Nuttle",
                    "primary_group_name": null,
                    "flair_name": null,
                    "flair_url": null,
                    "flair_bg_color": null,
                    "flair_color": null,
                    "flair_group_id": null,
                    "badges_granted": [],
                    "version": 1,
                    "can_edit": false,
                    "can_delete": false,
                    "can_recover": false,
                    "can_see_hidden_post": true,
                    "can_wiki": false,
                    "read": true,
                    "user_title": "",
                    "bookmarked": false,
                    "actions_summary": [],
                    "moderator": false,
                    "admin": false,
                    "staff": false,
                    "user_id": 14283,
                    "hidden": false,
                    "trust_level": 2,
                    "deleted_at": null,
                    "user_deleted": false,
                    "edit_reason": null,
                    "can_view_edit_history": true,
                    "wiki": false,
                    "user_custom_fields": {
                        "user_field_4": ""
                    },
                    "post_url": "/t/why-doesnt-this-swerve-code-work/441868/17",
                    "custom_user_title": null,
                    "reactions": [],
                    "current_user_reaction": null,
                    "reaction_users_count": 0,
                    "current_user_used_main_reaction": false,
                    "can_accept_answer": false,
                    "can_unaccept_answer": false,
                    "accepted_answer": false,
                    "topic_accepted_answer": true
                },
                {
                    "id": 3243060,
                    "name": "",
                    "username": "SirFire",
                    "avatar_template": "/user_avatar/www.chiefdelphi.com/sirfire/{size}/222590_2.png",
                    "created_at": "2023-10-19T23:26:56.161Z",
                    "cooked": "Apologies if these questions are basic, but I’ve never used a ProfiledPIDController before. To measure the motor’s max velocity, can we run the motor at 100% power, graph the velocity, and find the highest point? Which encoder should we use, the built-in motor encoder or the CANCoder? (I would assume the built-in encoder) Should this be measured with load or without? To measure the max acceleration, you said to find the motor’s theoretical max acceleration. I don’t see that anywhere on the motor’s data sheet . Is there a place to find that or is it another thing we have to measure?",
                    "post_number": 18,
                    "post_type": 1,
                    "posts_count": 24,
                    "updated_at": "2023-10-19T23:26:56.161Z",
                    "reply_count": 1,
                    "reply_to_post_number": 17,
                    "quote_count": 0,
                    "incoming_link_count": 0,
                    "reads": 50,
                    "readers_count": 49,
                    "score": 15.0,
                    "yours": false,
                    "topic_id": 441868,
                    "topic_slug": "why-doesnt-this-swerve-code-work",
                    "display_username": "",
                    "primary_group_name": null,
                    "flair_name": null,
                    "flair_url": null,
                    "flair_bg_color": null,
                    "flair_color": null,
                    "flair_group_id": null,
                    "badges_granted": [],
                    "version": 1,
                    "can_edit": false,
                    "can_delete": false,
                    "can_recover": false,
                    "can_see_hidden_post": true,
                    "can_wiki": false,
                    "link_counts": [
                        {
                            "url": "https://www.revrobotics.com/content/docs/REV-21-1650-DS.pdf",
                            "internal": false,
                            "reflection": false,
                            "clicks": 0
                        }
                    ],
                    "read": true,
                    "user_title": null,
                    "reply_to_user": {
                        "id": 14283,
                        "username": "nuttle",
                        "name": "Allen Nuttle",
                        "avatar_template": "/user_avatar/www.chiefdelphi.com/nuttle/{size}/124105_2.png"
                    },
                    "bookmarked": false,
                    "actions_summary": [],
                    "moderator": false,
                    "admin": false,
                    "staff": false,
                    "user_id": 54317,
                    "hidden": false,
                    "trust_level": 2,
                    "deleted_at": null,
                    "user_deleted": false,
                    "edit_reason": null,
                    "can_view_edit_history": true,
                    "wiki": false,
                    "user_custom_fields": {
                        "user_field_4": "Main Programmer Dude | 8551"
                    },
                    "post_url": "/t/why-doesnt-this-swerve-code-work/441868/18",
                    "custom_user_title": "Main Programmer Dude | 8551",
                    "reactions": [],
                    "current_user_reaction": null,
                    "reaction_users_count": 0,
                    "current_user_used_main_reaction": false,
                    "can_accept_answer": false,
                    "can_unaccept_answer": false,
                    "accepted_answer": false,
                    "topic_accepted_answer": true
                },
                {
                    "id": 3243103,
                    "name": "Allen Nuttle",
                    "username": "nuttle",
                    "avatar_template": "/user_avatar/www.chiefdelphi.com/nuttle/{size}/124105_2.png",
                    "created_at": "2023-10-20T01:13:09.228Z",
                    "cooked": "For turning, you want to use the absolute sensor for everything.  The ProfiledPIDController is going to work on the sensed steer angle and the desired steer angle.  So, you want to measure the maximum velocity as observed by that sensor.  You can just pretend the motor doesn’t have a built-in sensor, as you won’t use it at all.\n\nYes, give the steering motor 100% power and then see what the maximum consistently achievable velocity value turns out to be.  This might be slightly different in one direction than another, and it might be lower when the robot is on the ground, on carpet.  You are just looking for the maximum velocity to use in the planned rotational motion of the steering angle.  If it is low, the steering won’t snap into position as quickly as it could.  If it is high, the actual motion won’t be able to keep up with the planned motion, and you might get overshoot/oscillation.\n\nYou can measure the max. acceleration, or just time how long it takes for the motor to reach max. velocity from a full stop.  That’s probably easier than deriving it, since you need to know about the mechanics of the load the motor is driving to do this.  We found that we really don’t want to use full power acceleration for our steering motors, so we measured the max. acceleration and then cut the value we actually plug in way back, after some experimentation.\n\nHere’s a snip of C++ code that has the values all plugged in.  C++ has units – Java doesn’t have this, so you have to be really careful with the units.  If you just use consistent units, things should cancel out though.",
                    "post_number": 19,
                    "post_type": 1,
                    "posts_count": 24,
                    "updated_at": "2023-10-20T01:13:09.228Z",
                    "reply_count": 1,
                    "reply_to_post_number": 18,
                    "quote_count": 0,
                    "incoming_link_count": 0,
                    "reads": 52,
                    "readers_count": 51,
                    "score": 15.4,
                    "yours": false,
                    "topic_id": 441868,
                    "topic_slug": "why-doesnt-this-swerve-code-work",
                    "display_username": "Allen Nuttle",
                    "primary_group_name": null,
                    "flair_name": null,
                    "flair_url": null,
                    "flair_bg_color": null,
                    "flair_color": null,
                    "flair_group_id": null,
                    "badges_granted": [],
                    "version": 1,
                    "can_edit": false,
                    "can_delete": false,
                    "can_recover": false,
                    "can_see_hidden_post": true,
                    "can_wiki": false,
                    "read": true,
                    "user_title": "",
                    "reply_to_user": {
                        "id": 54317,
                        "username": "SirFire",
                        "name": "",
                        "avatar_template": "/user_avatar/www.chiefdelphi.com/sirfire/{size}/222590_2.png"
                    },
                    "bookmarked": false,
                    "actions_summary": [],
                    "moderator": false,
                    "admin": false,
                    "staff": false,
                    "user_id": 14283,
                    "hidden": false,
                    "trust_level": 2,
                    "deleted_at": null,
                    "user_deleted": false,
                    "edit_reason": null,
                    "can_view_edit_history": true,
                    "wiki": false,
                    "user_custom_fields": {
                        "user_field_4": ""
                    },
                    "post_url": "/t/why-doesnt-this-swerve-code-work/441868/19",
                    "custom_user_title": null,
                    "reactions": [],
                    "current_user_reaction": null,
                    "reaction_users_count": 0,
                    "current_user_used_main_reaction": false,
                    "can_accept_answer": false,
                    "can_unaccept_answer": false,
                    "accepted_answer": false,
                    "topic_accepted_answer": true
                },
                {
                    "id": 3243107,
                    "name": "Allen Nuttle",
                    "username": "nuttle",
                    "avatar_template": "/user_avatar/www.chiefdelphi.com/nuttle/{size}/124105_2.png",
                    "created_at": "2023-10-20T01:26:32.655Z",
                    "cooked": "Note that P is lower than you might guess, because the angles are in degrees.  So, the angle error is going to appear larger than it would in radians.  This holds for the other constants as well.\n\nWhat is going on here is that the controller keeps track of the actual position of the steering angle, using the sensor data (you feed this in every cycle of the robot main loop – 50 times a second).  But, it also keeps track of the current velocity.  You will feed in the desired steering angle at least any time this changes but, most likely you will just also do this every cycle of the robot main loop.  This means that the controller can compute the steering angle error on every cycle of the robot main loop.\n\nGiven the current position and velocity of the steering angle, as well as the desired end position (the end velocity is zero), the controller figures out how quickly it can get to the desired end state.  When you graph this plan out with time on the x-axis, it forms a trapezoid.  So, this is sometimes called trapezoidal motion profiling.\n\nYou can probably at least start by just plugging in these same numbers, if you feed in your angles in degrees.  This was for a nearly full-weight robot with four SDS Mk4i modules powered by NEOs.  But, I think we might have just copied these constants from another robot that used the regular Mk4 modules.",
                    "post_number": 20,
                    "post_type": 1,
                    "posts_count": 24,
                    "updated_at": "2023-10-20T01:26:32.655Z",
                    "reply_count": 1,
                    "reply_to_post_number": 19,
                    "quote_count": 0,
                    "incoming_link_count": 0,
                    "reads": 45,
                    "readers_count": 44,
                    "score": 14.0,
                    "yours": false,
                    "topic_id": 441868,
                    "topic_slug": "why-doesnt-this-swerve-code-work",
                    "display_username": "Allen Nuttle",
                    "primary_group_name": null,
                    "flair_name": null,
                    "flair_url": null,
                    "flair_bg_color": null,
                    "flair_color": null,
                    "flair_group_id": null,
                    "badges_granted": [],
                    "version": 1,
                    "can_edit": false,
                    "can_delete": false,
                    "can_recover": false,
                    "can_see_hidden_post": true,
                    "can_wiki": false,
                    "read": true,
                    "user_title": "",
                    "reply_to_user": {
                        "id": 14283,
                        "username": "nuttle",
                        "name": "Allen Nuttle",
                        "avatar_template": "/user_avatar/www.chiefdelphi.com/nuttle/{size}/124105_2.png"
                    },
                    "bookmarked": false,
                    "actions_summary": [],
                    "moderator": false,
                    "admin": false,
                    "staff": false,
                    "user_id": 14283,
                    "hidden": false,
                    "trust_level": 2,
                    "deleted_at": null,
                    "user_deleted": false,
                    "edit_reason": null,
                    "can_view_edit_history": true,
                    "wiki": false,
                    "user_custom_fields": {
                        "user_field_4": ""
                    },
                    "post_url": "/t/why-doesnt-this-swerve-code-work/441868/20",
                    "custom_user_title": null,
                    "reactions": [],
                    "current_user_reaction": null,
                    "reaction_users_count": 0,
                    "current_user_used_main_reaction": false,
                    "can_accept_answer": false,
                    "can_unaccept_answer": false,
                    "accepted_answer": false,
                    "topic_accepted_answer": true
                }
            ],
            "stream": [
                3237518,
                3237553,
                3237682,
                3239099,
                3240131,
                3241260,
                3241712,
                3241891,
                3242264,
                3242275,
                3242375,
                3242467,
                3242493,
                3242497,
                3242513,
                3242774,
                3242775,
                3243060,
                3243103,
                3243107,
                3243138,
                3243266,
                3244908,
                3438472
            ]
        },
        "timeline_lookup": [
            [
                1,
                738
            ],
            [
                4,
                732
            ],
            [
                5,
                730
            ],
            [
                6,
                727
            ],
            [
                7,
                726
            ],
            [
                9,
                725
            ],
            [
                12,
                724
            ],
            [
                18,
                723
            ],
            [
                22,
                722
            ],
            [
                23,
                718
            ],
            [
                24,
                353
            ]
        ],
        "tags": [
            "swerve"
        ],
        "tags_descriptions": {},
        "fancy_title": "Why doesn&rsquo;t this swerve code work?",
        "id": 441868,
        "title": "Why doesn't this swerve code work?",
        "posts_count": 24,
        "created_at": "2023-10-04T16:33:49.640Z",
        "views": 1859,
        "reply_count": 16,
        "like_count": 7,
        "last_posted_at": "2024-10-24T02:31:44.053Z",
        "visible": true,
        "closed": true,
        "archived": false,
        "has_summary": false,
        "archetype": "regular",
        "slug": "why-doesnt-this-swerve-code-work",
        "category_id": 30,
        "word_count": 4086,
        "deleted_at": null,
        "user_id": 54317,
        "featured_link": null,
        "pinned_globally": false,
        "pinned_at": null,
        "pinned_until": null,
        "image_url": null,
        "slow_mode_seconds": 0,
        "draft": null,
        "draft_key": "topic_441868",
        "draft_sequence": null,
        "unpinned": null,
        "pinned": false,
        "current_post_number": 1,
        "highest_post_number": 24,
        "deleted_by": null,
        "actions_summary": [
            {
                "id": 4,
                "count": 0,
                "hidden": false,
                "can_act": false
            },
            {
                "id": 8,
                "count": 0,
                "hidden": false,
                "can_act": false
            },
            {
                "id": 10,
                "count": 0,
                "hidden": false,
                "can_act": false
            },
            {
                "id": 7,
                "count": 0,
                "hidden": false,
                "can_act": false
            }
        ],
        "chunk_size": 20,
        "bookmarked": false,
        "topic_timer": null,
        "message_bus_last_id": 0,
        "participant_count": 4,
        "show_read_indicator": false,
        "thumbnails": null,
        "slow_mode_enabled_until": null,
        "valid_reactions": [
            "heart",
            "laughing",
            "point_up",
            "+1",
            "-1",
            "100",
            "open_mouth",
            "cry",
            "question",
            "thinking",
            "call_me_hand",
            "hugs",
            "angry"
        ],
        "accepted_answer": {
            "post_number": 23,
            "username": "SirFire",
            "name": null,
            "excerpt": "I have some awesome news: Our team witnessed fully functioning swerve drive for the first time tonight. We’re all very excited. Obviously there’s lots more to tune and what-not, but I wanted to thank y’all for your help to get to this point. Not really sure which message to mark as a solution becaus&hellip;",
            "accepter_name": null
        },
        "user_chosen_thumbnail_url": null,
        "sidecar_installed": true,
        "can_vote": false,
        "vote_count": 0,
        "user_voted": false,
        "discourse_zendesk_plugin_zendesk_id": null,
        "discourse_zendesk_plugin_zendesk_url": "https://your-url.zendesk.com/agent/tickets/",
        "details": {
            "can_edit": false,
            "notification_level": 1,
            "participants": [
                {
                    "id": 54317,
                    "username": "SirFire",
                    "name": "",
                    "avatar_template": "/user_avatar/www.chiefdelphi.com/sirfire/{size}/222590_2.png",
                    "post_count": 11,
                    "primary_group_name": null,
                    "flair_name": null,
                    "flair_url": null,
                    "flair_color": null,
                    "flair_bg_color": null,
                    "flair_group_id": null,
                    "trust_level": 2
                },
                {
                    "id": 14283,
                    "username": "nuttle",
                    "name": "Allen Nuttle",
                    "avatar_template": "/user_avatar/www.chiefdelphi.com/nuttle/{size}/124105_2.png",
                    "post_count": 5,
                    "primary_group_name": null,
                    "flair_name": null,
                    "flair_url": null,
                    "flair_color": null,
                    "flair_bg_color": null,
                    "flair_group_id": null,
                    "trust_level": 2
                },
                {
                    "id": 51472,
                    "username": "shush",
                    "name": null,
                    "avatar_template": "/letter_avatar_proxy/v4/letter/s/aeb1de/{size}.png",
                    "post_count": 5,
                    "primary_group_name": null,
                    "flair_name": null,
                    "flair_url": null,
                    "flair_color": null,
                    "flair_bg_color": null,
                    "flair_group_id": null,
                    "trust_level": 2
                },
                {
                    "id": 53190,
                    "username": "truher",
                    "name": "joel truher",
                    "avatar_template": "/user_avatar/www.chiefdelphi.com/truher/{size}/172222_2.png",
                    "post_count": 2,
                    "primary_group_name": null,
                    "flair_name": null,
                    "flair_url": null,
                    "flair_color": null,
                    "flair_bg_color": null,
                    "flair_group_id": null,
                    "trust_level": 2
                }
            ],
            "created_by": {
                "id": 54317,
                "username": "SirFire",
                "name": "",
                "avatar_template": "/user_avatar/www.chiefdelphi.com/sirfire/{size}/222590_2.png"
            },
            "last_poster": {
                "id": -1,
                "username": "system",
                "name": "system",
                "avatar_template": "/uploads/default/original/4X/9/3/2/93234578e69f55873c63fc00fe2d0d85f23bce55.png"
            },
            "links": [
                {
                    "url": "https://github.com/SirFireE/Swerve8551",
                    "title": "GitHub - SirFireE/Swerve8551",
                    "internal": false,
                    "attachment": false,
                    "reflection": false,
                    "clicks": 53,
                    "user_id": 54317,
                    "domain": "github.com",
                    "root_domain": "github.com"
                },
                {
                    "url": "https://github.com/SirFireE/Swerve8551/blob/main/src/main/java/frc/robot/subsystems/SwerveModule.java",
                    "title": null,
                    "internal": false,
                    "attachment": false,
                    "reflection": false,
                    "clicks": 7,
                    "user_id": 54317,
                    "domain": "github.com",
                    "root_domain": "github.com"
                },
                {
                    "url": "https://www.motioncontroltips.com/what-is-a-motion-profile/",
                    "title": "What is a motion profile?",
                    "internal": false,
                    "attachment": false,
                    "reflection": false,
                    "clicks": 5,
                    "user_id": 14283,
                    "domain": "www.motioncontroltips.com",
                    "root_domain": "motioncontroltips.com"
                },
                {
                    "url": "https://docs.wpilib.org/en/stable/docs/software/advanced-controls/geometry/coordinate-systems.html.",
                    "title": null,
                    "internal": false,
                    "attachment": false,
                    "reflection": false,
                    "clicks": 4,
                    "user_id": 14283,
                    "domain": "docs.wpilib.org",
                    "root_domain": "wpilib.org"
                }
            ]
        },
        "bookmarks": []
    }
}