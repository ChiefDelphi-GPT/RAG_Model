{"data":"{\"post_stream\":{\"posts\":[{\"id\":3442351,\"name\":\"\",\"username\":\"KfirNeuman\",\"avatar_template\":\"/letter_avatar_proxy/v4/letter/k/d07c76/{size}.png\",\"created_at\":\"2024-10-31T23:15:43.407Z\",\"cooked\":\"\\u003cp\\u003eHi I was working on a project and think I may have found a bug in Rotation2d, where values are incorrectly being wrapped into a 0-360 degree range. It also seems to apply for Rotation3d.\\u003c/p\\u003e\\n\\u003cp\\u003eThe Rotation2d class says “The angle is continuous, that is if a Rotation2d is constructed with 361 degrees, it will return 361 degrees. This allows algorithms that wouldn’t want to see a discontinuity in the rotations as it sweeps past from 360 to 0 on the second time around.”\\u003c/p\\u003e\\n\\u003cp\\u003eThis works when constructing a Rotation2d but fails for some of the math methods. The times method works as expected but the plus method wraps the sum value back to 0 - 360.\\u003c/p\\u003e\\n\\u003cp\\u003eIs this the intended result? I feel like it is not and the plus method is not supposed to wrap the value but I may be missing something.\\u003c/p\\u003e\\n\\u003cp\\u003eRotation3d also has  0 - 360 wrapping but it happens in all methods. Both the plus and times methods do the wrap, so it seems more intentional here.\\u003c/p\\u003e\\n\\u003cp\\u003eBelow is some code in which you can test this. I would expect that all of these print true but only the first one does.\\u003c/p\\u003e\\n\\u003cpre\\u003e\\u003ccode\\u003eRotation2d r1 = Rotation2d.fromDegrees(100);\\ndouble multiplier = 4;\\n\\n// True. True as expected\\nSystem.out.println(doublesEqual(r1.getDegrees() * multiplier, r1.times(multiplier).getDegrees()));\\n\\nRotation2d r2 = Rotation2d.fromDegrees(200);\\nRotation2d r3 = Rotation2d.fromDegrees(240);\\n\\n// False. True expected\\nSystem.out.println(doublesEqual(r2.getDegrees() + r3.getDegrees(), r2.plus(r3).getDegrees()));\\n\\n\\n\\nRotation3d r4 = new Rotation3d(Math.toRadians(100), 0, 0);\\nmultiplier = 4;\\n\\n// False. True expected\\nSystem.out.println(doublesEqual(r4.getX() * multiplier, r4.times(multiplier).getX()));\\n\\nRotation3d r5 = new Rotation3d(Math.toRadians(200), 0, 0);\\nRotation3d r6 = new Rotation3d(Math.toRadians(240), 0, 0);\\n\\n// False. True expected\\nSystem.out.println(doublesEqual(r5.getX() + r6.getX(), r5.plus(r6).getX()));\\n\\u003c/code\\u003e\\u003c/pre\\u003e\\n\\u003cp\\u003eIs this the intended result of these functions? If not what is?\\u003c/p\\u003e\",\"post_number\":1,\"post_type\":1,\"posts_count\":23,\"updated_at\":\"2024-10-31T23:15:43.407Z\",\"reply_count\":2,\"reply_to_post_number\":null,\"quote_count\":0,\"incoming_link_count\":202,\"reads\":391,\"readers_count\":390,\"score\":1098.2,\"yours\":false,\"topic_id\":474140,\"topic_slug\":\"possible-bugs-in-rotation2d-and-rotation3d-java\",\"display_username\":\"\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":1,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"read\":true,\"user_title\":null,\"bookmarked\":false,\"actions_summary\":[],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":62573,\"hidden\":false,\"trust_level\":2,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"user_custom_fields\":{\"user_field_4\":\"3075 Code Lead\"},\"post_url\":\"/t/possible-bugs-in-rotation2d-and-rotation3d-java/474140/1\",\"custom_user_title\":\"3075 Code Lead\",\"reactions\":[],\"current_user_reaction\":null,\"reaction_users_count\":0,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":null,\"can_vote\":false},{\"id\":3442359,\"name\":\"Tyler Veness\",\"username\":\"calcmogul\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/calcmogul/{size}/128045_2.png\",\"created_at\":\"2024-10-31T23:33:20.118Z\",\"cooked\":\"\\u003caside class=\\\"quote no-group\\\" data-username=\\\"KfirNeuman\\\" data-post=\\\"1\\\" data-topic=\\\"474140\\\"\\u003e\\n\\u003cdiv class=\\\"title\\\"\\u003e\\n\\u003cdiv class=\\\"quote-controls\\\"\\u003e\\u003c/div\\u003e\\n\\u003cimg loading=\\\"lazy\\\" alt=\\\"\\\" width=\\\"24\\\" height=\\\"24\\\" src=\\\"https://www.chiefdelphi.com/letter_avatar_proxy/v4/letter/k/d07c76/48.png\\\" class=\\\"avatar\\\"\\u003e KfirNeuman:\\u003c/div\\u003e\\n\\u003cblockquote\\u003e\\n\\u003cp\\u003eThe times method works as expected but the plus method wraps the sum value back to 0 - 360.\\u003c/p\\u003e\\n\\u003c/blockquote\\u003e\\n\\u003c/aside\\u003e\\n\\u003cp\\u003eThe docs for Rotation2d.plus() say it will wrap. Rotation2d only preserves the input angle in the sense that the constructor won’t wrap it.\\u003c/p\\u003e\\u003caside class=\\\"onebox allowlistedgeneric\\\" data-onebox-src=\\\"https://github.wpilib.org/allwpilib/docs/release/java/edu/wpi/first/math/geometry/Rotation2d.html#plus(edu.wpi.first.math.geometry.Rotation2d)\\\"\\u003e\\n  \\u003cheader class=\\\"source\\\"\\u003e\\n\\n      \\u003ca href=\\\"https://github.wpilib.org/allwpilib/docs/release/java/edu/wpi/first/math/geometry/Rotation2d.html#plus(edu.wpi.first.math.geometry.Rotation2d)\\\" target=\\\"_blank\\\" rel=\\\"noopener nofollow ugc\\\"\\u003egithub.wpilib.org\\u003c/a\\u003e\\n  \\u003c/header\\u003e\\n\\n  \\u003carticle class=\\\"onebox-body\\\"\\u003e\\n    \\n\\n\\u003ch3\\u003e\\u003ca href=\\\"https://github.wpilib.org/allwpilib/docs/release/java/edu/wpi/first/math/geometry/Rotation2d.html#plus(edu.wpi.first.math.geometry.Rotation2d)\\\" target=\\\"_blank\\\" rel=\\\"noopener nofollow ugc\\\"\\u003eRotation2d (WPILib API 2024.3.2)\\u003c/a\\u003e\\u003c/h3\\u003e\\n\\n  \\u003cp\\u003edeclaration: package: edu.wpi.first.math.geometry, class: Rotation2d\\u003c/p\\u003e\\n\\n\\n  \\u003c/article\\u003e\\n\\n  \\u003cdiv class=\\\"onebox-metadata\\\"\\u003e\\n    \\n    \\n  \\u003c/div\\u003e\\n\\n  \\u003cdiv style=\\\"clear: both\\\"\\u003e\\u003c/div\\u003e\\n\\u003c/aside\\u003e\\n\\n\\u003cp\\u003eFundamentally, Rotation2d is not an Euler angle; it’s a 2D unit vector. Thus, no assumptions should be made about the Euler angle it returns later. Rotation3d already works like this, but Rotation2d special-cases it because 254’s version did it that way first. I’ve wanted to get rid of that behavior, but was told we couldn’t because it would break too much user code. In my opinion, if a user wants Euler angle behavior, they should just use an Euler angle (\\u003ccode\\u003edouble\\u003c/code\\u003e or \\u003ccode\\u003eAngle\\u003c/code\\u003e) instead of Rotation2d.\\u003c/p\\u003e\",\"post_number\":2,\"post_type\":1,\"posts_count\":23,\"updated_at\":\"2024-10-31T23:46:30.598Z\",\"reply_count\":3,\"reply_to_post_number\":null,\"quote_count\":1,\"incoming_link_count\":3,\"reads\":350,\"readers_count\":349,\"score\":250.0,\"yours\":false,\"topic_id\":474140,\"topic_slug\":\"possible-bugs-in-rotation2d-and-rotation3d-java\",\"display_username\":\"Tyler Veness\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":2,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"link_counts\":[{\"url\":\"https://github.wpilib.org/allwpilib/docs/release/java/edu/wpi/first/math/geometry/Rotation2d.html#plus(edu.wpi.first.math.geometry.Rotation2d)\",\"internal\":false,\"reflection\":false,\"title\":\"Rotation2d (WPILib API 2024.3.2)\",\"clicks\":9}],\"read\":true,\"user_title\":\"\",\"bookmarked\":false,\"actions_summary\":[{\"id\":2,\"count\":8}],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":16846,\"hidden\":false,\"trust_level\":2,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"user_custom_fields\":{\"user_field_4\":\"WPILib controls | Choreo optimizer backend\"},\"post_url\":\"/t/possible-bugs-in-rotation2d-and-rotation3d-java/474140/2\",\"custom_user_title\":\"WPILib controls | Choreo optimizer backend\",\"reactions\":[{\"id\":\"heart\",\"type\":\"emoji\",\"count\":8}],\"current_user_reaction\":null,\"reaction_users_count\":8,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":null},{\"id\":3442392,\"name\":\"sam liu\",\"username\":\"catrix\",\"avatar_template\":\"/letter_avatar_proxy/v4/letter/c/dbc845/{size}.png\",\"created_at\":\"2024-11-01T00:48:40.868Z\",\"cooked\":\"\\u003caside class=\\\"quote no-group\\\" data-username=\\\"KfirNeuman\\\" data-post=\\\"1\\\" data-topic=\\\"474140\\\"\\u003e\\n\\u003cdiv class=\\\"title\\\"\\u003e\\n\\u003cdiv class=\\\"quote-controls\\\"\\u003e\\u003c/div\\u003e\\n\\u003cimg loading=\\\"lazy\\\" alt=\\\"\\\" width=\\\"24\\\" height=\\\"24\\\" src=\\\"https://www.chiefdelphi.com/letter_avatar_proxy/v4/letter/k/d07c76/48.png\\\" class=\\\"avatar\\\"\\u003e KfirNeuman:\\u003c/div\\u003e\\n\\u003cblockquote\\u003e\\n\\u003cp\\u003eI feel like it is not and the plus method is not supposed to wrap the value but I may be missing something.\\u003c/p\\u003e\\n\\u003c/blockquote\\u003e\\n\\u003c/aside\\u003e\\n\\u003cp\\u003eWhy do you want the angle to “not wrap” in the first place?  I mean, back then when encoders don’t have \\u003ccode\\u003egetVelocity\\u003c/code\\u003e functions, some teams may want to find the derivatives, but they can do it this way:\\u003c/p\\u003e\\n\\u003cpre\\u003e\\u003ccode class=\\\"lang-auto\\\"\\u003ecurrentRotation.minus(previousRotation).getRadians() / dtSeconds\\n\\u003c/code\\u003e\\u003c/pre\\u003e\\n\\u003cp\\u003eAnd the code above demonstrates why you want a wrap-around.  Because if does not, \\u003ccode\\u003e359 deg - 1 deg = 358 deg\\u003c/code\\u003e.   But what is the change in rotation when you travel from \\u003ccode\\u003e1deg\\u003c/code\\u003e to \\u003ccode\\u003e359deg\\u003c/code\\u003e? It’s \\u003ccode\\u003e-2 deg\\u003c/code\\u003e.\\u003c/p\\u003e\",\"post_number\":3,\"post_type\":1,\"posts_count\":23,\"updated_at\":\"2024-11-01T00:54:53.822Z\",\"reply_count\":2,\"reply_to_post_number\":null,\"quote_count\":1,\"incoming_link_count\":1,\"reads\":297,\"readers_count\":296,\"score\":74.4,\"yours\":false,\"topic_id\":474140,\"topic_slug\":\"possible-bugs-in-rotation2d-and-rotation3d-java\",\"display_username\":\"sam liu\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":2,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"read\":true,\"user_title\":\"\",\"bookmarked\":false,\"actions_summary\":[],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":60033,\"hidden\":false,\"trust_level\":2,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"user_custom_fields\":{\"user_field_4\":\"CE Student @ UWaterloo | 5516 Alum \"},\"post_url\":\"/t/possible-bugs-in-rotation2d-and-rotation3d-java/474140/3\",\"custom_user_title\":\"CE Student @ UWaterloo | 5516 Alum \",\"reactions\":[],\"current_user_reaction\":null,\"reaction_users_count\":0,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":null},{\"id\":3442452,\"name\":\"\",\"username\":\"KfirNeuman\",\"avatar_template\":\"/letter_avatar_proxy/v4/letter/k/d07c76/{size}.png\",\"created_at\":\"2024-11-01T08:55:12.998Z\",\"cooked\":\"\\u003caside class=\\\"quote no-group quote-modified\\\" data-username=\\\"calcmogul\\\" data-post=\\\"2\\\" data-topic=\\\"474140\\\"\\u003e\\n\\u003cdiv class=\\\"title\\\"\\u003e\\n\\u003cdiv class=\\\"quote-controls\\\"\\u003e\\u003c/div\\u003e\\n\\u003cimg loading=\\\"lazy\\\" alt=\\\"\\\" width=\\\"24\\\" height=\\\"24\\\" src=\\\"https://www.chiefdelphi.com/user_avatar/www.chiefdelphi.com/calcmogul/48/128045_2.png\\\" class=\\\"avatar\\\"\\u003e calcmogul:\\u003c/div\\u003e\\n\\u003cblockquote\\u003e\\n\\u003cp\\u003eThe docs for Rotation2d.plus() say it will wrap. Rotation2d only preserves the input angle in the sense that the constructor won’t wrap it.\\u003c/p\\u003e\\n\\u003cp\\u003e\\u003ca href=\\\"https://github.wpilib.org/allwpilib/docs/release/java/edu/wpi/first/math/geometry/Rotation2d.html#plus(edu.wpi.first.math.geometry.Rotation2d)\\\" class=\\\"inline-onebox\\\" rel=\\\"noopener nofollow ugc\\\"\\u003eRotation2d (WPILib API 2024.3.2)\\u003c/a\\u003e\\u003c/p\\u003e\\n\\u003c/blockquote\\u003e\\n\\u003c/aside\\u003e\\n\\u003cp\\u003eWeird I must have missed that.\\u003c/p\\u003e\\n\\u003caside class=\\\"quote no-group\\\" data-username=\\\"catrix\\\" data-post=\\\"3\\\" data-topic=\\\"474140\\\"\\u003e\\n\\u003cdiv class=\\\"title\\\"\\u003e\\n\\u003cdiv class=\\\"quote-controls\\\"\\u003e\\u003c/div\\u003e\\n\\u003cimg loading=\\\"lazy\\\" alt=\\\"\\\" width=\\\"24\\\" height=\\\"24\\\" src=\\\"https://www.chiefdelphi.com/letter_avatar_proxy/v4/letter/c/dbc845/48.png\\\" class=\\\"avatar\\\"\\u003e catrix:\\u003c/div\\u003e\\n\\u003cblockquote\\u003e\\n\\u003cp\\u003eWhy do you want the angle to “not wrap” in the first place? I mean, back then when encoders don’t have \\u003ccode\\u003egetVelocity\\u003c/code\\u003e functions, some teams may want to find the derivatives, but they can do it this way:\\u003c/p\\u003e\\n\\u003c/blockquote\\u003e\\n\\u003c/aside\\u003e\\n\\u003cp\\u003eOur team has had a lot of problems with angle units conversions in the past and it has caused a lot of bugs, so when we tried Rotation2d this year it was really helpful for us. One of the main problems we encountered was when we tried to describe our drivetrains rotational velocity with Rotation2d. The drivetrain rotates at 640 deg/s and so if we try to add a rotational velocity to it in any way it effectively becomes rotating at 220 deg/s which is not what we want.\\u003c/p\\u003e\\n\\u003cp\\u003eThis becomes more apparent in Rotation3d because for look at the following code. In this case the moment you do rotationalVelocity.times(dt) your rotationalVelocity effectively becomes 220 degs/s.\\u003c/p\\u003e\\n\\u003cp\\u003eRotation3d rotationalVelocity = new Rotation3d(640, 0, 0);\\u003cbr\\u003e\\nswerveRotation = swerveRotation.plus(rotationalVelocity.times(dt));\\u003c/p\\u003e\",\"post_number\":4,\"post_type\":1,\"posts_count\":23,\"updated_at\":\"2024-11-01T09:02:06.704Z\",\"reply_count\":2,\"reply_to_post_number\":2,\"quote_count\":2,\"incoming_link_count\":1,\"reads\":235,\"readers_count\":234,\"score\":62.0,\"yours\":false,\"topic_id\":474140,\"topic_slug\":\"possible-bugs-in-rotation2d-and-rotation3d-java\",\"display_username\":\"\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":2,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"read\":true,\"user_title\":null,\"bookmarked\":false,\"actions_summary\":[],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":62573,\"hidden\":false,\"trust_level\":2,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"user_custom_fields\":{\"user_field_4\":\"3075 Code Lead\"},\"post_url\":\"/t/possible-bugs-in-rotation2d-and-rotation3d-java/474140/4\",\"custom_user_title\":\"3075 Code Lead\",\"reactions\":[],\"current_user_reaction\":null,\"reaction_users_count\":0,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":null},{\"id\":3442453,\"name\":\"sam liu\",\"username\":\"catrix\",\"avatar_template\":\"/letter_avatar_proxy/v4/letter/c/dbc845/{size}.png\",\"created_at\":\"2024-11-01T09:23:53.249Z\",\"cooked\":\"\\u003cp\\u003eI don’t think \\u003ccode\\u003eRotation2d\\u003c/code\\u003e or \\u003ccode\\u003eRotation3d\\u003c/code\\u003e can represent angular velocity; they represent either a direction or a change in direction.\\u003c/p\\u003e\\n\\u003cp\\u003eLike in your example, I think a more appropriate approach would be:\\u003c/p\\u003e\\n\\u003cpre\\u003e\\u003ccode class=\\\"lang-auto\\\"\\u003eswerveRotation = swerveRotation.plus(new Rotation3d(640 * dt, 0, 0));\\n\\u003c/code\\u003e\\u003c/pre\\u003e\",\"post_number\":5,\"post_type\":1,\"posts_count\":23,\"updated_at\":\"2024-11-01T09:35:41.875Z\",\"reply_count\":1,\"reply_to_post_number\":4,\"quote_count\":0,\"incoming_link_count\":0,\"reads\":197,\"readers_count\":196,\"score\":44.4,\"yours\":false,\"topic_id\":474140,\"topic_slug\":\"possible-bugs-in-rotation2d-and-rotation3d-java\",\"display_username\":\"sam liu\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":2,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"read\":true,\"user_title\":\"\",\"reply_to_user\":{\"id\":62573,\"username\":\"KfirNeuman\",\"name\":\"\",\"avatar_template\":\"/letter_avatar_proxy/v4/letter/k/d07c76/{size}.png\"},\"bookmarked\":false,\"actions_summary\":[],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":60033,\"hidden\":false,\"trust_level\":2,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"user_custom_fields\":{\"user_field_4\":\"CE Student @ UWaterloo | 5516 Alum \"},\"post_url\":\"/t/possible-bugs-in-rotation2d-and-rotation3d-java/474140/5\",\"custom_user_title\":\"CE Student @ UWaterloo | 5516 Alum \",\"reactions\":[],\"current_user_reaction\":null,\"reaction_users_count\":0,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":null},{\"id\":3442454,\"name\":\"\",\"username\":\"KfirNeuman\",\"avatar_template\":\"/letter_avatar_proxy/v4/letter/k/d07c76/{size}.png\",\"created_at\":\"2024-11-01T09:37:33.593Z\",\"cooked\":\"\\u003caside class=\\\"quote no-group quote-modified\\\" data-username=\\\"catrix\\\" data-post=\\\"5\\\" data-topic=\\\"474140\\\"\\u003e\\n\\u003cdiv class=\\\"title\\\"\\u003e\\n\\u003cdiv class=\\\"quote-controls\\\"\\u003e\\u003c/div\\u003e\\n\\u003cimg loading=\\\"lazy\\\" alt=\\\"\\\" width=\\\"24\\\" height=\\\"24\\\" src=\\\"https://www.chiefdelphi.com/letter_avatar_proxy/v4/letter/c/dbc845/48.png\\\" class=\\\"avatar\\\"\\u003e catrix:\\u003c/div\\u003e\\n\\u003cblockquote\\u003e\\n\\u003cp\\u003eYou can just use double\\u003c/p\\u003e\\n\\u003c/blockquote\\u003e\\n\\u003c/aside\\u003e\\n\\u003cp\\u003eThis is what we did in previous years, but it created a lot of bugs where functions would expect inputs in one unit and people would input a different unit. If Rotation2d is implemented without any wrapping then it can also represent derivatives of an angle without any problems which is super helpful.\\u003c/p\\u003e\\n\\u003caside class=\\\"quote no-group\\\" data-username=\\\"calcmogul\\\" data-post=\\\"2\\\" data-topic=\\\"474140\\\"\\u003e\\n\\u003cdiv class=\\\"title\\\"\\u003e\\n\\u003cdiv class=\\\"quote-controls\\\"\\u003e\\u003c/div\\u003e\\n\\u003cimg loading=\\\"lazy\\\" alt=\\\"\\\" width=\\\"24\\\" height=\\\"24\\\" src=\\\"https://www.chiefdelphi.com/user_avatar/www.chiefdelphi.com/calcmogul/48/128045_2.png\\\" class=\\\"avatar\\\"\\u003e calcmogul:\\u003c/div\\u003e\\n\\u003cblockquote\\u003e\\n\\u003cp\\u003eif a user wants Euler angle behavior, they should just use an Euler angle (\\u003ccode\\u003edouble\\u003c/code\\u003e or \\u003ccode\\u003eAngle\\u003c/code\\u003e) instead of Rotation2d.\\u003c/p\\u003e\\n\\u003c/blockquote\\u003e\\n\\u003c/aside\\u003e\\n\\u003cp\\u003eMy problem with using Angle for example is that it means using multiple types to represent angles. We use Translation2d for example and it has a getAngle method which returns a Rotation2d. If we wanted to use Angle then we would have to convert that Rotation2d into angle each time.\\u003c/p\\u003e\",\"post_number\":6,\"post_type\":1,\"posts_count\":23,\"updated_at\":\"2024-11-01T09:37:33.593Z\",\"reply_count\":2,\"reply_to_post_number\":5,\"quote_count\":2,\"incoming_link_count\":1,\"reads\":197,\"readers_count\":196,\"score\":54.4,\"yours\":false,\"topic_id\":474140,\"topic_slug\":\"possible-bugs-in-rotation2d-and-rotation3d-java\",\"display_username\":\"\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":1,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"read\":true,\"user_title\":null,\"bookmarked\":false,\"actions_summary\":[],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":62573,\"hidden\":false,\"trust_level\":2,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"user_custom_fields\":{\"user_field_4\":\"3075 Code Lead\"},\"post_url\":\"/t/possible-bugs-in-rotation2d-and-rotation3d-java/474140/6\",\"custom_user_title\":\"3075 Code Lead\",\"reactions\":[],\"current_user_reaction\":null,\"reaction_users_count\":0,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":null},{\"id\":3442455,\"name\":\"sam liu\",\"username\":\"catrix\",\"avatar_template\":\"/letter_avatar_proxy/v4/letter/c/dbc845/{size}.png\",\"created_at\":\"2024-11-01T09:43:29.635Z\",\"cooked\":\"\\u003caside class=\\\"quote no-group\\\" data-username=\\\"KfirNeuman\\\" data-post=\\\"6\\\" data-topic=\\\"474140\\\"\\u003e\\n\\u003cdiv class=\\\"title\\\"\\u003e\\n\\u003cdiv class=\\\"quote-controls\\\"\\u003e\\u003c/div\\u003e\\n\\u003cimg loading=\\\"lazy\\\" alt=\\\"\\\" width=\\\"24\\\" height=\\\"24\\\" src=\\\"https://www.chiefdelphi.com/letter_avatar_proxy/v4/letter/k/d07c76/48.png\\\" class=\\\"avatar\\\"\\u003e KfirNeuman:\\u003c/div\\u003e\\n\\u003cblockquote\\u003e\\n\\u003cp\\u003ewhere functions would expect inputs in one unit and people would input a different unit.\\u003c/p\\u003e\\n\\u003c/blockquote\\u003e\\n\\u003c/aside\\u003e\\n\\u003cp\\u003eYou can do:\\u003c/p\\u003e\\n\\u003cpre\\u003e\\u003ccode class=\\\"lang-auto\\\"\\u003epublic void function(double omegaRadiansPerSecond) {\\n\\n}\\n\\u003c/code\\u003e\\u003c/pre\\u003e\\n\\u003cp\\u003eIf you don’t use WPILib units, you’ll need to do this all over your code anyway.  Like you need to have \\u003ccode\\u003espeedMetersPerSecond\\u003c/code\\u003e and \\u003ccode\\u003ecurrentAmps\\u003c/code\\u003e and so on.\\u003c/p\\u003e\",\"post_number\":7,\"post_type\":1,\"posts_count\":23,\"updated_at\":\"2024-11-01T09:43:29.635Z\",\"reply_count\":0,\"reply_to_post_number\":6,\"quote_count\":1,\"incoming_link_count\":0,\"reads\":186,\"readers_count\":185,\"score\":37.2,\"yours\":false,\"topic_id\":474140,\"topic_slug\":\"possible-bugs-in-rotation2d-and-rotation3d-java\",\"display_username\":\"sam liu\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":1,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"read\":true,\"user_title\":\"\",\"bookmarked\":false,\"actions_summary\":[],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":60033,\"hidden\":false,\"trust_level\":2,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"user_custom_fields\":{\"user_field_4\":\"CE Student @ UWaterloo | 5516 Alum \"},\"post_url\":\"/t/possible-bugs-in-rotation2d-and-rotation3d-java/474140/7\",\"custom_user_title\":\"CE Student @ UWaterloo | 5516 Alum \",\"reactions\":[],\"current_user_reaction\":null,\"reaction_users_count\":0,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":null},{\"id\":3442477,\"name\":\"Eli Barnett\",\"username\":\"Oblarg\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/oblarg/{size}/161674_2.png\",\"created_at\":\"2024-11-01T12:21:22.914Z\",\"cooked\":\"\\u003caside class=\\\"quote no-group\\\" data-username=\\\"KfirNeuman\\\" data-post=\\\"6\\\" data-topic=\\\"474140\\\"\\u003e\\n\\u003cdiv class=\\\"title\\\"\\u003e\\n\\u003cdiv class=\\\"quote-controls\\\"\\u003e\\u003c/div\\u003e\\n\\u003cimg loading=\\\"lazy\\\" alt=\\\"\\\" width=\\\"24\\\" height=\\\"24\\\" src=\\\"https://www.chiefdelphi.com/letter_avatar_proxy/v4/letter/k/d07c76/48.png\\\" class=\\\"avatar\\\"\\u003e KfirNeuman:\\u003c/div\\u003e\\n\\u003cblockquote\\u003e\\n\\u003cp\\u003eIf we wanted to use Angle then we would have to convert that Rotation2d into angle each time.\\u003c/p\\u003e\\n\\u003c/blockquote\\u003e\\n\\u003c/aside\\u003e\\n\\u003cp\\u003eThis is kind of unavoidable, and is what implicit conversions in C++ are for.  Java is verbose here, unfortunately.\\u003c/p\\u003e\",\"post_number\":8,\"post_type\":1,\"posts_count\":23,\"updated_at\":\"2024-11-01T12:21:22.914Z\",\"reply_count\":1,\"reply_to_post_number\":6,\"quote_count\":1,\"incoming_link_count\":0,\"reads\":175,\"readers_count\":174,\"score\":40.0,\"yours\":false,\"topic_id\":474140,\"topic_slug\":\"possible-bugs-in-rotation2d-and-rotation3d-java\",\"display_username\":\"Eli Barnett\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":1,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"read\":true,\"user_title\":\"\",\"bookmarked\":false,\"actions_summary\":[],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":12381,\"hidden\":false,\"trust_level\":2,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"user_custom_fields\":{\"user_field_4\":\"Robot apartments! invisible suburbs! skeleton treasuries!\"},\"post_url\":\"/t/possible-bugs-in-rotation2d-and-rotation3d-java/474140/8\",\"custom_user_title\":\"Robot apartments! invisible suburbs! skeleton treasuries!\",\"reactions\":[],\"current_user_reaction\":null,\"reaction_users_count\":0,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":null},{\"id\":3442504,\"name\":\"Ryan Blue\",\"username\":\"Ryan_Blue\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/ryan_blue/{size}/174016_2.png\",\"created_at\":\"2024-11-01T14:37:10.782Z\",\"cooked\":\"\\u003caside class=\\\"quote no-group\\\" data-username=\\\"catrix\\\" data-post=\\\"3\\\" data-topic=\\\"474140\\\"\\u003e\\n\\u003cdiv class=\\\"title\\\"\\u003e\\n\\u003cdiv class=\\\"quote-controls\\\"\\u003e\\u003c/div\\u003e\\n\\u003cimg loading=\\\"lazy\\\" alt=\\\"\\\" width=\\\"24\\\" height=\\\"24\\\" src=\\\"https://www.chiefdelphi.com/letter_avatar_proxy/v4/letter/c/dbc845/48.png\\\" class=\\\"avatar\\\"\\u003e catrix:\\u003c/div\\u003e\\n\\u003cblockquote\\u003e\\n\\u003cp\\u003esome teams may want to find the derivatives, but they can do it this way:\\u003c/p\\u003e\\n\\u003cpre\\u003e\\u003ccode class=\\\"lang-auto\\\"\\u003ecurrentRotation.minus(previousRotation).getRadians() / dtSeconds\\n\\u003c/code\\u003e\\u003c/pre\\u003e\\n\\u003c/blockquote\\u003e\\n\\u003c/aside\\u003e\\n\\u003cp\\u003eNote that that doesn’t work to find the rate of change. \\u003ccode\\u003eminus\\u003c/code\\u003e also wraps to (-pi, pi).\\u003c/p\\u003e\",\"post_number\":9,\"post_type\":1,\"posts_count\":23,\"updated_at\":\"2024-11-01T14:37:10.782Z\",\"reply_count\":2,\"reply_to_post_number\":3,\"quote_count\":1,\"incoming_link_count\":0,\"reads\":161,\"readers_count\":160,\"score\":42.2,\"yours\":false,\"topic_id\":474140,\"topic_slug\":\"possible-bugs-in-rotation2d-and-rotation3d-java\",\"display_username\":\"Ryan Blue\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":1,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"read\":true,\"user_title\":\"\",\"bookmarked\":false,\"actions_summary\":[],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":29846,\"hidden\":false,\"trust_level\":2,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"user_custom_fields\":{\"user_field_4\":\"WPILib Dev | 1024 Mentor\"},\"post_url\":\"/t/possible-bugs-in-rotation2d-and-rotation3d-java/474140/9\",\"custom_user_title\":\"WPILib Dev | 1024 Mentor\",\"reactions\":[],\"current_user_reaction\":null,\"reaction_users_count\":0,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":null},{\"id\":3442564,\"name\":\"Tyler Veness\",\"username\":\"calcmogul\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/calcmogul/{size}/128045_2.png\",\"created_at\":\"2024-11-01T15:48:53.849Z\",\"cooked\":\"\\u003caside class=\\\"quote no-group\\\" data-username=\\\"KfirNeuman\\\" data-post=\\\"4\\\" data-topic=\\\"474140\\\"\\u003e\\n\\u003cdiv class=\\\"title\\\"\\u003e\\n\\u003cdiv class=\\\"quote-controls\\\"\\u003e\\u003c/div\\u003e\\n\\u003cimg loading=\\\"lazy\\\" alt=\\\"\\\" width=\\\"24\\\" height=\\\"24\\\" src=\\\"https://www.chiefdelphi.com/letter_avatar_proxy/v4/letter/k/d07c76/48.png\\\" class=\\\"avatar\\\"\\u003e KfirNeuman:\\u003c/div\\u003e\\n\\u003cblockquote\\u003e\\n\\u003cp\\u003eOur team has had a lot of problems with angle units conversions in the past and it has caused a lot of bugs\\u003c/p\\u003e\\n\\u003c/blockquote\\u003e\\n\\u003c/aside\\u003e\\n\\u003cp\\u003eUnit types are the correct fix for this, not Rotation2d. Unfortunately, Java is worse at this than C++ due to language and target platform limitations.\\u003c/p\\u003e\\n\\u003caside class=\\\"quote no-group\\\" data-username=\\\"Oblarg\\\" data-post=\\\"8\\\" data-topic=\\\"474140\\\"\\u003e\\n\\u003cdiv class=\\\"title\\\"\\u003e\\n\\u003cdiv class=\\\"quote-controls\\\"\\u003e\\u003c/div\\u003e\\n\\u003cimg loading=\\\"lazy\\\" alt=\\\"\\\" width=\\\"24\\\" height=\\\"24\\\" src=\\\"https://www.chiefdelphi.com/user_avatar/www.chiefdelphi.com/oblarg/48/161674_2.png\\\" class=\\\"avatar\\\"\\u003e Oblarg:\\u003c/div\\u003e\\n\\u003cblockquote\\u003e\\n\\u003cp\\u003eThis is kind of unavoidable, and is what implicit conversions in C++ are for\\u003c/p\\u003e\\n\\u003c/blockquote\\u003e\\n\\u003c/aside\\u003e\\n\\u003cp\\u003eRotation2d doesn’t implicitly convert to an Euler angle. You have to use \\u003ccode\\u003eDegrees()\\u003c/code\\u003e or \\u003ccode\\u003eRadians()\\u003c/code\\u003e.\\u003c/p\\u003e\\n\\u003caside class=\\\"quote no-group\\\" data-username=\\\"Ryan_Blue\\\" data-post=\\\"9\\\" data-topic=\\\"474140\\\"\\u003e\\n\\u003cdiv class=\\\"title\\\"\\u003e\\n\\u003cdiv class=\\\"quote-controls\\\"\\u003e\\u003c/div\\u003e\\n\\u003cimg loading=\\\"lazy\\\" alt=\\\"\\\" width=\\\"24\\\" height=\\\"24\\\" src=\\\"https://www.chiefdelphi.com/user_avatar/www.chiefdelphi.com/ryan_blue/48/174016_2.png\\\" class=\\\"avatar\\\"\\u003e Ryan_Blue:\\u003c/div\\u003e\\n\\u003cblockquote\\u003e\\n\\u003cp\\u003eNote that that doesn’t work to find the rate of change. \\u003ccode\\u003eminus\\u003c/code\\u003e also wraps to (-pi, pi).\\u003c/p\\u003e\\n\\u003c/blockquote\\u003e\\n\\u003c/aside\\u003e\\n\\u003cp\\u003eIt’s correct in the sense that the 2D orientation aliases on the SO(2) manifold. SO(2) just isn’t the orientation representation they care about.\\u003c/p\\u003e\",\"post_number\":10,\"post_type\":1,\"posts_count\":23,\"updated_at\":\"2024-11-01T15:50:06.141Z\",\"reply_count\":1,\"reply_to_post_number\":4,\"quote_count\":3,\"incoming_link_count\":3,\"reads\":152,\"readers_count\":151,\"score\":50.4,\"yours\":false,\"topic_id\":474140,\"topic_slug\":\"possible-bugs-in-rotation2d-and-rotation3d-java\",\"display_username\":\"Tyler Veness\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":1,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"read\":true,\"user_title\":\"\",\"bookmarked\":false,\"actions_summary\":[],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":16846,\"hidden\":false,\"trust_level\":2,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"user_custom_fields\":{\"user_field_4\":\"WPILib controls | Choreo optimizer backend\"},\"post_url\":\"/t/possible-bugs-in-rotation2d-and-rotation3d-java/474140/10\",\"custom_user_title\":\"WPILib controls | Choreo optimizer backend\",\"reactions\":[],\"current_user_reaction\":null,\"reaction_users_count\":0,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":null},{\"id\":3442596,\"name\":\"Jared Russell\",\"username\":\"Jared_Russell\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/jared_russell/{size}/399_2.png\",\"created_at\":\"2024-11-01T16:30:33.588Z\",\"cooked\":\"\\u003caside class=\\\"quote no-group\\\" data-username=\\\"calcmogul\\\" data-post=\\\"2\\\" data-topic=\\\"474140\\\"\\u003e\\n\\u003cdiv class=\\\"title\\\"\\u003e\\n\\u003cdiv class=\\\"quote-controls\\\"\\u003e\\u003c/div\\u003e\\n\\u003cimg loading=\\\"lazy\\\" alt=\\\"\\\" width=\\\"24\\\" height=\\\"24\\\" src=\\\"https://www.chiefdelphi.com/user_avatar/www.chiefdelphi.com/calcmogul/48/128045_2.png\\\" class=\\\"avatar\\\"\\u003e calcmogul:\\u003c/div\\u003e\\n\\u003cblockquote\\u003e\\n\\u003cp\\u003eRotation3d already works like this, but Rotation2d special-cases it because 254’s version did it that way first\\u003c/p\\u003e\\n\\u003c/blockquote\\u003e\\n\\u003c/aside\\u003e\\n\\u003cp\\u003eWe initially based Rotation2d and all the other manifold geometry methods on Sophus (\\u003ca href=\\\"https://github.com/strasdat/Sophus/blob/main/sophus/so2.hpp#L52-L76\\\" class=\\\"inline-onebox\\\" rel=\\\"noopener nofollow ugc\\\"\\u003eSophus/sophus/so2.hpp at main · strasdat/Sophus · GitHub\\u003c/a\\u003e), so the idea is that Rotation2d is a member of SO(2). There are an infinite number of Euler angles that can map to an individual SO(2) rotation, so the convention we adopted was to always* wrap the Euler angle we provide back to the user to remove this ambiguity.\\u003c/p\\u003e\\n\\u003cp\\u003eOn the RoboRIO’s potato-sized processor, we found value in letting Rotation2d act something as a union type, with the ability to store the Euler angle and/or the unit vector containing SO2 elements independently, and lazily computing (and caching) the missing fields upon asking for them: \\u003ca href=\\\"https://github.com/Team254/FRC-2023-Public/blob/main/src/main/java/com/team254/lib/geometry/Rotation2d.java\\\" class=\\\"inline-onebox\\\" rel=\\\"noopener nofollow ugc\\\"\\u003eFRC-2023-Public/src/main/java/com/team254/lib/geometry/Rotation2d.java at main · Team254/FRC-2023-Public · GitHub\\u003c/a\\u003e\\u003c/p\\u003e\\n\\u003cp\\u003eBut conceptually, we want it to be as if “getRadians()” was always computed anew from the SO(2) rotation and so adopted a canonical wrapping scheme. If you want to do math on Euler angles without adopting SO(2) semantics, then you should use doubles or a first class Angle type.\\u003cbr\\u003e\\n\\u003cbr\\u003e\\n\\u003cbr\\u003e\\n* as a (very small and likely premature) performance optimization we did allow construction without enforcing wrapping as a deliberate breach of this contract only because in many cases the caller trivially knows they aren’t wrapped, or knows that whatever math they are doing later won’t care.\\u003c/p\\u003e\",\"post_number\":11,\"post_type\":1,\"posts_count\":23,\"updated_at\":\"2024-11-01T16:31:22.013Z\",\"reply_count\":1,\"reply_to_post_number\":2,\"quote_count\":1,\"incoming_link_count\":6,\"reads\":140,\"readers_count\":139,\"score\":63.0,\"yours\":false,\"topic_id\":474140,\"topic_slug\":\"possible-bugs-in-rotation2d-and-rotation3d-java\",\"display_username\":\"Jared Russell\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":1,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"link_counts\":[{\"url\":\"https://github.com/strasdat/Sophus/blob/main/sophus/so2.hpp#L52-L76\",\"internal\":false,\"reflection\":false,\"title\":\"Sophus/sophus/so2.hpp at main · strasdat/Sophus · GitHub\",\"clicks\":6},{\"url\":\"https://github.com/Team254/FRC-2023-Public/blob/main/src/main/java/com/team254/lib/geometry/Rotation2d.java\",\"internal\":false,\"reflection\":false,\"title\":\"FRC-2023-Public/src/main/java/com/team254/lib/geometry/Rotation2d.java at main · Team254/FRC-2023-Public · GitHub\",\"clicks\":5}],\"read\":true,\"user_title\":\"\",\"bookmarked\":false,\"actions_summary\":[],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":1267,\"hidden\":false,\"trust_level\":2,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"user_custom_fields\":{\"user_field_4\":\"Oh so close\"},\"post_url\":\"/t/possible-bugs-in-rotation2d-and-rotation3d-java/474140/11\",\"custom_user_title\":\"Oh so close\",\"reactions\":[],\"current_user_reaction\":null,\"reaction_users_count\":0,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":null},{\"id\":3442614,\"name\":\"Tyler Veness\",\"username\":\"calcmogul\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/calcmogul/{size}/128045_2.png\",\"created_at\":\"2024-11-01T16:56:08.489Z\",\"cooked\":\"\\u003caside class=\\\"quote no-group\\\" data-username=\\\"Jared_Russell\\\" data-post=\\\"11\\\" data-topic=\\\"474140\\\"\\u003e\\n\\u003cdiv class=\\\"title\\\"\\u003e\\n\\u003cdiv class=\\\"quote-controls\\\"\\u003e\\u003c/div\\u003e\\n\\u003cimg loading=\\\"lazy\\\" alt=\\\"\\\" width=\\\"24\\\" height=\\\"24\\\" src=\\\"https://www.chiefdelphi.com/user_avatar/www.chiefdelphi.com/jared_russell/48/399_2.png\\\" class=\\\"avatar\\\"\\u003e Jared_Russell:\\u003c/div\\u003e\\n\\u003cblockquote\\u003e\\n\\u003cp\\u003eas a (very small and likely premature) performance optimization we did allow construction without enforcing wrapping as a deliberate breach of this contract\\u003c/p\\u003e\\n\\u003c/blockquote\\u003e\\n\\u003c/aside\\u003e\\n\\u003cp\\u003eUnfortunately, we didn’t realize this was the design intent and baked that exception into the API contract of WPILib’s version. \\u003cimg src=\\\"https://www.chiefdelphi.com/images/emoji/google/frowning.png?v=12\\\" title=\\\":frowning:\\\" class=\\\"emoji\\\" alt=\\\":frowning:\\\" loading=\\\"lazy\\\" width=\\\"20\\\" height=\\\"20\\\"\\u003e\\u003c/p\\u003e\",\"post_number\":12,\"post_type\":1,\"posts_count\":23,\"updated_at\":\"2024-11-01T17:01:19.923Z\",\"reply_count\":0,\"reply_to_post_number\":11,\"quote_count\":1,\"incoming_link_count\":0,\"reads\":130,\"readers_count\":129,\"score\":26.0,\"yours\":false,\"topic_id\":474140,\"topic_slug\":\"possible-bugs-in-rotation2d-and-rotation3d-java\",\"display_username\":\"Tyler Veness\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":2,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"read\":true,\"user_title\":\"\",\"bookmarked\":false,\"actions_summary\":[],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":16846,\"hidden\":false,\"trust_level\":2,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"user_custom_fields\":{\"user_field_4\":\"WPILib controls | Choreo optimizer backend\"},\"post_url\":\"/t/possible-bugs-in-rotation2d-and-rotation3d-java/474140/12\",\"custom_user_title\":\"WPILib controls | Choreo optimizer backend\",\"reactions\":[{\"id\":\"cry\",\"type\":\"emoji\",\"count\":1}],\"current_user_reaction\":null,\"reaction_users_count\":1,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":null},{\"id\":3442676,\"name\":\"sam liu\",\"username\":\"catrix\",\"avatar_template\":\"/letter_avatar_proxy/v4/letter/c/dbc845/{size}.png\",\"created_at\":\"2024-11-01T18:37:07.475Z\",\"cooked\":\"\\u003cp\\u003eI think it works correctly exactly because minus wraps the angle.\\u003cbr\\u003e\\nThink about this:\\u003cbr\\u003e\\nIf the robot was at 1deg the previous period and 359deg the next\\u003c/p\\u003e\\n\\u003cul\\u003e\\n\\u003cli\\u003eif minus does not wrap the angle, \\u003ccode\\u003ecurrentRotation.minus(previousRotation)\\u003c/code\\u003e is 358deg, the estimated angular velocity is 358/dt.\\u003c/li\\u003e\\n\\u003cli\\u003eif minus wraps the angle, the estimated angular velocity is -2/dt\\u003c/li\\u003e\\n\\u003c/ul\\u003e\\n\\u003cp\\u003eapparently the later is the correct measure\\u003c/p\\u003e\",\"post_number\":13,\"post_type\":1,\"posts_count\":23,\"updated_at\":\"2024-11-01T18:37:07.475Z\",\"reply_count\":1,\"reply_to_post_number\":9,\"quote_count\":0,\"incoming_link_count\":0,\"reads\":121,\"readers_count\":120,\"score\":29.2,\"yours\":false,\"topic_id\":474140,\"topic_slug\":\"possible-bugs-in-rotation2d-and-rotation3d-java\",\"display_username\":\"sam liu\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":1,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"read\":true,\"user_title\":\"\",\"reply_to_user\":{\"id\":29846,\"username\":\"Ryan_Blue\",\"name\":\"Ryan Blue\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/ryan_blue/{size}/174016_2.png\"},\"bookmarked\":false,\"actions_summary\":[],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":60033,\"hidden\":false,\"trust_level\":2,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"user_custom_fields\":{\"user_field_4\":\"CE Student @ UWaterloo | 5516 Alum \"},\"post_url\":\"/t/possible-bugs-in-rotation2d-and-rotation3d-java/474140/13\",\"custom_user_title\":\"CE Student @ UWaterloo | 5516 Alum \",\"reactions\":[],\"current_user_reaction\":null,\"reaction_users_count\":0,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":null},{\"id\":3442725,\"name\":\"Scott W\",\"username\":\"Programming4907\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/programming4907/{size}/168313_2.png\",\"created_at\":\"2024-11-01T19:04:53.353Z\",\"cooked\":\"\\u003cp\\u003eJust to add a data point… the NavX2 \\u003ccode\\u003eAHRS\\u003c/code\\u003e class inherits from \\u003ccode\\u003eGyro\\u003c/code\\u003e (a WPILib class which has been deprecated).\\u003c/p\\u003e\\n\\u003cp\\u003eThat \\u003ccode\\u003eGyro\\u003c/code\\u003e class has a \\u003ccode\\u003egetRotation2d\\u003c/code\\u003e method which returns a \\u003ccode\\u003eRotation2d\\u003c/code\\u003e object and is continuous (i.e. it doesn’t wrap).  This is actually the method we were using to get continuous rotation signal from our gyro.\\u003c/p\\u003e\\n\\u003cp\\u003eThe AHRS class also has a \\u003ccode\\u003egetYaw\\u003c/code\\u003e method which will return a double from -180 to 180 (in degrees obviously).\\u003c/p\\u003e\\n\\u003cp\\u003eWhich all feels a little backwards to me.\\u003c/p\\u003e\",\"post_number\":14,\"post_type\":1,\"posts_count\":23,\"updated_at\":\"2024-11-01T19:04:53.353Z\",\"reply_count\":0,\"reply_to_post_number\":null,\"quote_count\":0,\"incoming_link_count\":2,\"reads\":117,\"readers_count\":116,\"score\":33.4,\"yours\":false,\"topic_id\":474140,\"topic_slug\":\"possible-bugs-in-rotation2d-and-rotation3d-java\",\"display_username\":\"Scott W\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":1,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"read\":true,\"user_title\":\"\",\"bookmarked\":false,\"actions_summary\":[],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":50699,\"hidden\":false,\"trust_level\":2,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"user_custom_fields\":{\"user_field_4\":\"\"},\"post_url\":\"/t/possible-bugs-in-rotation2d-and-rotation3d-java/474140/14\",\"custom_user_title\":null,\"reactions\":[],\"current_user_reaction\":null,\"reaction_users_count\":0,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":null},{\"id\":3442733,\"name\":\"Ryan Blue\",\"username\":\"Ryan_Blue\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/ryan_blue/{size}/174016_2.png\",\"created_at\":\"2024-11-01T19:19:24.977Z\",\"cooked\":\"\\u003cp\\u003eIn this example you appear to be assuming the input angles are already wrapped to (0, 360), which makes this moot.\\u003c/p\\u003e\\n\\u003cp\\u003eAs Tyler said:\\u003c/p\\u003e\\n\\u003caside class=\\\"quote no-group\\\" data-username=\\\"calcmogul\\\" data-post=\\\"10\\\" data-topic=\\\"474140\\\"\\u003e\\n\\u003cdiv class=\\\"title\\\"\\u003e\\n\\u003cdiv class=\\\"quote-controls\\\"\\u003e\\u003c/div\\u003e\\n\\u003cimg loading=\\\"lazy\\\" alt=\\\"\\\" width=\\\"24\\\" height=\\\"24\\\" src=\\\"https://www.chiefdelphi.com/user_avatar/www.chiefdelphi.com/calcmogul/48/128045_2.png\\\" class=\\\"avatar\\\"\\u003e calcmogul:\\u003c/div\\u003e\\n\\u003cblockquote\\u003e\\n\\u003cp\\u003eIt’s correct in the sense that the 2D orientation aliases on the SO(2) manifold. SO(2) just isn’t the orientation representation they care about.\\u003c/p\\u003e\\n\\u003c/blockquote\\u003e\\n\\u003c/aside\\u003e\\n\\u003cp\\u003eHere’s an example:\\u003c/p\\u003e\\n\\u003cp\\u003eWhat is the average angular velocity of the robot in this scenario?\\u003cbr\\u003e\\nWhat happens when you wrap the difference to (-pi, pi) when calculating average angular velocity?\\u003c/p\\u003e\\n\\u003cpre\\u003e\\u003ccode class=\\\"lang-auto\\\"\\u003eθ_1 = 0 rad\\nθ_2 = 2*pi rad\\ndt = 1 second\\n\\u003c/code\\u003e\\u003c/pre\\u003e\",\"post_number\":15,\"post_type\":1,\"posts_count\":23,\"updated_at\":\"2024-11-01T19:19:24.977Z\",\"reply_count\":1,\"reply_to_post_number\":13,\"quote_count\":1,\"incoming_link_count\":2,\"reads\":111,\"readers_count\":110,\"score\":37.2,\"yours\":false,\"topic_id\":474140,\"topic_slug\":\"possible-bugs-in-rotation2d-and-rotation3d-java\",\"display_username\":\"Ryan Blue\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":1,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"read\":true,\"user_title\":\"\",\"reply_to_user\":{\"id\":60033,\"username\":\"catrix\",\"name\":\"sam liu\",\"avatar_template\":\"/letter_avatar_proxy/v4/letter/c/dbc845/{size}.png\"},\"bookmarked\":false,\"actions_summary\":[],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":29846,\"hidden\":false,\"trust_level\":2,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"user_custom_fields\":{\"user_field_4\":\"WPILib Dev | 1024 Mentor\"},\"post_url\":\"/t/possible-bugs-in-rotation2d-and-rotation3d-java/474140/15\",\"custom_user_title\":\"WPILib Dev | 1024 Mentor\",\"reactions\":[],\"current_user_reaction\":null,\"reaction_users_count\":0,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":null},{\"id\":3442990,\"name\":\"\",\"username\":\"KfirNeuman\",\"avatar_template\":\"/letter_avatar_proxy/v4/letter/k/d07c76/{size}.png\",\"created_at\":\"2024-11-02T16:34:34.370Z\",\"cooked\":\"\\u003cp\\u003eOk, so if I wanted to define 3d angular velocities what is the best non-wrapping, unit safe way to do it?\\u003c/p\\u003e\\n\\u003cp\\u003eUsing a Rotation3d won’t work because it is wrapping.\\u003c/p\\u003e\\n\\u003cp\\u003eI can try using the Units library but this is really verbose and I have to define the roll, pitch, and yaw as seperate variables as opposed to having one variable which stores them all. What I put below is also technically not unit safe because it is possible to change the Units.Radians.of to Units.Degrees.of. I think I may be missing something with how multiplication works for units, but this is the only way I could get it to compile.\\u003c/p\\u003e\\n\\u003cpre\\u003e\\u003ccode\\u003e    Measure\\u0026lt;Velocity\\u0026lt;Angle\\u0026gt;\\u0026gt; omegaRoll = Units.DegreesPerSecond.of(30);\\n    Measure\\u0026lt;Velocity\\u0026lt;Angle\\u0026gt;\\u0026gt; omegaPitch = Units.DegreesPerSecond.of(-10);\\n    Measure\\u0026lt;Velocity\\u0026lt;Angle\\u0026gt;\\u0026gt; omegaYaw = Units.DegreesPerSecond.of(60);\\n\\n    Measure\\u0026lt;Time\\u0026gt; dt = Units.Seconds.of(0.02);\\n\\n    roll = roll.plus(Units.Radians.of(omegaRoll.in(Units.RadiansPerSecond) * dt.in(Units.Seconds)));\\n    pitch = pitch.plus(Units.Radians.of(omegaPitch.in(Units.RadiansPerSecond) * dt.in(Units.Seconds)));\\n    yaw = yaw.plus(Units.Radians.of(omegaYaw.in(Units.RadiansPerSecond) * dt.in(Units.Seconds)));\\n\\u003c/code\\u003e\\u003c/pre\\u003e\",\"post_number\":16,\"post_type\":1,\"posts_count\":23,\"updated_at\":\"2024-11-02T16:34:34.370Z\",\"reply_count\":2,\"reply_to_post_number\":null,\"quote_count\":0,\"incoming_link_count\":0,\"reads\":90,\"readers_count\":89,\"score\":28.0,\"yours\":false,\"topic_id\":474140,\"topic_slug\":\"possible-bugs-in-rotation2d-and-rotation3d-java\",\"display_username\":\"\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":1,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"read\":true,\"user_title\":null,\"bookmarked\":false,\"actions_summary\":[],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":62573,\"hidden\":false,\"trust_level\":2,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"user_custom_fields\":{\"user_field_4\":\"3075 Code Lead\"},\"post_url\":\"/t/possible-bugs-in-rotation2d-and-rotation3d-java/474140/16\",\"custom_user_title\":\"3075 Code Lead\",\"reactions\":[],\"current_user_reaction\":null,\"reaction_users_count\":0,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":null},{\"id\":3443029,\"name\":\"Fletch\",\"username\":\"Fletch1373\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/fletch1373/{size}/220073_2.png\",\"created_at\":\"2024-11-02T19:18:19.285Z\",\"cooked\":\"\\u003cp\\u003eYou could create your own AngularVelocity2d (or 3d) class to wrap the multiple dimensions into a single object (similar to how Rotation2d/3d works, but with velocity in mind rather than (angular) position)\\u003c/p\\u003e\",\"post_number\":17,\"post_type\":1,\"posts_count\":23,\"updated_at\":\"2024-11-02T19:18:19.285Z\",\"reply_count\":0,\"reply_to_post_number\":16,\"quote_count\":0,\"incoming_link_count\":0,\"reads\":91,\"readers_count\":90,\"score\":18.2,\"yours\":false,\"topic_id\":474140,\"topic_slug\":\"possible-bugs-in-rotation2d-and-rotation3d-java\",\"display_username\":\"Fletch\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":1,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"read\":true,\"user_title\":\"\",\"reply_to_user\":{\"id\":62573,\"username\":\"KfirNeuman\",\"name\":\"\",\"avatar_template\":\"/letter_avatar_proxy/v4/letter/k/d07c76/{size}.png\"},\"bookmarked\":false,\"actions_summary\":[],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":9105,\"hidden\":false,\"trust_level\":2,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"user_custom_fields\":{\"user_field_4\":\"3181/3015 Mentor | 213/1373 Alum | CSA/FTAA/Jack-of-all-Trades\"},\"post_url\":\"/t/possible-bugs-in-rotation2d-and-rotation3d-java/474140/17\",\"custom_user_title\":\"3181/3015 Mentor | 213/1373 Alum | CSA/FTAA/Jack-of-all-Trades\",\"reactions\":[],\"current_user_reaction\":null,\"reaction_users_count\":0,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":null},{\"id\":3443031,\"name\":\"Tyler Veness\",\"username\":\"calcmogul\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/calcmogul/{size}/128045_2.png\",\"created_at\":\"2024-11-02T19:20:28.377Z\",\"cooked\":\"\\u003caside class=\\\"quote no-group\\\" data-username=\\\"KfirNeuman\\\" data-post=\\\"16\\\" data-topic=\\\"474140\\\"\\u003e\\n\\u003cdiv class=\\\"title\\\"\\u003e\\n\\u003cdiv class=\\\"quote-controls\\\"\\u003e\\u003c/div\\u003e\\n\\u003cimg loading=\\\"lazy\\\" alt=\\\"\\\" width=\\\"24\\\" height=\\\"24\\\" src=\\\"https://www.chiefdelphi.com/letter_avatar_proxy/v4/letter/k/d07c76/48.png\\\" class=\\\"avatar\\\"\\u003e KfirNeuman:\\u003c/div\\u003e\\n\\u003cblockquote\\u003e\\n\\u003cp\\u003eOk, so if I wanted to define 3d angular velocities what is the best non-wrapping, unit safe way to do it?\\u003c/p\\u003e\\n\\u003c/blockquote\\u003e\\n\\u003c/aside\\u003e\\n\\u003cp\\u003eYour approach of integrating the body rates separately \\u003ca href=\\\"https://math.stackexchange.com/a/1640824\\\" rel=\\\"noopener nofollow ugc\\\"\\u003eis not correct\\u003c/a\\u003e.\\u003c/p\\u003e\\n\\u003cp\\u003eSomething like the following is more accurate, but I haven’t finished writing tests for it.\\u003c/p\\u003e\\n\\u003cpre data-code-wrap=\\\"java\\\"\\u003e\\u003ccode class=\\\"lang-java\\\"\\u003e  /**\\n   * Projects the rotation forward by integrating the given body rates over time.\\n   *\\n   * @param rollRate The body roll rate in radians per second.\\n   * @param pitchRate The body pitch rate in radians per second.\\n   * @param yawRate The body yaw rate in radians per second.\\n   * @param dt The time over which to integrate in seconds.\\n   * @return The rotation in the world frame projected forward.\\n   */\\n  Rotation3d integrate(double rollRate, double pitchRate, double yawRate, double dt) {\\n    // qₖ₊₁ = qₖ exp(Ω dt) where Ω = 0 + ω_x/2 i + ω_y/2 j + ω_z/2 k\\n    //\\n    // https://math.stackexchange.com/a/2099673\\n    var Ω = new Quaternion(0.0, rollRate / 2, pitchRate / 2, yawRate / 2);\\n    return new Rotation3d(m_q.times(Ω.times(dt).exp()));\\n  }\\n\\u003c/code\\u003e\\u003c/pre\\u003e\\n\\u003cpre data-code-wrap=\\\"cpp\\\"\\u003e\\u003ccode class=\\\"lang-cpp\\\"\\u003e  /**\\n   * Projects the rotation forward by integrating the given body rates over\\n   * time.\\n   *\\n   * @param rollRate The body roll rate.\\n   * @param pitchRate The body pitch rate.\\n   * @param yawRate The body yaw rate.\\n   * @param dt The time over which to integrate.\\n   * @return The rotation in the world frame projected forward.\\n   */\\n  constexpr Rotation3d Integrate(units::radians_per_second_t rollRate,\\n                                 units::radians_per_second_t pitchRate,\\n                                 units::radians_per_second_t yawRate,\\n                                 units::second_t dt) const {\\n    // qₖ₊₁ = qₖ exp(Ω dt) where Ω = 0 + ω_x/2 i + ω_y/2 j + ω_z/2 k\\n    //\\n    // https://math.stackexchange.com/a/2099673\\n    Quaternion Ω{0.0, rollRate.value() / 2, pitchRate.value() / 2,\\n                 yawRate.value() / 2};\\n    return Rotation3d{m_q * (Ω * dt.value()).Exp()};\\n  }\\n\\u003c/code\\u003e\\u003c/pre\\u003e\\n\\u003cp\\u003eYou can use the Euler angles from a Rotation3d in feedback if you use \\u003ca href=\\\"https://github.wpilib.org/allwpilib/docs/release/java/edu/wpi/first/math/controller/PIDController.html#enableContinuousInput(double,double)\\\" rel=\\\"noopener nofollow ugc\\\"\\u003ePIDController.enableContinuousInput(-Math.PI, Math.PI)\\u003c/a\\u003e.\\u003c/p\\u003e\",\"post_number\":18,\"post_type\":1,\"posts_count\":23,\"updated_at\":\"2024-11-03T06:06:29.781Z\",\"reply_count\":1,\"reply_to_post_number\":16,\"quote_count\":1,\"incoming_link_count\":0,\"reads\":97,\"readers_count\":96,\"score\":39.4,\"yours\":false,\"topic_id\":474140,\"topic_slug\":\"possible-bugs-in-rotation2d-and-rotation3d-java\",\"display_username\":\"Tyler Veness\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":3,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"link_counts\":[{\"url\":\"https://math.stackexchange.com/a/1640824\",\"internal\":false,\"reflection\":false,\"title\":\"integration - Integrating body angular velocity - Mathematics Stack Exchange\",\"clicks\":11},{\"url\":\"https://github.wpilib.org/allwpilib/docs/release/java/edu/wpi/first/math/controller/PIDController.html#enableContinuousInput(double,double)\",\"internal\":false,\"reflection\":false,\"title\":\"PIDController (WPILib API 2024.3.2)\",\"clicks\":1}],\"read\":true,\"user_title\":\"\",\"bookmarked\":false,\"actions_summary\":[{\"id\":2,\"count\":1}],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":16846,\"hidden\":false,\"trust_level\":2,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"user_custom_fields\":{\"user_field_4\":\"WPILib controls | Choreo optimizer backend\"},\"post_url\":\"/t/possible-bugs-in-rotation2d-and-rotation3d-java/474140/18\",\"custom_user_title\":\"WPILib controls | Choreo optimizer backend\",\"reactions\":[{\"id\":\"heart\",\"type\":\"emoji\",\"count\":1}],\"current_user_reaction\":null,\"reaction_users_count\":1,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":null},{\"id\":3443053,\"name\":\"joel truher\",\"username\":\"truher\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/truher/{size}/172222_2.png\",\"created_at\":\"2024-11-02T21:16:26.586Z\",\"cooked\":\"\\u003cp\\u003ecould you remind me where the 1/2 comes from?\\u003c/p\\u003e\",\"post_number\":19,\"post_type\":1,\"posts_count\":23,\"updated_at\":\"2024-11-02T21:16:26.586Z\",\"reply_count\":1,\"reply_to_post_number\":18,\"quote_count\":0,\"incoming_link_count\":0,\"reads\":74,\"readers_count\":73,\"score\":19.8,\"yours\":false,\"topic_id\":474140,\"topic_slug\":\"possible-bugs-in-rotation2d-and-rotation3d-java\",\"display_username\":\"joel truher\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":1,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"read\":true,\"user_title\":null,\"reply_to_user\":{\"id\":16846,\"username\":\"calcmogul\",\"name\":\"Tyler Veness\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/calcmogul/{size}/128045_2.png\"},\"bookmarked\":false,\"actions_summary\":[],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":53190,\"hidden\":false,\"trust_level\":2,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"user_custom_fields\":{\"user_field_4\":\"\"},\"post_url\":\"/t/possible-bugs-in-rotation2d-and-rotation3d-java/474140/19\",\"custom_user_title\":null,\"reactions\":[],\"current_user_reaction\":null,\"reaction_users_count\":0,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":null},{\"id\":3443058,\"name\":\"Tyler Veness\",\"username\":\"calcmogul\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/calcmogul/{size}/128045_2.png\",\"created_at\":\"2024-11-02T21:47:47.716Z\",\"cooked\":\"\\u003cp\\u003eThe Stack Overflow link in the code says it’s from the quaternion version of Euler’s formula: \\u003cspan class=\\\"math\\\"\\u003e\\\\mathbf{q} = e^{\\\\frac{\\\\theta}{2}(u_x \\\\mathbf{i} + u_y \\\\mathbf{j} + u_z \\\\mathbf{k})}\\u003c/span\\u003e. The link chain leads to Wikipedia.\\u003c/p\\u003e\\n\\u003caside class=\\\"onebox wikipedia\\\" data-onebox-src=\\\"https://en.wikipedia.org/wiki/Quaternions_and_spatial_rotation#Using_quaternions_as_rotations\\\"\\u003e\\n  \\u003cheader class=\\\"source\\\"\\u003e\\n\\n      \\u003ca href=\\\"https://en.wikipedia.org/wiki/Quaternions_and_spatial_rotation#Using_quaternions_as_rotations\\\" target=\\\"_blank\\\" rel=\\\"noopener nofollow ugc\\\"\\u003een.wikipedia.org\\u003c/a\\u003e\\n  \\u003c/header\\u003e\\n\\n  \\u003carticle class=\\\"onebox-body\\\"\\u003e\\n    \\n\\n\\u003ch3\\u003e\\u003ca href=\\\"https://en.wikipedia.org/wiki/Quaternions_and_spatial_rotation#Using_quaternions_as_rotations\\\" target=\\\"_blank\\\" rel=\\\"noopener nofollow ugc\\\"\\u003eQuaternions and spatial rotation\\u003c/a\\u003e\\u003c/h3\\u003e\\n\\n\\u003cp\\u003eUnit quaternions, known as versors, provide a convenient mathematical notation for representing spatial orientations and rotations of elements in three dimensional space. Specifically, they encode information about an axis-angle rotation about an arbitrary axis. Rotation and orientation quaternions have applications in computer graphics, computer vision, robotics, navigation, molecular dynamics, flight dynamics, orbital mechanics of satellites, and crystallographic texture analysis.[5 When used t...\\u003c/p\\u003e\\n\\n  \\u003c/article\\u003e\\n\\n  \\u003cdiv class=\\\"onebox-metadata\\\"\\u003e\\n    \\n    \\n  \\u003c/div\\u003e\\n\\n  \\u003cdiv style=\\\"clear: both\\\"\\u003e\\u003c/div\\u003e\\n\\u003c/aside\\u003e\\n\",\"post_number\":20,\"post_type\":1,\"posts_count\":23,\"updated_at\":\"2024-11-02T21:50:03.116Z\",\"reply_count\":0,\"reply_to_post_number\":19,\"quote_count\":0,\"incoming_link_count\":1,\"reads\":73,\"readers_count\":72,\"score\":49.6,\"yours\":false,\"topic_id\":474140,\"topic_slug\":\"possible-bugs-in-rotation2d-and-rotation3d-java\",\"display_username\":\"Tyler Veness\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":1,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"link_counts\":[{\"url\":\"https://en.wikipedia.org/wiki/Quaternions_and_spatial_rotation#Using_quaternions_as_rotations\",\"internal\":false,\"reflection\":false,\"title\":\"Quaternions and spatial rotation - Wikipedia\",\"clicks\":4}],\"read\":true,\"user_title\":\"\",\"reply_to_user\":{\"id\":53190,\"username\":\"truher\",\"name\":\"joel truher\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/truher/{size}/172222_2.png\"},\"bookmarked\":false,\"actions_summary\":[{\"id\":2,\"count\":2}],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":16846,\"hidden\":false,\"trust_level\":2,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"user_custom_fields\":{\"user_field_4\":\"WPILib controls | Choreo optimizer backend\"},\"post_url\":\"/t/possible-bugs-in-rotation2d-and-rotation3d-java/474140/20\",\"custom_user_title\":\"WPILib controls | Choreo optimizer backend\",\"reactions\":[{\"id\":\"+1\",\"type\":\"emoji\",\"count\":1},{\"id\":\"heart\",\"type\":\"emoji\",\"count\":1}],\"current_user_reaction\":null,\"reaction_users_count\":2,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":null}],\"stream\":[3442351,3442359,3442392,3442452,3442453,3442454,3442455,3442477,3442504,3442564,3442596,3442614,3442676,3442725,3442733,3442990,3443029,3443031,3443053,3443058,3443160,3443199,3443203]},\"timeline_lookup\":[[1,345],[8,344],[16,343],[22,342]],\"tags\":[],\"tags_descriptions\":{},\"fancy_title\":\"Possible bugs in Rotation2d and Rotation3d - java\",\"id\":474140,\"title\":\"Possible bugs in Rotation2d and Rotation3d - java\",\"posts_count\":23,\"created_at\":\"2024-10-31T23:15:43.361Z\",\"views\":928,\"reply_count\":18,\"like_count\":13,\"last_posted_at\":\"2024-11-03T12:38:53.305Z\",\"visible\":true,\"closed\":false,\"archived\":false,\"has_summary\":false,\"archetype\":\"regular\",\"slug\":\"possible-bugs-in-rotation2d-and-rotation3d-java\",\"category_id\":75,\"word_count\":2770,\"deleted_at\":null,\"user_id\":62573,\"featured_link\":null,\"pinned_globally\":false,\"pinned_at\":null,\"pinned_until\":null,\"image_url\":null,\"slow_mode_seconds\":0,\"draft\":null,\"draft_key\":\"topic_474140\",\"draft_sequence\":null,\"unpinned\":null,\"pinned\":false,\"current_post_number\":1,\"highest_post_number\":23,\"deleted_by\":null,\"actions_summary\":[{\"id\":4,\"count\":0,\"hidden\":false,\"can_act\":false},{\"id\":8,\"count\":0,\"hidden\":false,\"can_act\":false},{\"id\":10,\"count\":0,\"hidden\":false,\"can_act\":false},{\"id\":7,\"count\":0,\"hidden\":false,\"can_act\":false}],\"chunk_size\":20,\"bookmarked\":false,\"topic_timer\":{\"id\":37597,\"execute_at\":\"2025-11-03T12:38:53.305Z\",\"duration_minutes\":525600,\"based_on_last_post\":true,\"status_type\":\"close\",\"category_id\":null},\"message_bus_last_id\":0,\"participant_count\":10,\"show_read_indicator\":false,\"thumbnails\":null,\"slow_mode_enabled_until\":null,\"valid_reactions\":[\"heart\",\"laughing\",\"point_up\",\"+1\",\"-1\",\"100\",\"open_mouth\",\"cry\",\"question\",\"thinking\",\"call_me_hand\",\"hugs\",\"angry\"],\"user_chosen_thumbnail_url\":null,\"sidecar_installed\":true,\"can_vote\":false,\"vote_count\":0,\"user_voted\":false,\"discourse_zendesk_plugin_zendesk_id\":null,\"discourse_zendesk_plugin_zendesk_url\":\"https://your-url.zendesk.com/agent/tickets/\",\"details\":{\"can_edit\":false,\"notification_level\":1,\"participants\":[{\"id\":60033,\"username\":\"catrix\",\"name\":\"sam liu\",\"avatar_template\":\"/letter_avatar_proxy/v4/letter/c/dbc845/{size}.png\",\"post_count\":6,\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_color\":null,\"flair_bg_color\":null,\"flair_group_id\":null,\"trust_level\":2},{\"id\":16846,\"username\":\"calcmogul\",\"name\":\"Tyler Veness\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/calcmogul/{size}/128045_2.png\",\"post_count\":5,\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_color\":null,\"flair_bg_color\":null,\"flair_group_id\":null,\"trust_level\":2},{\"id\":62573,\"username\":\"KfirNeuman\",\"name\":\"\",\"avatar_template\":\"/letter_avatar_proxy/v4/letter/k/d07c76/{size}.png\",\"post_count\":4,\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_color\":null,\"flair_bg_color\":null,\"flair_group_id\":null,\"trust_level\":2},{\"id\":29846,\"username\":\"Ryan_Blue\",\"name\":\"Ryan Blue\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/ryan_blue/{size}/174016_2.png\",\"post_count\":2,\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_color\":null,\"flair_bg_color\":null,\"flair_group_id\":null,\"trust_level\":2},{\"id\":50699,\"username\":\"Programming4907\",\"name\":\"Scott W\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/programming4907/{size}/168313_2.png\",\"post_count\":1,\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_color\":null,\"flair_bg_color\":null,\"flair_group_id\":null,\"trust_level\":2},{\"id\":53190,\"username\":\"truher\",\"name\":\"joel truher\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/truher/{size}/172222_2.png\",\"post_count\":1,\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_color\":null,\"flair_bg_color\":null,\"flair_group_id\":null,\"trust_level\":2},{\"id\":31229,\"username\":\"auscompgeek\",\"name\":\"Davo\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/auscompgeek/{size}/9867_2.png\",\"post_count\":1,\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_color\":null,\"flair_bg_color\":null,\"flair_group_id\":null,\"trust_level\":2},{\"id\":9105,\"username\":\"Fletch1373\",\"name\":\"Fletch\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/fletch1373/{size}/220073_2.png\",\"post_count\":1,\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_color\":null,\"flair_bg_color\":null,\"flair_group_id\":null,\"trust_level\":2},{\"id\":12381,\"username\":\"Oblarg\",\"name\":\"Eli Barnett\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/oblarg/{size}/161674_2.png\",\"post_count\":1,\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_color\":null,\"flair_bg_color\":null,\"flair_group_id\":null,\"trust_level\":2},{\"id\":1267,\"username\":\"Jared_Russell\",\"name\":\"Jared Russell\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/jared_russell/{size}/399_2.png\",\"post_count\":1,\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_color\":null,\"flair_bg_color\":null,\"flair_group_id\":null,\"trust_level\":2}],\"created_by\":{\"id\":62573,\"username\":\"KfirNeuman\",\"name\":\"\",\"avatar_template\":\"/letter_avatar_proxy/v4/letter/k/d07c76/{size}.png\"},\"last_poster\":{\"id\":60033,\"username\":\"catrix\",\"name\":\"sam liu\",\"avatar_template\":\"/letter_avatar_proxy/v4/letter/c/dbc845/{size}.png\"},\"links\":[{\"url\":\"https://math.stackexchange.com/a/1640824\",\"title\":\"integration - Integrating body angular velocity - Mathematics Stack Exchange\",\"internal\":false,\"attachment\":false,\"reflection\":false,\"clicks\":11,\"user_id\":16846,\"domain\":\"math.stackexchange.com\",\"root_domain\":\"stackexchange.com\"},{\"url\":\"https://github.wpilib.org/allwpilib/docs/release/java/edu/wpi/first/math/geometry/Rotation2d.html#plus(edu.wpi.first.math.geometry.Rotation2d)\",\"title\":\"Rotation2d (WPILib API 2024.3.2)\",\"internal\":false,\"attachment\":false,\"reflection\":false,\"clicks\":9,\"user_id\":16846,\"domain\":\"github.wpilib.org\",\"root_domain\":\"wpilib.org\"},{\"url\":\"https://github.com/strasdat/Sophus/blob/main/sophus/so2.hpp#L52-L76\",\"title\":\"Sophus/sophus/so2.hpp at main · strasdat/Sophus · GitHub\",\"internal\":false,\"attachment\":false,\"reflection\":false,\"clicks\":6,\"user_id\":1267,\"domain\":\"github.com\",\"root_domain\":\"github.com\"},{\"url\":\"https://github.com/Team254/FRC-2023-Public/blob/main/src/main/java/com/team254/lib/geometry/Rotation2d.java\",\"title\":\"FRC-2023-Public/src/main/java/com/team254/lib/geometry/Rotation2d.java at main · Team254/FRC-2023-Public · GitHub\",\"internal\":false,\"attachment\":false,\"reflection\":false,\"clicks\":5,\"user_id\":1267,\"domain\":\"github.com\",\"root_domain\":\"github.com\"},{\"url\":\"https://en.wikipedia.org/wiki/Quaternions_and_spatial_rotation#Using_quaternions_as_rotations\",\"title\":\"Quaternions and spatial rotation - Wikipedia\",\"internal\":false,\"attachment\":false,\"reflection\":false,\"clicks\":4,\"user_id\":16846,\"domain\":\"en.wikipedia.org\",\"root_domain\":\"wikipedia.org\"},{\"url\":\"https://github.wpilib.org/allwpilib/docs/release/java/edu/wpi/first/math/controller/PIDController.html#enableContinuousInput(double,double)\",\"title\":\"PIDController (WPILib API 2024.3.2)\",\"internal\":false,\"attachment\":false,\"reflection\":false,\"clicks\":1,\"user_id\":16846,\"domain\":\"github.wpilib.org\",\"root_domain\":\"wpilib.org\"}]},\"bookmarks\":[]}"}
