{"data":"{\"post_stream\":{\"posts\":[{\"id\":2971704,\"name\":\"Joe Johnson\",\"username\":\"Joe_Johnson\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/joe_johnson/{size}/156076_2.png\",\"created_at\":\"2021-10-12T13:42:47.373Z\",\"cooked\":\"\\u003cp\\u003eIn working through planning for the controls work that will need to be done during the \\u003ca href=\\\"https://www.chiefdelphi.com/t/diff-swerve-beta2-the-controls-software-boogaloo/396430\\\"\\u003eDiff Swerve Beta2, The Controls \\u0026amp; Software Boogaloo\\u003c/a\\u003e project, the problem of timing delays for \\u003cspan class=\\\"abbreviation\\\"\\u003eCAN\\u003ctemplate class=\\\"tooltiptext\\\" data-text=\\\"Controller Area Network\\\"\\u003e\\u003c/template\\u003e\\u003c/span\\u003e messages in the \\u003cspan class=\\\"abbreviation\\\"\\u003eFRC\\u003ctemplate class=\\\"tooltiptext\\\" data-text=\\\"FIRST Robotics Competition\\\"\\u003e\\u003c/template\\u003e\\u003c/span\\u003e control system has come to my attention.\\u003c/p\\u003e\\n\\u003caside class=\\\"quote no-group\\\" data-username=\\\"Bart_Kerfeld\\\" data-post=\\\"3\\\" data-topic=\\\"396430\\\"\\u003e\\n\\u003cdiv class=\\\"title\\\"\\u003e\\n\\u003cdiv class=\\\"quote-controls\\\"\\u003e\\u003c/div\\u003e\\n\\u003cimg loading=\\\"lazy\\\" alt=\\\"\\\" width=\\\"24\\\" height=\\\"24\\\" src=\\\"https://www.chiefdelphi.com/user_avatar/www.chiefdelphi.com/bart_kerfeld/48/156555_2.png\\\" class=\\\"avatar\\\"\\u003e\\u003ca href=\\\"https://www.chiefdelphi.com/t/diff-swerve-beta2-the-controls-software-boogaloo/396430/3\\\"\\u003eDiff Swerve Beta2, The Controls \\u0026amp; Software Boogaloo\\u003c/a\\u003e\\u003c/div\\u003e\\n\\u003cblockquote\\u003e\\n\\u003cp\\u003eAustin Schuh wrote an \\u003ca href=\\\"https://www.chiefdelphi.com/t/pic-differential-swerve-module-971/160525/41\\\"\\u003einteresting post \\u003c/a\\u003e talking about the limitations of \\u003cspan class=\\\"abbreviation\\\"\\u003eCAN\\u003ctemplate class=\\\"tooltiptext\\\" data-text=\\\"Controller Area Network\\\"\\u003e\\u003c/template\\u003e\\u003c/span\\u003e controlling a differential swerve in 2017.\\u003c/p\\u003e\\n\\u003c/blockquote\\u003e\\n\\u003c/aside\\u003e\\n\\u003caside class=\\\"quote no-group\\\" data-username=\\\"AustinSchuh\\\" data-post=\\\"19\\\" data-topic=\\\"396430\\\"\\u003e\\n\\u003cdiv class=\\\"title\\\"\\u003e\\n\\u003cdiv class=\\\"quote-controls\\\"\\u003e\\u003c/div\\u003e\\n\\u003cimg loading=\\\"lazy\\\" alt=\\\"\\\" width=\\\"24\\\" height=\\\"24\\\" src=\\\"https://www.chiefdelphi.com/letter_avatar_proxy/v4/letter/a/e19b73/48.png\\\" class=\\\"avatar\\\"\\u003e\\u003ca href=\\\"https://www.chiefdelphi.com/t/diff-swerve-beta2-the-controls-software-boogaloo/396430/19\\\"\\u003eDiff Swerve Beta2, The Controls \\u0026amp; Software Boogaloo\\u003c/a\\u003e\\u003c/div\\u003e\\n\\u003cblockquote\\u003e\\n\\u003cp\\u003eIf I ever get enough time, I‚Äôm tempted to go the way of team 900 and move over to my own \\u003cspan class=\\\"abbreviation\\\"\\u003eCAN\\u003ctemplate class=\\\"tooltiptext\\\" data-text=\\\"Controller Area Network\\\"\\u003e\\u003c/template\\u003e\\u003c/span\\u003e stack on another controller on the \\u003cspan class=\\\"abbreviation\\\"\\u003eCAN\\u003ctemplate class=\\\"tooltiptext\\\" data-text=\\\"Controller Area Network\\\"\\u003e\\u003c/template\\u003e\\u003c/span\\u003e bus. That is legal as far as I understand. That should enable much more control over the bus traffic, and I could then use it to show what becomes possible with some more control over the bus.\\u003c/p\\u003e\\n\\u003c/blockquote\\u003e\\n\\u003c/aside\\u003e\\n\\u003cp\\u003eSo‚Ä¶ this Austin Schuh guy at least seems to think it is a big deal (or can be).\\u003c/p\\u003e\\n\\u003cp\\u003eWhat do others have to say on the matter?\\u003c/p\\u003e\\n\\u003cp\\u003eFor my own selfish reasons (relating to trying to control \\u003ca href=\\\"https://www.chiefdelphi.com/t/dr-joes-diff-swerve/392335\\\"\\u003emy favorite flavor of diff swerve\\u003c/a\\u003e), I am particularly interested \\u003cspan class=\\\"abbreviation\\\"\\u003eCAN\\u003ctemplate class=\\\"tooltiptext\\\" data-text=\\\"Controller Area Network\\\"\\u003e\\u003c/template\\u003e\\u003c/span\\u003e issue arising when trying to implement LQR control with Falcon 500s (in current control mode). Oh, and there are CANcoders in the sensor mix.\\u003c/p\\u003e\\n\\u003cp\\u003eAssuming CAD delays (or rather non deterministic delays) are indeed an impediment to implementing the best version of a well behaved robot, what are our options? Do we just add a CPU to tame the \\u003cspan class=\\\"abbreviation\\\"\\u003eCAN\\u003ctemplate class=\\\"tooltiptext\\\" data-text=\\\"Controller Area Network\\\"\\u003e\\u003c/template\\u003e\\u003c/span\\u003e delay problem and leave the rest of the control code running on the RoboRIO? Do we throw up our hands, and move the entire control code over to a Co-processor (save for the required enable signal from the RoboRIO)?  Is there another option behind Door \\u003ca class=\\\"hashtag-cooked\\\" href=\\\"/tag/3\\\" data-type=\\\"tag\\\" data-slug=\\\"3\\\" data-id=\\\"3582\\\"\\u003e\\u003cspan class=\\\"hashtag-icon-placeholder\\\"\\u003e\\u003csvg class=\\\"fa d-icon d-icon-square-full svg-icon svg-node\\\"\\u003e\\u003cuse href=\\\"#square-full\\\"\\u003e\\u003c/use\\u003e\\u003c/svg\\u003e\\u003c/span\\u003e\\u003cspan\\u003e3\\u003c/span\\u003e\\u003c/a\\u003e?\\u003c/p\\u003e\\n\\u003cp\\u003eDiscuss.\\u003c/p\\u003e\\n\\u003cp\\u003eDr. Joe J.\\u003c/p\\u003e\",\"post_number\":1,\"post_type\":1,\"posts_count\":21,\"updated_at\":\"2021-10-12T14:58:21.285Z\",\"reply_count\":2,\"reply_to_post_number\":null,\"quote_count\":0,\"incoming_link_count\":868,\"reads\":397,\"readers_count\":396,\"score\":4454.4,\"yours\":false,\"topic_id\":396566,\"topic_slug\":\"lets-talk-about-can-delays-and-how-to-address-them\",\"display_username\":\"Joe Johnson\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":2,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"link_counts\":[{\"url\":\"https://www.chiefdelphi.com/t/dr-joes-diff-swerve/392335\",\"internal\":true,\"reflection\":false,\"title\":\"Dr Joe's Diff Swerve\",\"clicks\":28},{\"url\":\"https://www.chiefdelphi.com/t/diff-swerve-beta2-the-controls-software-boogaloo/396430\",\"internal\":true,\"reflection\":false,\"title\":\"Diff Swerve Beta2, The Controls \\u0026 Software Boogaloo\",\"clicks\":10},{\"url\":\"https://www.chiefdelphi.com/t/diff-swerve-beta2-the-controls-software-boogaloo/396430/19\",\"internal\":true,\"reflection\":false,\"title\":\"Diff Swerve Beta2, The Controls \\u0026 Software Boogaloo\",\"clicks\":0},{\"url\":\"/tag/3\",\"internal\":true,\"reflection\":false,\"clicks\":0},{\"url\":\"https://www.chiefdelphi.com/t/diff-swerve-beta2-the-controls-software-boogaloo/396430/3\",\"internal\":true,\"reflection\":false,\"title\":\"Diff Swerve Beta2, The Controls \\u0026 Software Boogaloo\",\"clicks\":0}],\"read\":true,\"user_title\":\"\",\"bookmarked\":false,\"actions_summary\":[{\"id\":2,\"count\":2}],\"moderator\":true,\"admin\":false,\"staff\":true,\"user_id\":6,\"hidden\":false,\"trust_level\":4,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"post_url\":\"/t/lets-talk-about-can-delays-and-how-to-address-them/396566/1\",\"custom_user_title\":null,\"reactions\":[{\"id\":\"heart\",\"type\":\"emoji\",\"count\":2}],\"current_user_reaction\":null,\"reaction_users_count\":2,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":null,\"can_vote\":false},{\"id\":2971736,\"name\":\"Tyler Veness\",\"username\":\"calcmogul\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/calcmogul/{size}/128045_2.png\",\"created_at\":\"2021-10-12T16:13:02.071Z\",\"cooked\":\"\\u003cp\\u003eIf eliminating the delay turns out to be impossible, another option is reducing the controller gains mathematically so the delay at least doesn‚Äôt make the system unstable. How much they get reduced depends on how fast/far the system can move within the measurement delay duration.\\u003c/p\\u003e\\n\\u003cp\\u003eHere‚Äôs an excerpt from \\u003ca href=\\\"https://file.tavsys.net/control/controls-engineering-in-frc.pdf\\\" rel=\\\"noopener nofollow ugc\\\"\\u003emy book\\u003c/a\\u003e that talks about how to do this rigorously.\\u003cbr\\u003e\\n\\u003ca class=\\\"attachment\\\" href=\\\"/uploads/short-url/rOW2YLx4U25I1Sp9z0ECuVTfZtk.pdf\\\"\\u003elqr-latency-comp.pdf\\u003c/a\\u003e (330.2 KB)\\u003c/p\\u003e\\n\\u003cp\\u003eThe Python scripts that generated the plots are \\u003ca href=\\\"https://github.com/calcmogul/controls-engineering-in-frc/tree/main/appendices/linear-quadratic-regulator\\\" rel=\\\"noopener nofollow ugc\\\"\\u003ehere\\u003c/a\\u003e if you want to play with them.\\u003c/p\\u003e\\n\\u003cp\\u003eThe paper discusses things in more detail, but a major downside of latency compensation is if your system accelerates too fast, the optimal feedback gains may be no feedback gains at all (i.e., feedforward only). This naturally has \\u003ca href=\\\"https://en.wikipedia.org/wiki/Robust_control\\\" rel=\\\"noopener nofollow ugc\\\"\\u003erobustness\\u003c/a\\u003e issues.\\u003c/p\\u003e\\n\\u003cp\\u003eWPILib implements this algorithm in the LinearQuadraticRegulator class for \\u003ca href=\\\"https://github.com/wpilibsuite/allwpilib/blob/main/wpimath/src/main/java/edu/wpi/first/math/controller/LinearQuadraticRegulator.java#L246-L267\\\" rel=\\\"noopener nofollow ugc\\\"\\u003eJava\\u003c/a\\u003e and \\u003ca href=\\\"https://github.com/wpilibsuite/allwpilib/blob/main/wpimath/src/main/native/include/frc/controller/LinearQuadraticRegulator.h#L208-L232\\\" rel=\\\"noopener nofollow ugc\\\"\\u003eC++\\u003c/a\\u003e. \\u003ca href=\\\"https://github.com/wpilibsuite/sysid/\\\" rel=\\\"noopener nofollow ugc\\\"\\u003eSysId\\u003c/a\\u003e uses it to compensate for encoder filtering delays in on-motor-controller feedback.\\u003c/p\\u003e\",\"post_number\":2,\"post_type\":1,\"posts_count\":21,\"updated_at\":\"2021-10-12T16:15:52.707Z\",\"reply_count\":0,\"reply_to_post_number\":null,\"quote_count\":0,\"incoming_link_count\":11,\"reads\":367,\"readers_count\":366,\"score\":143.4,\"yours\":false,\"topic_id\":396566,\"topic_slug\":\"lets-talk-about-can-delays-and-how-to-address-them\",\"display_username\":\"Tyler Veness\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":1,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"link_counts\":[{\"url\":\"https://file.tavsys.net/control/controls-engineering-in-frc.pdf\",\"internal\":false,\"reflection\":false,\"clicks\":30},{\"url\":\"https://github.com/wpilibsuite/sysid/\",\"internal\":false,\"reflection\":false,\"clicks\":3},{\"url\":\"https://github.com/calcmogul/controls-engineering-in-frc/tree/main/appendices/linear-quadratic-regulator\",\"internal\":false,\"reflection\":false,\"clicks\":3},{\"url\":\"https://en.wikipedia.org/wiki/Robust_control\",\"internal\":false,\"reflection\":false,\"title\":\"Robust control - Wikipedia\",\"clicks\":2},{\"url\":\"https://github.com/wpilibsuite/allwpilib/blob/main/wpimath/src/main/java/edu/wpi/first/math/controller/LinearQuadraticRegulator.java#L246-L267\",\"internal\":false,\"reflection\":false,\"clicks\":0},{\"url\":\"/uploads/short-url/rOW2YLx4U25I1Sp9z0ECuVTfZtk.pdf\",\"internal\":true,\"reflection\":false,\"clicks\":0},{\"url\":\"https://github.com/wpilibsuite/allwpilib/blob/main/wpimath/src/main/native/include/frc/controller/LinearQuadraticRegulator.h#L208-L232\",\"internal\":false,\"reflection\":false,\"clicks\":0}],\"read\":true,\"user_title\":\"\",\"bookmarked\":false,\"actions_summary\":[{\"id\":2,\"count\":1}],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":16846,\"hidden\":false,\"trust_level\":2,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"user_custom_fields\":{\"user_field_4\":\"WPILib controls | Choreo optimizer backend\"},\"post_url\":\"/t/lets-talk-about-can-delays-and-how-to-address-them/396566/2\",\"custom_user_title\":\"WPILib controls | Choreo optimizer backend\",\"reactions\":[{\"id\":\"heart\",\"type\":\"emoji\",\"count\":1}],\"current_user_reaction\":null,\"reaction_users_count\":1,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":null},{\"id\":2971740,\"name\":\"Peter Johnson\",\"username\":\"Peter_Johnson\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/peter_johnson/{size}/10417_2.png\",\"created_at\":\"2021-10-12T16:27:01.904Z\",\"cooked\":\"\\u003cp\\u003eA couple of things to note:\\u003c/p\\u003e\\n\\u003cul\\u003e\\n\\u003cli\\u003eThe CAN stack on the Rio has substantially changed since 2017; prior to 2020, CAN bus calls went through a IPC layer before transmission which added substantial delay and timing uncertainty; starting in 2020, this is no longer the case (CAN bus calls no longer go through an IPC layer).\\u003c/li\\u003e\\n\\u003cli\\u003eThere will always be some degree of timing uncertainty on CAN because the motor controllers have independent clocks and send status messages asynchronously onto the shared medium, so there is always the possibility of random collisions.  It might be possible for the motor controller firmware to synchronize transmits based on periodic messages from the Rio (and avoid collisions e.g. with a settable offset time), but I don‚Äôt believe they do this at present.\\u003c/li\\u003e\\n\\u003c/ul\\u003e\",\"post_number\":3,\"post_type\":1,\"posts_count\":21,\"updated_at\":\"2021-10-12T16:27:01.904Z\",\"reply_count\":1,\"reply_to_post_number\":null,\"quote_count\":0,\"incoming_link_count\":5,\"reads\":346,\"readers_count\":345,\"score\":129.2,\"yours\":false,\"topic_id\":396566,\"topic_slug\":\"lets-talk-about-can-delays-and-how-to-address-them\",\"display_username\":\"Peter Johnson\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":1,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"read\":true,\"user_title\":\"\",\"bookmarked\":false,\"actions_summary\":[{\"id\":2,\"count\":2}],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":13575,\"hidden\":false,\"trust_level\":2,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"user_custom_fields\":{\"user_field_4\":\"Volunteer WPILib Developer, CSA\"},\"post_url\":\"/t/lets-talk-about-can-delays-and-how-to-address-them/396566/3\",\"custom_user_title\":\"Volunteer WPILib Developer, CSA\",\"reactions\":[{\"id\":\"heart\",\"type\":\"emoji\",\"count\":2}],\"current_user_reaction\":null,\"reaction_users_count\":2,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":null},{\"id\":2971742,\"name\":\"Carlos Gross Jones\",\"username\":\"CarlosGJ\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/carlosgj/{size}/131747_2.png\",\"created_at\":\"2021-10-12T16:54:08.902Z\",\"cooked\":\"\\u003caside class=\\\"quote no-group quote-modified\\\" data-username=\\\"Joe_Johnson\\\" data-post=\\\"1\\\" data-topic=\\\"396566\\\"\\u003e\\n\\u003cdiv class=\\\"title\\\"\\u003e\\n\\u003cdiv class=\\\"quote-controls\\\"\\u003e\\u003c/div\\u003e\\n\\u003cimg loading=\\\"lazy\\\" alt=\\\"\\\" width=\\\"24\\\" height=\\\"24\\\" src=\\\"https://www.chiefdelphi.com/user_avatar/www.chiefdelphi.com/joe_johnson/48/156076_2.png\\\" class=\\\"avatar\\\"\\u003e Joe_Johnson:\\u003c/div\\u003e\\n\\u003cblockquote\\u003e\\n\\u003cp\\u003eAssuming \\u003cspan class=\\\"abbreviation\\\"\\u003eCAN\\u003ctemplate class=\\\"tooltiptext\\\" data-text=\\\"Controller Area Network\\\"\\u003e\\u003c/template\\u003e\\u003c/span\\u003e delays (or rather non deterministic delays) are indeed an impediment to implementing the best version of a well behaved robot\\u003c/p\\u003e\\n\\u003c/blockquote\\u003e\\n\\u003c/aside\\u003e\\n\\u003cp\\u003eHold up, are you concerned about the \\u003cem\\u003elatency\\u003c/em\\u003e of \\u003cspan class=\\\"abbreviation\\\"\\u003eCAN\\u003ctemplate class=\\\"tooltiptext\\\" data-text=\\\"Controller Area Network\\\"\\u003e\\u003c/template\\u003e\\u003c/span\\u003e control messages, or the \\u003cem\\u003ejitter\\u003c/em\\u003e from one message to the next? Those are quite different problems.\\u003c/p\\u003e\\n\\u003caside class=\\\"quote no-group\\\" data-username=\\\"Joe_Johnson\\\" data-post=\\\"1\\\" data-topic=\\\"396566\\\"\\u003e\\n\\u003cdiv class=\\\"title\\\"\\u003e\\n\\u003cdiv class=\\\"quote-controls\\\"\\u003e\\u003c/div\\u003e\\n\\u003cimg loading=\\\"lazy\\\" alt=\\\"\\\" width=\\\"24\\\" height=\\\"24\\\" src=\\\"https://www.chiefdelphi.com/user_avatar/www.chiefdelphi.com/joe_johnson/48/156076_2.png\\\" class=\\\"avatar\\\"\\u003e Joe_Johnson:\\u003c/div\\u003e\\n\\u003cblockquote\\u003e\\n\\u003cp\\u003eDo we just add a CPU to tame the \\u003cspan class=\\\"abbreviation\\\"\\u003eCAN\\u003ctemplate class=\\\"tooltiptext\\\" data-text=\\\"Controller Area Network\\\"\\u003e\\u003c/template\\u003e\\u003c/span\\u003e delay problem and leave the rest of the control code running on the RoboRIO?\\u003c/p\\u003e\\n\\u003c/blockquote\\u003e\\n\\u003c/aside\\u003e\\n\\u003cp\\u003eWhat exactly does this mean? There‚Äôs only one CANbus (for controlling motors), so adding a coprocessor wouldn‚Äôt help collision-related issues.\\u003c/p\\u003e\",\"post_number\":4,\"post_type\":1,\"posts_count\":21,\"updated_at\":\"2021-10-12T16:54:08.902Z\",\"reply_count\":2,\"reply_to_post_number\":null,\"quote_count\":1,\"incoming_link_count\":1,\"reads\":325,\"readers_count\":324,\"score\":80.0,\"yours\":false,\"topic_id\":396566,\"topic_slug\":\"lets-talk-about-can-delays-and-how-to-address-them\",\"display_username\":\"Carlos Gross Jones\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":1,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"read\":true,\"user_title\":\"\",\"bookmarked\":false,\"actions_summary\":[],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":16115,\"hidden\":false,\"trust_level\":2,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"user_custom_fields\":{\"user_field_4\":\"Mere hours of work can save you entire minutes of planning\"},\"post_url\":\"/t/lets-talk-about-can-delays-and-how-to-address-them/396566/4\",\"custom_user_title\":\"Mere hours of work can save you entire minutes of planning\",\"reactions\":[],\"current_user_reaction\":null,\"reaction_users_count\":0,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":null},{\"id\":2971752,\"name\":\"Joe Johnson\",\"username\":\"Joe_Johnson\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/joe_johnson/{size}/156076_2.png\",\"created_at\":\"2021-10-12T17:15:09.045Z\",\"cooked\":\"\\u003caside class=\\\"quote no-group\\\" data-username=\\\"CarlosGJ\\\" data-post=\\\"4\\\" data-topic=\\\"396566\\\"\\u003e\\n\\u003cdiv class=\\\"title\\\"\\u003e\\n\\u003cdiv class=\\\"quote-controls\\\"\\u003e\\u003c/div\\u003e\\n\\u003cimg loading=\\\"lazy\\\" alt=\\\"\\\" width=\\\"24\\\" height=\\\"24\\\" src=\\\"https://www.chiefdelphi.com/user_avatar/www.chiefdelphi.com/carlosgj/48/131747_2.png\\\" class=\\\"avatar\\\"\\u003e CarlosGJ:\\u003c/div\\u003e\\n\\u003cblockquote\\u003e\\n\\u003cp\\u003eHold up, are you concerned about the \\u003cem\\u003elatency\\u003c/em\\u003e of \\u003cspan class=\\\"abbreviation\\\"\\u003eCAN\\u003ctemplate class=\\\"tooltiptext\\\" data-text=\\\"Controller Area Network\\\"\\u003e\\u003c/template\\u003e\\u003c/span\\u003e control messages, or the \\u003cem\\u003ejitter\\u003c/em\\u003e from one message to the next? Those are quite different problems.\\u003c/p\\u003e\\n\\u003c/blockquote\\u003e\\n\\u003c/aside\\u003e\\n\\u003cp\\u003eI believe that jitter is the bigger problem and that latency isn‚Äôt great but if it were consistent wouldn‚Äôt be too terrible to manage (I have literally zero 1st hand information on this ‚Äì I am going more by what I have been able to understand from reading discussions of others)\\u003c/p\\u003e\\n\\u003caside class=\\\"quote no-group\\\" data-username=\\\"CarlosGJ\\\" data-post=\\\"4\\\" data-topic=\\\"396566\\\"\\u003e\\n\\u003cdiv class=\\\"title\\\"\\u003e\\n\\u003cdiv class=\\\"quote-controls\\\"\\u003e\\u003c/div\\u003e\\n\\u003cimg loading=\\\"lazy\\\" alt=\\\"\\\" width=\\\"24\\\" height=\\\"24\\\" src=\\\"https://www.chiefdelphi.com/user_avatar/www.chiefdelphi.com/carlosgj/48/131747_2.png\\\" class=\\\"avatar\\\"\\u003e CarlosGJ:\\u003c/div\\u003e\\n\\u003cblockquote\\u003e\\n\\u003cp\\u003eWhat exactly does this mean? There‚Äôs only one CANbus (for controlling motors), so adding a coprocessor wouldn‚Äôt help collision-related issues.\\u003c/p\\u003e\\n\\u003c/blockquote\\u003e\\n\\u003c/aside\\u003e\\n\\u003cp\\u003eLet me start by saying I am completely out of my depth (and my information maybe be out of date based on some messages above) but my understanding is that the \\u003cspan class=\\\"abbreviation\\\"\\u003eCAN\\u003ctemplate class=\\\"tooltiptext\\\" data-text=\\\"Controller Area Network\\\"\\u003e\\u003c/template\\u003e\\u003c/span\\u003e stack on the RoboRIO was making things worse than they could be and that there was a way (that was legal per FIRST rules) to have another \\u003cspan class=\\\"abbreviation\\\"\\u003eCAN\\u003ctemplate class=\\\"tooltiptext\\\" data-text=\\\"Controller Area Network\\\"\\u003e\\u003c/template\\u003e\\u003c/span\\u003e stack (on another CPU) do a better job of managing messages.\\u003c/p\\u003e\\n\\u003cp\\u003eSo‚Ä¶ I could be completely wrong about this. That‚Äôs why I am trying to get this discussion going.\\u003c/p\\u003e\",\"post_number\":5,\"post_type\":1,\"posts_count\":21,\"updated_at\":\"2021-10-12T17:15:09.045Z\",\"reply_count\":1,\"reply_to_post_number\":4,\"quote_count\":1,\"incoming_link_count\":8,\"reads\":308,\"readers_count\":307,\"score\":106.6,\"yours\":false,\"topic_id\":396566,\"topic_slug\":\"lets-talk-about-can-delays-and-how-to-address-them\",\"display_username\":\"Joe Johnson\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":1,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"read\":true,\"user_title\":\"\",\"bookmarked\":false,\"actions_summary\":[],\"moderator\":true,\"admin\":false,\"staff\":true,\"user_id\":6,\"hidden\":false,\"trust_level\":4,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"post_url\":\"/t/lets-talk-about-can-delays-and-how-to-address-them/396566/5\",\"custom_user_title\":null,\"reactions\":[],\"current_user_reaction\":null,\"reaction_users_count\":0,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":null},{\"id\":2971759,\"name\":\"Gus Michel II\",\"username\":\"GeeTwo\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/geetwo/{size}/120962_2.png\",\"created_at\":\"2021-10-12T17:37:51.299Z\",\"cooked\":\"\\u003caside class=\\\"quote no-group\\\" data-username=\\\"Joe_Johnson\\\" data-post=\\\"1\\\" data-topic=\\\"396566\\\"\\u003e\\n\\u003cdiv class=\\\"title\\\"\\u003e\\n\\u003cdiv class=\\\"quote-controls\\\"\\u003e\\u003c/div\\u003e\\n\\u003cimg loading=\\\"lazy\\\" alt=\\\"\\\" width=\\\"24\\\" height=\\\"24\\\" src=\\\"https://www.chiefdelphi.com/user_avatar/www.chiefdelphi.com/joe_johnson/48/156076_2.png\\\" class=\\\"avatar\\\"\\u003e Joe_Johnson:\\u003c/div\\u003e\\n\\u003cblockquote\\u003e\\n\\u003cp\\u003eDo we just add a CPU to tame the \\u003cspan class=\\\"abbreviation\\\"\\u003eCAN\\u003ctemplate class=\\\"tooltiptext\\\" data-text=\\\"Controller Area Network\\\"\\u003e\\u003c/template\\u003e\\u003c/span\\u003e delay problem and leave the rest of the control code running on the RoboRIO?\\u003c/p\\u003e\\n\\u003c/blockquote\\u003e\\n\\u003c/aside\\u003e\\n\\u003caside class=\\\"quote no-group\\\" data-username=\\\"CarlosGJ\\\" data-post=\\\"4\\\" data-topic=\\\"396566\\\"\\u003e\\n\\u003cdiv class=\\\"title\\\"\\u003e\\n\\u003cdiv class=\\\"quote-controls\\\"\\u003e\\u003c/div\\u003e\\n\\u003cimg loading=\\\"lazy\\\" alt=\\\"\\\" width=\\\"24\\\" height=\\\"24\\\" src=\\\"https://www.chiefdelphi.com/user_avatar/www.chiefdelphi.com/carlosgj/48/131747_2.png\\\" class=\\\"avatar\\\"\\u003e CarlosGJ:\\u003c/div\\u003e\\n\\u003cblockquote\\u003e\\n\\u003cp\\u003eWhat exactly does this mean? There‚Äôs only one CANbus (for controlling motors), so adding a coprocessor wouldn‚Äôt help collision-related issues.\\u003c/p\\u003e\\n\\u003c/blockquote\\u003e\\n\\u003c/aside\\u003e\\n\\u003cblockquote\\u003e\\n\\u003cp\\u003eR57. ROBOTS must be controlled via one (1) programmable National Instruments roboRIO (P/N: am3000), with image version FRC_roboRIO_2020_v10 or later.\\u003c/p\\u003e\\n\\u003cblockquote\\u003e\\n\\u003cp\\u003e\\u003cspan\\u003eThere are no rules that prohibit co-processors, \\u003cstrong\\u003eprovided commands originate from the roboRIO to enable and disable all power regulating devices\\u003c/strong\\u003e. This includes motor controllers legally wired to the \\u003cspan class=\\\"abbreviation\\\"\\u003eCAN\\u003ctemplate class=\\\"tooltiptext\\\" data-text=\\\"Controller Area Network\\\"\\u003e\\u003c/template\\u003e\\u003c/span\\u003e-bus.\\u003c/span\\u003e\\u003c/p\\u003e\\n\\u003c/blockquote\\u003e\\n\\u003c/blockquote\\u003e\\n\\u003cp\\u003e[Emphasis mine]\\u003cbr\\u003e\\nIt seems that co-processors could manage the inputs (presumably direct DIO inputs) and send throttle setpoints to the motor controllers, as long as the enable and disable signals are from the RIO.  I‚Äôm not sure how this can be a readily inspectable item unless there are a small set of approved ‚Äúwell behaving‚Äù co-processors.  Another possibility might be that this co-processor would send the setpoints to the RIO over, say I¬≤C.  As another alternative, this co-processor could tell the motor controllers what to do by emulating a sensor, taking the sensor data and feedback completely off \\u003cspan class=\\\"abbreviation\\\"\\u003eCAN\\u003ctemplate class=\\\"tooltiptext\\\" data-text=\\\"Controller Area Network\\\"\\u003e\\u003c/template\\u003e\\u003c/span\\u003e.\\u003c/p\\u003e\",\"post_number\":6,\"post_type\":1,\"posts_count\":21,\"updated_at\":\"2021-10-12T17:46:57.035Z\",\"reply_count\":0,\"reply_to_post_number\":null,\"quote_count\":2,\"incoming_link_count\":8,\"reads\":288,\"readers_count\":287,\"score\":97.6,\"yours\":false,\"topic_id\":396566,\"topic_slug\":\"lets-talk-about-can-delays-and-how-to-address-them\",\"display_username\":\"Gus Michel II\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":2,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"read\":true,\"user_title\":\"\",\"bookmarked\":false,\"actions_summary\":[],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":22335,\"hidden\":false,\"trust_level\":2,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"user_custom_fields\":{\"user_field_4\":\"Somebody Else ‚¨õüü´üü•üüßüü®üü©üü¶üü™‚ñí‚ñí‚¨ú\\t\"},\"post_url\":\"/t/lets-talk-about-can-delays-and-how-to-address-them/396566/6\",\"custom_user_title\":\"Somebody Else ‚¨õüü´üü•üüßüü®üü©üü¶üü™‚ñí‚ñí‚¨ú\\t\",\"reactions\":[],\"current_user_reaction\":null,\"reaction_users_count\":0,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":null},{\"id\":2971763,\"name\":\"Carlos Gross Jones\",\"username\":\"CarlosGJ\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/carlosgj/{size}/131747_2.png\",\"created_at\":\"2021-10-12T17:51:02.964Z\",\"cooked\":\"\\u003cp\\u003eAs \\u003ca class=\\\"mention\\\" href=\\\"/u/peter_johnson\\\"\\u003e@Peter_Johnson\\u003c/a\\u003e says, software upgrades to the RIO‚Äôs CAN stack have significantly decreased the amount of intrinsic latency from ‚Äúsoftware call‚Äù to ‚Äúbits on the wire‚Äù. However, CANbus is by nature nondeterministic: higher-priority messages will preempt lower-priority ones (priority is defined by the arbitration ID, which is divided up into several different fields in ‚ÄúFRC-CAN‚Äù (\\u003ca href=\\\"https://docs.wpilib.org/en/stable/docs/software/can-devices/can-addressing.html\\\" class=\\\"inline-onebox\\\"\\u003eFRC CAN Device Specifications ‚Äî FIRST Robotics Competition documentation\\u003c/a\\u003e)). The arbitration, and possible retransmit attempts, happens at a low level in a CAN controller (an IP block in the FPGA, in the case of the RIO), and typically isn‚Äôt very accessible from software.\\u003c/p\\u003e\\n\\u003cp\\u003eI‚Äôve contemplated the possibility of including some type of reduced timestamp in CAN frames, so that latency could be known and corrected for, but there are at least two problems with that:\\u003c/p\\u003e\\n\\u003col\\u003e\\n\\u003cli\\u003eAny such scheme would have to be implemented in the motor controller firmware. It‚Äôs not a DIY solution.\\u003c/li\\u003e\\n\\u003cli\\u003eYou only have 8 bytes per frame to play with, so you sacrifice quite a bit of payload throughput even with only 16-bit timestamps.\\u003c/li\\u003e\\n\\u003c/ol\\u003e\",\"post_number\":7,\"post_type\":1,\"posts_count\":21,\"updated_at\":\"2021-10-12T17:51:02.964Z\",\"reply_count\":1,\"reply_to_post_number\":5,\"quote_count\":0,\"incoming_link_count\":5,\"reads\":274,\"readers_count\":273,\"score\":84.8,\"yours\":false,\"topic_id\":396566,\"topic_slug\":\"lets-talk-about-can-delays-and-how-to-address-them\",\"display_username\":\"Carlos Gross Jones\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":1,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"link_counts\":[{\"url\":\"https://docs.wpilib.org/en/stable/docs/software/can-devices/can-addressing.html\",\"internal\":false,\"reflection\":false,\"title\":\"FRC CAN Device Specifications ‚Äî FIRST Robotics Competition documentation\",\"clicks\":11}],\"read\":true,\"user_title\":\"\",\"reply_to_user\":{\"id\":6,\"username\":\"Joe_Johnson\",\"name\":\"Joe Johnson\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/joe_johnson/{size}/156076_2.png\"},\"bookmarked\":false,\"actions_summary\":[],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":16115,\"hidden\":false,\"trust_level\":2,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"user_custom_fields\":{\"user_field_4\":\"Mere hours of work can save you entire minutes of planning\"},\"post_url\":\"/t/lets-talk-about-can-delays-and-how-to-address-them/396566/7\",\"custom_user_title\":\"Mere hours of work can save you entire minutes of planning\",\"reactions\":[],\"current_user_reaction\":null,\"reaction_users_count\":0,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":null},{\"id\":2971842,\"name\":\"Austin Schuh\",\"username\":\"AustinSchuh\",\"avatar_template\":\"/letter_avatar_proxy/v4/letter/a/e19b73/{size}.png\",\"created_at\":\"2021-10-13T03:08:30.849Z\",\"cooked\":\"\\u003cp\\u003eYea, there have been quite some improvements.  It is on my list hopefully this beta test season to hook up a RIO to one of my test rigs with a nice RT kernel and a PCIe CAN card and see how well we can tune things up.\\u003c/p\\u003e\\n\\u003cp\\u003eFrom a system point of view, I‚Äôd really like everything to happen at a repeatable, designed cadence.  That fits the controls math best. The easiest way to do that is to set the commands up to be periodic and consistent.  Something like:\\u003c/p\\u003e\\n\\u003cul\\u003e\\n\\u003cli\\u003esend current command for motor 0.\\u003c/li\\u003e\\n\\u003cli\\u003esend current command for motor 1.\\u003c/li\\u003e\\n\\u003cli\\u003esend current command for motor 2.\\u003c/li\\u003e\\n\\u003cli\\u003e‚Ä¶\\u003c/li\\u003e\\n\\u003cli\\u003e(optional, would need protocol extension) send ‚Äúflush‚Äù packet to have all controllers pick up the updates and queue data to be sent\\u003c/li\\u003e\\n\\u003cli\\u003eget current amps for motor 0 (and potentially encoder reading or whatever else you need)\\u003c/li\\u003e\\n\\u003cli\\u003eget current amps for motor 1 (and potentially encoder reading or whatever else you need)\\u003c/li\\u003e\\n\\u003cli\\u003eget current amps for motor 2 (and potentially encoder reading or whatever else you need)\\u003c/li\\u003e\\n\\u003cli\\u003e‚Ä¶\\u003c/li\\u003e\\n\\u003cli\\u003edo snazzy controls calcs, let other CAN traffic happen, wait and start the cycle over.\\u003c/li\\u003e\\n\\u003c/ul\\u003e\\n\\u003cp\\u003eThat way the same thing happens every cycle and the timing can be consistent (within 1 CAN packet if something else is happening when this all kicks off).  1 CAN packet at 1 mbps is ~100 uS, which is 2% error on a 5ms loop.  ie, not bad at all!  This adds 1 cycle of delay (5ms), but that is well understood and model-able and controllable.  That requires the other bus traffic to be lower CAN priority though which the current CAN ID bit allocation has challenges with.\\u003c/p\\u003e\\n\\u003cp\\u003eAs \\u003ca class=\\\"mention\\\" href=\\\"/u/calcmogul\\\"\\u003e@calcmogul\\u003c/a\\u003e points out, you can always slow your controller down, but we should be able to do better \\u003cimg src=\\\"https://www.chiefdelphi.com/images/emoji/google/slight_smile.png?v=9\\\" title=\\\":slight_smile:\\\" class=\\\"emoji\\\" alt=\\\":slight_smile:\\\"\\u003e\\u003c/p\\u003e\\n\\u003cp\\u003eDo you happen to know off the top of your head if there are any other threads involved with sending or receiving CAN data that would need prioritization to get to some sort of repeatable, periodic loop?\\u003c/p\\u003e\",\"post_number\":8,\"post_type\":1,\"posts_count\":21,\"updated_at\":\"2021-10-13T03:08:30.849Z\",\"reply_count\":1,\"reply_to_post_number\":3,\"quote_count\":0,\"incoming_link_count\":9,\"reads\":256,\"readers_count\":255,\"score\":146.2,\"yours\":false,\"topic_id\":396566,\"topic_slug\":\"lets-talk-about-can-delays-and-how-to-address-them\",\"display_username\":\"Austin Schuh\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":1,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"read\":true,\"user_title\":\"\",\"reply_to_user\":{\"id\":13575,\"username\":\"Peter_Johnson\",\"name\":\"Peter Johnson\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/peter_johnson/{size}/10417_2.png\"},\"bookmarked\":false,\"actions_summary\":[{\"id\":2,\"count\":3}],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":4655,\"hidden\":false,\"trust_level\":2,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"user_custom_fields\":{\"user_field_4\":\"\"},\"post_url\":\"/t/lets-talk-about-can-delays-and-how-to-address-them/396566/8\",\"custom_user_title\":null,\"reactions\":[{\"id\":\"heart\",\"type\":\"emoji\",\"count\":3}],\"current_user_reaction\":null,\"reaction_users_count\":3,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":null},{\"id\":2971843,\"name\":\"Austin Schuh\",\"username\":\"AustinSchuh\",\"avatar_template\":\"/letter_avatar_proxy/v4/letter/a/e19b73/{size}.png\",\"created_at\":\"2021-10-13T03:15:12.133Z\",\"cooked\":\"\\u003caside class=\\\"quote no-group\\\" data-username=\\\"CarlosGJ\\\" data-post=\\\"7\\\" data-topic=\\\"396566\\\" data-full=\\\"true\\\"\\u003e\\n\\u003cdiv class=\\\"title\\\"\\u003e\\n\\u003cdiv class=\\\"quote-controls\\\"\\u003e\\u003c/div\\u003e\\n\\u003cimg loading=\\\"lazy\\\" alt=\\\"\\\" width=\\\"24\\\" height=\\\"24\\\" src=\\\"https://www.chiefdelphi.com/user_avatar/www.chiefdelphi.com/carlosgj/48/131747_2.png\\\" class=\\\"avatar\\\"\\u003e CarlosGJ:\\u003c/div\\u003e\\n\\u003cblockquote\\u003e\\n\\u003cp\\u003eThe arbitration, and possible retransmit attempts, happens at a low level in a \\u003cspan class=\\\"abbreviation\\\"\\u003eCAN\\u003ctemplate class=\\\"tooltiptext\\\" data-text=\\\"Controller Area Network\\\"\\u003e\\u003c/template\\u003e\\u003c/span\\u003e controller (an IP block in the FPGA, in the case of the RIO), and typically isn‚Äôt very accessible from software.\\u003c/p\\u003e\\n\\u003c/blockquote\\u003e\\n\\u003c/aside\\u003e\\n\\u003cp\\u003eTo be clear, arbitration is actually built into the transport layer in \\u003cspan class=\\\"abbreviation\\\"\\u003eCAN\\u003ctemplate class=\\\"tooltiptext\\\" data-text=\\\"Controller Area Network\\\"\\u003e\\u003c/template\\u003e\\u003c/span\\u003e.  The dominant and recessive bits implement arbitration quite nicely so the highest priority packet (lowerst \\u003cspan class=\\\"abbreviation\\\"\\u003eCAN\\u003ctemplate class=\\\"tooltiptext\\\" data-text=\\\"Controller Area Network\\\"\\u003e\\u003c/template\\u003e\\u003c/span\\u003e ID) goes out first.  As 2 packets are being sent at the same time, the dominant bits keep winning (0‚Äôs) when sending the ID, and any time a node on the \\u003cspan class=\\\"abbreviation\\\"\\u003eCAN\\u003ctemplate class=\\\"tooltiptext\\\" data-text=\\\"Controller Area Network\\\"\\u003e\\u003c/template\\u003e\\u003c/span\\u003e bus detects that it lost when sending it‚Äôs ID out to another node (it‚Äôs 1 became a 0), it stops sending and retries next cycle.\\u003c/p\\u003e\\n\\u003cp\\u003eJ1939 (and by extension ISO11783) implement this by reserving the first 3 bits of the \\u003cspan class=\\\"abbreviation\\\"\\u003eCAN\\u003ctemplate class=\\\"tooltiptext\\\" data-text=\\\"Controller Area Network\\\"\\u003e\\u003c/template\\u003e\\u003c/span\\u003e ID for a ‚Äúpriority‚Äù.\\u003cbr\\u003e\\n          \\u003ca href=\\\"https://tractorhacking.github.io/images/idmap.png\\\" target=\\\"_blank\\\" rel=\\\"noopener nofollow ugc\\\" class=\\\"onebox\\\"\\u003e\\n            \\u003cimg src=\\\"https://tractorhacking.github.io/images/idmap.png\\\" width=\\\"690\\\" height=\\\"179\\\"\\u003e\\n          \\u003c/a\\u003e\\n\\u003c/p\\u003e\",\"post_number\":9,\"post_type\":1,\"posts_count\":21,\"updated_at\":\"2021-10-13T03:15:12.133Z\",\"reply_count\":1,\"reply_to_post_number\":7,\"quote_count\":1,\"incoming_link_count\":9,\"reads\":246,\"readers_count\":245,\"score\":114.2,\"yours\":false,\"topic_id\":396566,\"topic_slug\":\"lets-talk-about-can-delays-and-how-to-address-them\",\"display_username\":\"Austin Schuh\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":1,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"read\":true,\"user_title\":\"\",\"bookmarked\":false,\"actions_summary\":[{\"id\":2,\"count\":1}],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":4655,\"hidden\":false,\"trust_level\":2,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"user_custom_fields\":{\"user_field_4\":\"\"},\"post_url\":\"/t/lets-talk-about-can-delays-and-how-to-address-them/396566/9\",\"custom_user_title\":null,\"reactions\":[{\"id\":\"heart\",\"type\":\"emoji\",\"count\":1}],\"current_user_reaction\":null,\"reaction_users_count\":1,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":null},{\"id\":2971849,\"name\":\"Carlos Gross Jones\",\"username\":\"CarlosGJ\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/carlosgj/{size}/131747_2.png\",\"created_at\":\"2021-10-13T03:53:25.790Z\",\"cooked\":\"\\u003caside class=\\\"quote no-group\\\" data-username=\\\"AustinSchuh\\\" data-post=\\\"9\\\" data-topic=\\\"396566\\\"\\u003e\\n\\u003cdiv class=\\\"title\\\"\\u003e\\n\\u003cdiv class=\\\"quote-controls\\\"\\u003e\\u003c/div\\u003e\\n\\u003cimg loading=\\\"lazy\\\" alt=\\\"\\\" width=\\\"24\\\" height=\\\"24\\\" src=\\\"https://www.chiefdelphi.com/letter_avatar_proxy/v4/letter/a/e19b73/48.png\\\" class=\\\"avatar\\\"\\u003e AustinSchuh:\\u003c/div\\u003e\\n\\u003cblockquote\\u003e\\n\\u003cp\\u003eJ1939 (and by extension ISO11783) implement this by reserving the first 3 bits of the \\u003cspan class=\\\"abbreviation\\\"\\u003eCAN\\u003ctemplate class=\\\"tooltiptext\\\" data-text=\\\"Controller Area Network\\\"\\u003e\\u003c/template\\u003e\\u003c/span\\u003e ID for a ‚Äúpriority‚Äù.\\u003c/p\\u003e\\n\\u003c/blockquote\\u003e\\n\\u003c/aside\\u003e\\n\\u003cp\\u003eThat‚Äôs not relevant to \\u003cspan class=\\\"abbreviation\\\"\\u003eFRC\\u003ctemplate class=\\\"tooltiptext\\\" data-text=\\\"FIRST Robotics Competition\\\"\\u003e\\u003c/template\\u003e\\u003c/span\\u003e, though; the 29 bits of identifier are split up differently, and the whole thing is effectively the ‚Äúpriority‚Äù.\\u003c/p\\u003e\\n\\u003caside class=\\\"quote no-group\\\" data-username=\\\"AustinSchuh\\\" data-post=\\\"8\\\" data-topic=\\\"396566\\\"\\u003e\\n\\u003cdiv class=\\\"title\\\"\\u003e\\n\\u003cdiv class=\\\"quote-controls\\\"\\u003e\\u003c/div\\u003e\\n\\u003cimg loading=\\\"lazy\\\" alt=\\\"\\\" width=\\\"24\\\" height=\\\"24\\\" src=\\\"https://www.chiefdelphi.com/letter_avatar_proxy/v4/letter/a/e19b73/48.png\\\" class=\\\"avatar\\\"\\u003e AustinSchuh:\\u003c/div\\u003e\\n\\u003cblockquote\\u003e\\n\\u003cp\\u003e(optional, would need protocol extension) send ‚Äúflush‚Äù packet to have all controllers pick up the updates and queue data to be sent\\u003c/p\\u003e\\n\\u003c/blockquote\\u003e\\n\\u003c/aside\\u003e\\n\\u003cp\\u003eThat was actually (partially) implemented in the Jaguars that everyone likes to complain about, via the ‚Äúsynchronous update‚Äù mechanism. See p. 20: \\u003ca href=\\\"http://carlosgj.org/Lorentz/7870.SW-RDK-BDC24-UG-7243.pdf\\\"\\u003ehttp://carlosgj.org/Lorentz/7870.SW-RDK-BDC24-UG-7243.pdf\\u003c/a\\u003e\\u003c/p\\u003e\",\"post_number\":10,\"post_type\":1,\"posts_count\":21,\"updated_at\":\"2021-10-13T03:53:25.790Z\",\"reply_count\":0,\"reply_to_post_number\":9,\"quote_count\":2,\"incoming_link_count\":3,\"reads\":235,\"readers_count\":234,\"score\":77.0,\"yours\":false,\"topic_id\":396566,\"topic_slug\":\"lets-talk-about-can-delays-and-how-to-address-them\",\"display_username\":\"Carlos Gross Jones\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":1,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"link_counts\":[{\"url\":\"http://carlosgj.org/Lorentz/7870.SW-RDK-BDC24-UG-7243.pdf\",\"internal\":false,\"reflection\":false,\"clicks\":7}],\"read\":true,\"user_title\":\"\",\"bookmarked\":false,\"actions_summary\":[{\"id\":2,\"count\":1}],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":16115,\"hidden\":false,\"trust_level\":2,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"user_custom_fields\":{\"user_field_4\":\"Mere hours of work can save you entire minutes of planning\"},\"post_url\":\"/t/lets-talk-about-can-delays-and-how-to-address-them/396566/10\",\"custom_user_title\":\"Mere hours of work can save you entire minutes of planning\",\"reactions\":[{\"id\":\"heart\",\"type\":\"emoji\",\"count\":1}],\"current_user_reaction\":null,\"reaction_users_count\":1,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":null},{\"id\":2971862,\"name\":\"Joe Johnson\",\"username\":\"Joe_Johnson\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/joe_johnson/{size}/156076_2.png\",\"created_at\":\"2021-10-13T13:03:12.146Z\",\"cooked\":\"\\u003cp\\u003eI started this conversation to try to understand if\\u003cbr\\u003e\\n(A) if CAN delay issues were a significant problem in the path of implementing high performance control strategy using CAN\\u003cbr\\u003e\\n(B) if so, if anything could be done about it (short of getting FIRST/REV/NI/CTRE involved)\\u003c/p\\u003e\\n\\u003cp\\u003eWith regard to A. The timing is not ideal, especially if you want/need 5ms loop times.\\u003c/p\\u003e\\n\\u003cp\\u003eWith regard to B. I guess I am hearing that not much can be done.\\u003c/p\\u003e\\n\\u003cp\\u003eIs that about the size of it?\\u003c/p\\u003e\",\"post_number\":11,\"post_type\":1,\"posts_count\":21,\"updated_at\":\"2021-10-13T13:03:12.146Z\",\"reply_count\":1,\"reply_to_post_number\":null,\"quote_count\":0,\"incoming_link_count\":1,\"reads\":224,\"readers_count\":223,\"score\":84.8,\"yours\":false,\"topic_id\":396566,\"topic_slug\":\"lets-talk-about-can-delays-and-how-to-address-them\",\"display_username\":\"Joe Johnson\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":1,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"read\":true,\"user_title\":\"\",\"bookmarked\":false,\"actions_summary\":[{\"id\":2,\"count\":2}],\"moderator\":true,\"admin\":false,\"staff\":true,\"user_id\":6,\"hidden\":false,\"trust_level\":4,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"post_url\":\"/t/lets-talk-about-can-delays-and-how-to-address-them/396566/11\",\"custom_user_title\":null,\"reactions\":[{\"id\":\"heart\",\"type\":\"emoji\",\"count\":2}],\"current_user_reaction\":null,\"reaction_users_count\":2,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":null},{\"id\":2971863,\"name\":\"Lexeo\",\"username\":\"Lexeo\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/lexeo/{size}/160041_2.png\",\"created_at\":\"2021-10-13T13:16:52.792Z\",\"cooked\":\"\\u003cp\\u003eI‚Äôve been trying to think through this, and I suppose another solution would be to try and leave out the CAN bus from the system (as much as possible).\\u003c/p\\u003e\\n\\u003cp\\u003eI don‚Äôt think you could do this with the Falcon/CanCoder setup, but I think it may be possible with a Neo/standard mag encoder setup. If you made a breakout board to read the signals from the Neo encoder before they go into the Spark Max, you wouldn‚Äôt have to rely on the CAN timing to get that information. Either feed that directly to the Rio, or make a nice little PCB with a microcontroller that feeds that data to the Rio any way you want (maybe use CAN with a timestamp, or a different digital bus).\\u003c/p\\u003e\\n\\u003cp\\u003eJust a thought. This obviously is not as clean of a wiring/programming solution as all CAN, but it could give you better control.\\u003c/p\\u003e\",\"post_number\":12,\"post_type\":1,\"posts_count\":21,\"updated_at\":\"2021-10-13T13:16:52.792Z\",\"reply_count\":1,\"reply_to_post_number\":11,\"quote_count\":0,\"incoming_link_count\":1,\"reads\":223,\"readers_count\":222,\"score\":54.6,\"yours\":false,\"topic_id\":396566,\"topic_slug\":\"lets-talk-about-can-delays-and-how-to-address-them\",\"display_username\":\"Lexeo\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":1,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"read\":true,\"user_title\":\"\",\"reply_to_user\":{\"id\":6,\"username\":\"Joe_Johnson\",\"name\":\"Joe Johnson\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/joe_johnson/{size}/156076_2.png\"},\"bookmarked\":false,\"actions_summary\":[],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":25373,\"hidden\":false,\"trust_level\":2,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"user_custom_fields\":{\"user_field_4\":\"Team 4272 Lead Mentor and Head Robot Mentor\"},\"post_url\":\"/t/lets-talk-about-can-delays-and-how-to-address-them/396566/12\",\"custom_user_title\":\"Team 4272 Lead Mentor and Head Robot Mentor\",\"reactions\":[],\"current_user_reaction\":null,\"reaction_users_count\":0,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":null},{\"id\":2971882,\"name\":\"Peter Johnson\",\"username\":\"Peter_Johnson\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/peter_johnson/{size}/10417_2.png\",\"created_at\":\"2021-10-13T16:01:18.901Z\",\"cooked\":\"\\u003caside class=\\\"quote no-group\\\" data-username=\\\"Lexeo\\\" data-post=\\\"12\\\" data-topic=\\\"396566\\\"\\u003e\\n\\u003cdiv class=\\\"title\\\"\\u003e\\n\\u003cdiv class=\\\"quote-controls\\\"\\u003e\\u003c/div\\u003e\\n\\u003cimg loading=\\\"lazy\\\" alt=\\\"\\\" width=\\\"24\\\" height=\\\"24\\\" src=\\\"https://www.chiefdelphi.com/user_avatar/www.chiefdelphi.com/lexeo/48/160041_2.png\\\" class=\\\"avatar\\\"\\u003e Lexeo:\\u003c/div\\u003e\\n\\u003cblockquote\\u003e\\n\\u003cp\\u003eI‚Äôve been trying to think through this, and I suppose another solution would be to try and leave out the \\u003cspan class=\\\"abbreviation\\\"\\u003eCAN\\u003ctemplate class=\\\"tooltiptext\\\" data-text=\\\"Controller Area Network\\\"\\u003e\\u003c/template\\u003e\\u003c/span\\u003e bus from the system (as much as possible).\\u003c/p\\u003e\\n\\u003c/blockquote\\u003e\\n\\u003c/aside\\u003e\\n\\u003cp\\u003eFYI, that‚Äôs exactly what 971 does, and for this exact reason‚Ä¶ their robots are all \\u003cspan class=\\\"abbreviation\\\"\\u003ePWM\\u003ctemplate class=\\\"tooltiptext\\\" data-text=\\\"Pulse Width Modulation\\\"\\u003e\\u003c/template\\u003e\\u003c/span\\u003e-based, at least for anything that needs RT control over timing (I‚Äôve not asked, but they might e.g. put an intake motor on \\u003cspan class=\\\"abbreviation\\\"\\u003eCAN\\u003ctemplate class=\\\"tooltiptext\\\" data-text=\\\"Controller Area Network\\\"\\u003e\\u003c/template\\u003e\\u003c/span\\u003e?).  \\u003ca class=\\\"mention\\\" href=\\\"/u/austinschuh\\\"\\u003e@AustinSchuh\\u003c/a\\u003e can talk more about their overall design approach.\\u003c/p\\u003e\",\"post_number\":13,\"post_type\":1,\"posts_count\":21,\"updated_at\":\"2021-10-13T16:01:18.901Z\",\"reply_count\":3,\"reply_to_post_number\":12,\"quote_count\":1,\"incoming_link_count\":1,\"reads\":209,\"readers_count\":208,\"score\":151.8,\"yours\":false,\"topic_id\":396566,\"topic_slug\":\"lets-talk-about-can-delays-and-how-to-address-them\",\"display_username\":\"Peter Johnson\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":1,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"read\":true,\"user_title\":\"\",\"bookmarked\":false,\"actions_summary\":[{\"id\":2,\"count\":6}],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":13575,\"hidden\":false,\"trust_level\":2,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"user_custom_fields\":{\"user_field_4\":\"Volunteer WPILib Developer, CSA\"},\"post_url\":\"/t/lets-talk-about-can-delays-and-how-to-address-them/396566/13\",\"custom_user_title\":\"Volunteer WPILib Developer, CSA\",\"reactions\":[{\"id\":\"heart\",\"type\":\"emoji\",\"count\":6}],\"current_user_reaction\":null,\"reaction_users_count\":6,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":null},{\"id\":2971884,\"name\":\"Lexeo\",\"username\":\"Lexeo\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/lexeo/{size}/160041_2.png\",\"created_at\":\"2021-10-13T16:25:42.213Z\",\"cooked\":\"\\u003cp\\u003eI‚Äôve heard rumors of that, but I wasn‚Äôt 100% sure.\\u003c/p\\u003e\\n\\u003cp\\u003eThat is pretty neat. It would be great to get their input on this.\\u003c/p\\u003e\\n\\u003cp\\u003eAlso, has anyone tried to read the encoder off of the Neo (without disrupting the signal going to the Spark Max)? I am making the assumption that its not too hard to do. You could probably figure it out with a multi-meter. I couldn‚Äôt find any documentation on exactly how it is wired.\\u003c/p\\u003e\",\"post_number\":14,\"post_type\":1,\"posts_count\":21,\"updated_at\":\"2021-10-13T16:26:00.353Z\",\"reply_count\":1,\"reply_to_post_number\":13,\"quote_count\":0,\"incoming_link_count\":6,\"reads\":210,\"readers_count\":209,\"score\":77.0,\"yours\":false,\"topic_id\":396566,\"topic_slug\":\"lets-talk-about-can-delays-and-how-to-address-them\",\"display_username\":\"Lexeo\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":1,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"read\":true,\"user_title\":\"\",\"reply_to_user\":{\"id\":13575,\"username\":\"Peter_Johnson\",\"name\":\"Peter Johnson\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/peter_johnson/{size}/10417_2.png\"},\"bookmarked\":false,\"actions_summary\":[],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":25373,\"hidden\":false,\"trust_level\":2,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"user_custom_fields\":{\"user_field_4\":\"Team 4272 Lead Mentor and Head Robot Mentor\"},\"post_url\":\"/t/lets-talk-about-can-delays-and-how-to-address-them/396566/14\",\"custom_user_title\":\"Team 4272 Lead Mentor and Head Robot Mentor\",\"reactions\":[],\"current_user_reaction\":null,\"reaction_users_count\":0,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":null},{\"id\":2971885,\"name\":\"Tyler Veness\",\"username\":\"calcmogul\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/calcmogul/{size}/128045_2.png\",\"created_at\":\"2021-10-13T16:36:00.616Z\",\"cooked\":\"\\u003cp\\u003e3512 hasn‚Äôt had measurable controls problems (delay, oscillation, chattering) in our reference/state/input/output plots using \\u003cspan class=\\\"abbreviation\\\"\\u003eCAN\\u003ctemplate class=\\\"tooltiptext\\\" data-text=\\\"Controller Area Network\\\"\\u003e\\u003c/template\\u003e\\u003c/span\\u003e motor controllers and RIO sensors for our drivetrain, turret, and flywheel. We use an RT thread with 0.1 ms of jitter and a 5 ms sample period. We avoid using encoder data from asynchronous \\u003cspan class=\\\"abbreviation\\\"\\u003eCAN\\u003ctemplate class=\\\"tooltiptext\\\" data-text=\\\"Controller Area Network\\\"\\u003e\\u003c/template\\u003e\\u003c/span\\u003e status frames (as opposed to blocking on status frame receive, which idk how to do) for feedback because compensating for variable measurement delay from 0 ms to 20 ms (the nominal status frame period) would be annoying. If I recall correctly, the \\u003cspan class=\\\"abbreviation\\\"\\u003eCAN\\u003ctemplate class=\\\"tooltiptext\\\" data-text=\\\"Controller Area Network\\\"\\u003e\\u003c/template\\u003e\\u003c/span\\u003e layer provides timestamps, but it‚Äôs not exposed through the HAL.\\u003c/p\\u003e\\n\\u003cp\\u003eWe use the NEO hall effect encoder on our climber, which is sent via a \\u003cspan class=\\\"abbreviation\\\"\\u003eCAN\\u003ctemplate class=\\\"tooltiptext\\\" data-text=\\\"Controller Area Network\\\"\\u003e\\u003c/template\\u003e\\u003c/span\\u003e status frame, for soft limits because we don‚Äôt care about determinism for that.\\u003c/p\\u003e\\n\\u003caside class=\\\"quote no-group\\\" data-username=\\\"Lexeo\\\" data-post=\\\"14\\\" data-topic=\\\"396566\\\"\\u003e\\n\\u003cdiv class=\\\"title\\\"\\u003e\\n\\u003cdiv class=\\\"quote-controls\\\"\\u003e\\u003c/div\\u003e\\n\\u003cimg loading=\\\"lazy\\\" alt=\\\"\\\" width=\\\"24\\\" height=\\\"24\\\" src=\\\"https://www.chiefdelphi.com/user_avatar/www.chiefdelphi.com/lexeo/48/160041_2.png\\\" class=\\\"avatar\\\"\\u003e Lexeo:\\u003c/div\\u003e\\n\\u003cblockquote\\u003e\\n\\u003cp\\u003eAlso, has anyone tried to read the encoder off of the Neo (without disrupting the signal going to the Spark Max)?\\u003c/p\\u003e\\n\\u003c/blockquote\\u003e\\n\\u003c/aside\\u003e\\n\\u003cp\\u003eYou could, but keep in mind it‚Äôll be noisy. The Spark Max applies a large amount of unconfigurable filtering, so you‚Äôll likely have to do the same thing if you just splice the wires and read them yourself.\\u003c/p\\u003e\\n\\u003cp\\u003e3512 attempted on-motor-controller feedback with the NEO hall effect encoder on our flywheel, but the internal filtering added too much lag to hit tight recovery tolerances. It has a 64-tap moving average sampled every 1 ms, so that gives (64 - 1) / 2 = 31.5 ms of delay. Non-oscillatory gains had 1-2 s recovery times compared to 150 ms for our RIO encoder setup. Measurement delay matters less for systems that accelerate slower like drivetrains, but it‚Äôs still not great.\\u003c/p\\u003e\\n\\u003cp\\u003eWe never tried a separate quadrature encoder plugged into the Spark Max data port (which does have configurable filtering) because alternate encoder support wasn‚Äôt implemented at the time (January 2020).\\u003c/p\\u003e\",\"post_number\":15,\"post_type\":1,\"posts_count\":21,\"updated_at\":\"2021-10-13T16:54:14.442Z\",\"reply_count\":2,\"reply_to_post_number\":13,\"quote_count\":1,\"incoming_link_count\":5,\"reads\":210,\"readers_count\":209,\"score\":137.0,\"yours\":false,\"topic_id\":396566,\"topic_slug\":\"lets-talk-about-can-delays-and-how-to-address-them\",\"display_username\":\"Tyler Veness\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":3,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"read\":true,\"user_title\":\"\",\"reply_to_user\":{\"id\":13575,\"username\":\"Peter_Johnson\",\"name\":\"Peter Johnson\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/peter_johnson/{size}/10417_2.png\"},\"bookmarked\":false,\"actions_summary\":[{\"id\":2,\"count\":4}],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":16846,\"hidden\":false,\"trust_level\":2,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"user_custom_fields\":{\"user_field_4\":\"WPILib controls | Choreo optimizer backend\"},\"post_url\":\"/t/lets-talk-about-can-delays-and-how-to-address-them/396566/15\",\"custom_user_title\":\"WPILib controls | Choreo optimizer backend\",\"reactions\":[{\"id\":\"heart\",\"type\":\"emoji\",\"count\":4}],\"current_user_reaction\":null,\"reaction_users_count\":4,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":null},{\"id\":2971889,\"name\":\"Joe Johnson\",\"username\":\"Joe_Johnson\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/joe_johnson/{size}/156076_2.png\",\"created_at\":\"2021-10-13T16:56:05.894Z\",\"cooked\":\"\\u003cp\\u003eFirst off, great input. I really appreciate that everyone helping me to work through this.\\u003c/p\\u003e\\n\\u003cp\\u003eI am reasonably committed to using the Falcons so you are making me sad if I can‚Äôt use the Falcon internal encoders and (I assume) its current sensors either if I want to use them for feedback in a system that aspires to a 5ms loop time.\\u003c/p\\u003e\\n\\u003cp\\u003eCANcoders are in the same bucket then‚Ä¶\\u003c/p\\u003e\\n\\u003cp\\u003eNot the best news I could have expected.\\u003c/p\\u003e\\n\\u003cp\\u003eTrying to see what I can salvage. Suppose that CAN outputs are ok enough (based on 3251‚Äôs experience) then we could use the Falcons in current mode. If I rolled my own, non-CAN encoders and current sensing, do you think we could build a reliable State Space controller with a 5ms loop time?\\u003c/p\\u003e\",\"post_number\":16,\"post_type\":1,\"posts_count\":21,\"updated_at\":\"2021-10-13T17:00:53.458Z\",\"reply_count\":1,\"reply_to_post_number\":15,\"quote_count\":0,\"incoming_link_count\":6,\"reads\":207,\"readers_count\":206,\"score\":76.4,\"yours\":false,\"topic_id\":396566,\"topic_slug\":\"lets-talk-about-can-delays-and-how-to-address-them\",\"display_username\":\"Joe Johnson\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":1,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"read\":true,\"user_title\":\"\",\"reply_to_user\":{\"id\":16846,\"username\":\"calcmogul\",\"name\":\"Tyler Veness\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/calcmogul/{size}/128045_2.png\"},\"bookmarked\":false,\"actions_summary\":[],\"moderator\":true,\"admin\":false,\"staff\":true,\"user_id\":6,\"hidden\":false,\"trust_level\":4,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"post_url\":\"/t/lets-talk-about-can-delays-and-how-to-address-them/396566/16\",\"custom_user_title\":null,\"reactions\":[],\"current_user_reaction\":null,\"reaction_users_count\":0,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":null},{\"id\":2971890,\"name\":\"s-neff\",\"username\":\"s-neff\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/s-neff/{size}/9062_2.png\",\"created_at\":\"2021-10-13T16:56:21.942Z\",\"cooked\":\"\\u003caside class=\\\"quote no-group\\\" data-username=\\\"calcmogul\\\" data-post=\\\"15\\\" data-topic=\\\"396566\\\"\\u003e\\n\\u003cdiv class=\\\"title\\\"\\u003e\\n\\u003cdiv class=\\\"quote-controls\\\"\\u003e\\u003c/div\\u003e\\n\\u003cimg loading=\\\"lazy\\\" alt=\\\"\\\" width=\\\"24\\\" height=\\\"24\\\" src=\\\"https://www.chiefdelphi.com/user_avatar/www.chiefdelphi.com/calcmogul/48/128045_2.png\\\" class=\\\"avatar\\\"\\u003e calcmogul:\\u003c/div\\u003e\\n\\u003cblockquote\\u003e\\n\\u003cp\\u003e3512 attempted on-motor-controller feedback with the NEO hall effect encoder on our flywheel, but the internal filtering added too much lag to hit tight recovery tolerances. It has a 64-tap moving average sampled every 1 ms, so that gives (64 - 1) / 2 = 31.5 ms of delay. Non-oscillatory gains had 1-2 s recovery times\\u003c/p\\u003e\\n\\u003c/blockquote\\u003e\\n\\u003c/aside\\u003e\\n\\u003cp\\u003eAnecdotally - We got a twin falcon setup working at much better than 1-2sec recovery, with onboard controls only (and fairly low mechanical compression). So the enhanced CPR encoder is critical in these type of applications?\\u003c/p\\u003e\",\"post_number\":17,\"post_type\":1,\"posts_count\":21,\"updated_at\":\"2021-10-13T16:57:14.777Z\",\"reply_count\":1,\"reply_to_post_number\":15,\"quote_count\":1,\"incoming_link_count\":2,\"reads\":209,\"readers_count\":208,\"score\":56.8,\"yours\":false,\"topic_id\":396566,\"topic_slug\":\"lets-talk-about-can-delays-and-how-to-address-them\",\"display_username\":\"s-neff\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":1,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"read\":true,\"user_title\":\"\",\"bookmarked\":false,\"actions_summary\":[],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":28019,\"hidden\":false,\"trust_level\":2,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"user_custom_fields\":{\"user_field_4\":\"\"},\"post_url\":\"/t/lets-talk-about-can-delays-and-how-to-address-them/396566/17\",\"custom_user_title\":null,\"reactions\":[],\"current_user_reaction\":null,\"reaction_users_count\":0,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":null},{\"id\":2971891,\"name\":\"Tyler Veness\",\"username\":\"calcmogul\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/calcmogul/{size}/128045_2.png\",\"created_at\":\"2021-10-13T16:59:01.725Z\",\"cooked\":\"\\u003caside class=\\\"quote no-group\\\" data-username=\\\"Joe_Johnson\\\" data-post=\\\"16\\\" data-topic=\\\"396566\\\"\\u003e\\n\\u003cdiv class=\\\"title\\\"\\u003e\\n\\u003cdiv class=\\\"quote-controls\\\"\\u003e\\u003c/div\\u003e\\n\\u003cimg loading=\\\"lazy\\\" alt=\\\"\\\" width=\\\"24\\\" height=\\\"24\\\" src=\\\"https://www.chiefdelphi.com/user_avatar/www.chiefdelphi.com/joe_johnson/48/156076_2.png\\\" class=\\\"avatar\\\"\\u003e Joe_Johnson:\\u003c/div\\u003e\\n\\u003cblockquote\\u003e\\n\\u003cp\\u003eI am reasonably committed to using the Falcons so you are making me sad if I can‚Äôt use the Falcon internal encoders and (I assume) its current sensors either if I want to use them for feedback in a system that aspires to a 5ms loop time.\\u003c/p\\u003e\\n\\u003c/blockquote\\u003e\\n\\u003c/aside\\u003e\\n\\u003caside class=\\\"quote no-group\\\" data-username=\\\"s-neff\\\" data-post=\\\"17\\\" data-topic=\\\"396566\\\"\\u003e\\n\\u003cdiv class=\\\"title\\\"\\u003e\\n\\u003cdiv class=\\\"quote-controls\\\"\\u003e\\u003c/div\\u003e\\n\\u003cimg loading=\\\"lazy\\\" alt=\\\"\\\" width=\\\"24\\\" height=\\\"24\\\" src=\\\"https://www.chiefdelphi.com/user_avatar/www.chiefdelphi.com/s-neff/48/9062_2.png\\\" class=\\\"avatar\\\"\\u003e s-neff:\\u003c/div\\u003e\\n\\u003cblockquote\\u003e\\n\\u003cp\\u003eAnecdotally - We got a twin falcon setup working at much better than 1-2sec recovery, with onboard controls only (and fairly low mechanical compression). So the enhanced CPR encoder is critical in these type of applications?\\u003c/p\\u003e\\n\\u003c/blockquote\\u003e\\n\\u003c/aside\\u003e\\n\\u003cp\\u003eThe Falcon built-in encoders have much higher resolution than the NEO (2048 CPR for Falcon vs 42 CPR for NEO), and the filtering is configurable. Their default is also 64 taps based on \\u003ca href=\\\"https://docs.ctre-phoenix.com/en/stable/ch14_MCSensor.html\\\" class=\\\"inline-onebox\\\" rel=\\\"noopener nofollow ugc\\\"\\u003eBring Up: Talon FX/SRX Sensors ‚Äî Phoenix documentation\\u003c/a\\u003e. I think the filtering matters more than the CPR, although lower resolutions require more filtering if you don‚Äôt want a choppy signal due to quantization noise.\\u003c/p\\u003e\",\"post_number\":18,\"post_type\":1,\"posts_count\":21,\"updated_at\":\"2021-10-13T17:05:27.976Z\",\"reply_count\":0,\"reply_to_post_number\":16,\"quote_count\":2,\"incoming_link_count\":2,\"reads\":216,\"readers_count\":215,\"score\":83.2,\"yours\":false,\"topic_id\":396566,\"topic_slug\":\"lets-talk-about-can-delays-and-how-to-address-them\",\"display_username\":\"Tyler Veness\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":2,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"link_counts\":[{\"url\":\"https://docs.ctre-phoenix.com/en/stable/ch14_MCSensor.html\",\"internal\":false,\"reflection\":false,\"title\":\"Bring Up: Talon FX/SRX Sensors ‚Äî Phoenix documentation\",\"clicks\":4}],\"read\":true,\"user_title\":\"\",\"bookmarked\":false,\"actions_summary\":[{\"id\":2,\"count\":2}],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":16846,\"hidden\":false,\"trust_level\":2,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"user_custom_fields\":{\"user_field_4\":\"WPILib controls | Choreo optimizer backend\"},\"post_url\":\"/t/lets-talk-about-can-delays-and-how-to-address-them/396566/18\",\"custom_user_title\":\"WPILib controls | Choreo optimizer backend\",\"reactions\":[{\"id\":\"heart\",\"type\":\"emoji\",\"count\":2}],\"current_user_reaction\":null,\"reaction_users_count\":2,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":null},{\"id\":2972044,\"name\":\"Austin Schuh\",\"username\":\"AustinSchuh\",\"avatar_template\":\"/letter_avatar_proxy/v4/letter/a/e19b73/{size}.png\",\"created_at\":\"2021-10-14T18:40:53.653Z\",\"cooked\":\"\\u003cp\\u003ePeter nailed how we tackle this.  I can provide a lot more detail.\\u003c/p\\u003e\\n\\u003cp\\u003eThe FPGA reports back when the PWM cycle ends.  This is when the falling edge of all the PWM pulses go out.  NI graciously adjusted the PWM cycle so that the falling edges are aligned rather than the rising edges.  Each motor controller updates it‚Äôs output duty cycle on the falling edge, so this means that all the controllers actually update at the same time, and a fixed 5.05ms after the previous output.  We then sleep until 50 uS after that point in time, wake up, sample all our sensors, and do our controls calcs.  We then write the outputs to the FPGA to be picked up when the PWM outputs start again.\\u003c/p\\u003e\\n\\u003cp\\u003et=0 ms falling edge of PWM cycle\\u003cbr\\u003e\\nt=0.05ms schedule wakeup\\u003cbr\\u003e\\nt=0.15ms sample sensors\\u003cbr\\u003e\\nt=1.0ms start control loop calcs\\u003cbr\\u003e\\nt=1.5 ms controls calcs finish\\u003cbr\\u003e\\nt=1.7 ms FPGA registers written with new controls values\\u003cbr\\u003e\\nt=2.45 ms (assuming a 2.6ms PWM pulse) FPGA acts on PWM register value\\u003cbr\\u003e\\nt=5.05 ms start over\\u003c/p\\u003e\\n\\u003cp\\u003eThere is a lot of tuning we do to our software to keep these times constant and make sure we always get scheduled promptly.  I‚Äôm happy to go into more detail, but there is a fair amount more here.  We are seeing ~150 uS of scheduling jitter.\\u003c/p\\u003e\\n\\u003cp\\u003eIf you look at the math behind the Z transform (which is the math that discrete time controls use), it essentially assumes that control loops happen at a fixed, well known, period.  Rather than fight that math, we instead build software to try to meet those guarantees.\\u003c/p\\u003e\\n\\u003cp\\u003eI can go into more detail if you have questions.\\u003c/p\\u003e\",\"post_number\":19,\"post_type\":1,\"posts_count\":21,\"updated_at\":\"2021-10-14T18:40:53.653Z\",\"reply_count\":0,\"reply_to_post_number\":13,\"quote_count\":0,\"incoming_link_count\":3,\"reads\":195,\"readers_count\":194,\"score\":264.0,\"yours\":false,\"topic_id\":396566,\"topic_slug\":\"lets-talk-about-can-delays-and-how-to-address-them\",\"display_username\":\"Austin Schuh\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":1,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"read\":true,\"user_title\":\"\",\"reply_to_user\":{\"id\":13575,\"username\":\"Peter_Johnson\",\"name\":\"Peter Johnson\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/peter_johnson/{size}/10417_2.png\"},\"bookmarked\":false,\"actions_summary\":[{\"id\":2,\"count\":12}],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":4655,\"hidden\":false,\"trust_level\":2,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"user_custom_fields\":{\"user_field_4\":\"\"},\"post_url\":\"/t/lets-talk-about-can-delays-and-how-to-address-them/396566/19\",\"custom_user_title\":null,\"reactions\":[{\"id\":\"heart\",\"type\":\"emoji\",\"count\":12}],\"current_user_reaction\":null,\"reaction_users_count\":12,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":null},{\"id\":2981773,\"name\":\"Allen Nuttle\",\"username\":\"nuttle\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/nuttle/{size}/124105_2.png\",\"created_at\":\"2021-12-15T18:31:41.202Z\",\"cooked\":\"\\u003cp\\u003eSorry for the late reply‚Ä¶\\u003c/p\\u003e\\n\\u003cp\\u003eIt might be worth using a non-CAN encoder to eliminate one source of variability and delay (use SRX Mag Encoder, or one of several other options).  Also, running velocity control and/or some type of motion profiling on each motor controller might be useful, in that it allows the RIO to more directly command what it really cares about (velocity of each motor) and delegates part of the problem to the two motor controllers.  I‚Äôd guess this will be enough to get good results.  At that point, you could try using a CANcoder if you wanted.\\u003c/p\\u003e\\n\\u003cp\\u003eIf things are really hard to manage, it wouldn‚Äôt be hard to source something (not FRC legal) with six MOSFET pairs that could drive two brushless motors.  The main issue would probably be the controller F/W development, but you could run the encoder directly into this and do everything there, with very low latency.  If it turned out this was required, perhaps someone would offer such a controller in the FRC ecosystem ‚Äì but I‚Äôll bet you can get good results without this, particularly with the things you‚Äôve done with the gearing.\\u003c/p\\u003e\",\"post_number\":20,\"post_type\":1,\"posts_count\":21,\"updated_at\":\"2021-12-15T18:31:41.202Z\",\"reply_count\":0,\"reply_to_post_number\":null,\"quote_count\":0,\"incoming_link_count\":2,\"reads\":164,\"readers_count\":163,\"score\":42.8,\"yours\":false,\"topic_id\":396566,\"topic_slug\":\"lets-talk-about-can-delays-and-how-to-address-them\",\"display_username\":\"Allen Nuttle\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":1,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"read\":true,\"user_title\":\"\",\"bookmarked\":false,\"actions_summary\":[],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":14283,\"hidden\":false,\"trust_level\":2,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"user_custom_fields\":{\"user_field_4\":\"\"},\"post_url\":\"/t/lets-talk-about-can-delays-and-how-to-address-them/396566/20\",\"custom_user_title\":null,\"reactions\":[{\"id\":\"-1\",\"type\":\"emoji\",\"count\":1}],\"current_user_reaction\":null,\"reaction_users_count\":1,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":null}],\"stream\":[2971704,2971736,2971740,2971742,2971752,2971759,2971763,2971842,2971843,2971849,2971862,2971863,2971882,2971884,2971885,2971889,2971890,2971891,2972044,2981773,3111019]},\"timeline_lookup\":[[1,1461],[6,1460],[19,1458],[20,1396],[21,1031]],\"tags\":[],\"tags_descriptions\":{},\"fancy_title\":\"Let\\u0026rsquo;s talk about CAN delays (and how to address them?)\",\"id\":396566,\"title\":\"Let's talk about CAN delays (and how to address them?)\",\"posts_count\":21,\"created_at\":\"2021-10-12T13:42:47.036Z\",\"views\":3333,\"reply_count\":13,\"like_count\":36,\"last_posted_at\":\"2022-12-15T18:31:48.314Z\",\"visible\":true,\"closed\":true,\"archived\":false,\"has_summary\":false,\"archetype\":\"regular\",\"slug\":\"lets-talk-about-can-delays-and-how-to-address-them\",\"category_id\":72,\"word_count\":3675,\"deleted_at\":null,\"user_id\":6,\"featured_link\":null,\"pinned_globally\":false,\"pinned_at\":null,\"pinned_until\":null,\"image_url\":null,\"slow_mode_seconds\":0,\"draft\":null,\"draft_key\":\"topic_396566\",\"draft_sequence\":null,\"unpinned\":null,\"pinned\":false,\"current_post_number\":1,\"highest_post_number\":21,\"deleted_by\":null,\"actions_summary\":[{\"id\":4,\"count\":0,\"hidden\":false,\"can_act\":false},{\"id\":8,\"count\":0,\"hidden\":false,\"can_act\":false},{\"id\":10,\"count\":0,\"hidden\":false,\"can_act\":false},{\"id\":7,\"count\":0,\"hidden\":false,\"can_act\":false}],\"chunk_size\":20,\"bookmarked\":false,\"topic_timer\":null,\"message_bus_last_id\":0,\"participant_count\":9,\"show_read_indicator\":false,\"thumbnails\":null,\"slow_mode_enabled_until\":null,\"valid_reactions\":[\"heart\",\"laughing\",\"point_up\",\"+1\",\"-1\",\"100\",\"open_mouth\",\"cry\",\"question\",\"thinking\",\"call_me_hand\",\"hugs\",\"angry\"],\"user_chosen_thumbnail_url\":null,\"sidecar_installed\":true,\"can_vote\":false,\"vote_count\":0,\"user_voted\":false,\"discourse_zendesk_plugin_zendesk_id\":null,\"discourse_zendesk_plugin_zendesk_url\":\"https://your-url.zendesk.com/agent/tickets/\",\"details\":{\"can_edit\":false,\"notification_level\":1,\"participants\":[{\"id\":6,\"username\":\"Joe_Johnson\",\"name\":\"Joe Johnson\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/joe_johnson/{size}/156076_2.png\",\"post_count\":4,\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_color\":null,\"flair_bg_color\":null,\"flair_group_id\":null,\"moderator\":true,\"trust_level\":4},{\"id\":4655,\"username\":\"AustinSchuh\",\"name\":\"Austin Schuh\",\"avatar_template\":\"/letter_avatar_proxy/v4/letter/a/e19b73/{size}.png\",\"post_count\":3,\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_color\":null,\"flair_bg_color\":null,\"flair_group_id\":null,\"trust_level\":2},{\"id\":16115,\"username\":\"CarlosGJ\",\"name\":\"Carlos Gross Jones\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/carlosgj/{size}/131747_2.png\",\"post_count\":3,\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_color\":null,\"flair_bg_color\":null,\"flair_group_id\":null,\"trust_level\":2},{\"id\":16846,\"username\":\"calcmogul\",\"name\":\"Tyler Veness\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/calcmogul/{size}/128045_2.png\",\"post_count\":3,\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_color\":null,\"flair_bg_color\":null,\"flair_group_id\":null,\"trust_level\":2},{\"id\":13575,\"username\":\"Peter_Johnson\",\"name\":\"Peter Johnson\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/peter_johnson/{size}/10417_2.png\",\"post_count\":2,\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_color\":null,\"flair_bg_color\":null,\"flair_group_id\":null,\"trust_level\":2},{\"id\":25373,\"username\":\"Lexeo\",\"name\":\"Lexeo\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/lexeo/{size}/160041_2.png\",\"post_count\":2,\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_color\":null,\"flair_bg_color\":null,\"flair_group_id\":null,\"trust_level\":2},{\"id\":28019,\"username\":\"s-neff\",\"name\":\"s-neff\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/s-neff/{size}/9062_2.png\",\"post_count\":1,\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_color\":null,\"flair_bg_color\":null,\"flair_group_id\":null,\"trust_level\":2},{\"id\":22335,\"username\":\"GeeTwo\",\"name\":\"Gus Michel II\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/geetwo/{size}/120962_2.png\",\"post_count\":1,\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_color\":null,\"flair_bg_color\":null,\"flair_group_id\":null,\"trust_level\":2},{\"id\":14283,\"username\":\"nuttle\",\"name\":\"Allen Nuttle\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/nuttle/{size}/124105_2.png\",\"post_count\":1,\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_color\":null,\"flair_bg_color\":null,\"flair_group_id\":null,\"trust_level\":2}],\"created_by\":{\"id\":6,\"username\":\"Joe_Johnson\",\"name\":\"Joe Johnson\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/joe_johnson/{size}/156076_2.png\"},\"last_poster\":{\"id\":-1,\"username\":\"system\",\"name\":\"system\",\"avatar_template\":\"/uploads/default/original/4X/9/3/2/93234578e69f55873c63fc00fe2d0d85f23bce55.png\"},\"links\":[{\"url\":\"https://file.tavsys.net/control/controls-engineering-in-frc.pdf\",\"title\":null,\"internal\":false,\"attachment\":false,\"reflection\":false,\"clicks\":30,\"user_id\":16846,\"domain\":\"file.tavsys.net\",\"root_domain\":\"tavsys.net\"},{\"url\":\"https://www.chiefdelphi.com/t/dr-joes-diff-swerve/392335\",\"title\":\"Dr Joe's Diff Swerve\",\"internal\":true,\"attachment\":false,\"reflection\":false,\"clicks\":28,\"user_id\":6,\"domain\":\"www.chiefdelphi.com\",\"root_domain\":\"chiefdelphi.com\"},{\"url\":\"https://docs.wpilib.org/en/stable/docs/software/can-devices/can-addressing.html\",\"title\":\"FRC CAN Device Specifications ‚Äî FIRST Robotics Competition documentation\",\"internal\":false,\"attachment\":false,\"reflection\":false,\"clicks\":11,\"user_id\":16115,\"domain\":\"docs.wpilib.org\",\"root_domain\":\"wpilib.org\"},{\"url\":\"https://www.chiefdelphi.com/t/diff-swerve-beta2-the-controls-software-boogaloo/396430\",\"title\":\"Diff Swerve Beta2, The Controls \\u0026 Software Boogaloo\",\"internal\":true,\"attachment\":false,\"reflection\":false,\"clicks\":10,\"user_id\":6,\"domain\":\"www.chiefdelphi.com\",\"root_domain\":\"chiefdelphi.com\"},{\"url\":\"http://carlosgj.org/Lorentz/7870.SW-RDK-BDC24-UG-7243.pdf\",\"title\":null,\"internal\":false,\"attachment\":false,\"reflection\":false,\"clicks\":7,\"user_id\":16115,\"domain\":\"carlosgj.org\",\"root_domain\":\"carlosgj.org\"},{\"url\":\"https://docs.ctre-phoenix.com/en/stable/ch14_MCSensor.html\",\"title\":\"Bring Up: Talon FX/SRX Sensors ‚Äî Phoenix documentation\",\"internal\":false,\"attachment\":false,\"reflection\":false,\"clicks\":4,\"user_id\":16846,\"domain\":\"docs.ctre-phoenix.com\",\"root_domain\":\"ctre-phoenix.com\"},{\"url\":\"https://github.com/calcmogul/controls-engineering-in-frc/tree/main/appendices/linear-quadratic-regulator\",\"title\":null,\"internal\":false,\"attachment\":false,\"reflection\":false,\"clicks\":3,\"user_id\":16846,\"domain\":\"github.com\",\"root_domain\":\"github.com\"},{\"url\":\"https://github.com/wpilibsuite/sysid/\",\"title\":null,\"internal\":false,\"attachment\":false,\"reflection\":false,\"clicks\":3,\"user_id\":16846,\"domain\":\"github.com\",\"root_domain\":\"github.com\"},{\"url\":\"https://en.wikipedia.org/wiki/Robust_control\",\"title\":\"Robust control - Wikipedia\",\"internal\":false,\"attachment\":false,\"reflection\":false,\"clicks\":2,\"user_id\":16846,\"domain\":\"en.wikipedia.org\",\"root_domain\":\"wikipedia.org\"}]},\"bookmarks\":[]}"}
