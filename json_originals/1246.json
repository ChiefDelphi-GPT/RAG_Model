{"data":"{\"post_stream\":{\"posts\":[{\"id\":3531663,\"name\":\"\",\"username\":\"TheBatman\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/thebatman/{size}/255139_2.png\",\"created_at\":\"2025-02-18T17:31:19.540Z\",\"cooked\":\"\\u003cp\\u003eMy team this year is planning to have the robot align to the reef, we are doing this by having a pose estimator (using limelight 2+) and when the driver presses a button it creates an on-the-fly path and runs a pathplanner follow path command.\\u003c/p\\u003e\\n\\u003cpre\\u003e\\u003ccode class=\\\"lang-auto\\\"\\u003epublic Command getAlignRightReef() {\\n    Pose2d curPose = mPoseEstimator.getEstimatedPosition();\\n    Pose2d goalPose = getReefRightPose();\\n    \\n    List\\u0026lt;Waypoint\\u0026gt; waypoints = PathPlannerPath.waypointsFromPoses(\\n        new Pose2d(curPose.getX(), curPose.getY(), Rotation2d.fromDegrees(0)),\\n        new Pose2d(goalPose.getX(), goalPose.getY(), Rotation2d.fromDegrees(0))\\n    );\\n\\n    // The values are low so if anything goes wrong we can disable the robot\\n    PathConstraints constraints = new PathConstraints(0.5, 1, 2 * Math.PI, 4 * Math.PI);\\n\\n    PathPlannerPath alignmentPath = new PathPlannerPath(\\n      waypoints,\\n      constraints,\\n      null,\\n      new GoalEndState(0, goalPose.getRotation())\\n    );\\n\\n    mSwerve.resetOdometry(mPoseEstimator.getEstimatedPosition());\\n    return AutoBuilder.followPath(alignmentPath);\\n}\\n\\u003c/code\\u003e\\u003c/pre\\u003e\\n\\u003cpre\\u003e\\u003ccode class=\\\"lang-auto\\\"\\u003epublic void resetOdometry(Pose2d pose) {\\n    mOdometry.resetPosition(getRotation(), getModulePositions(), pose);\\n}\\n\\u003c/code\\u003e\\u003c/pre\\u003e\\n\\u003cp\\u003eWhen we tested this code we displayed on the shuffleboard the pose returned by the poseEstimator and the calculated goal pose - both of these checked out, we also display the pose that the swerveDriveOdometry returns, but when we run the command the swerve’s odometry returned x=0, y=0 and not the pose that the pose estimator returned.\\u003cbr\\u003e\\nBecause of that the robot started slowly moving towards the goal as if its moving from (0, 0).\\u003c/p\\u003e\\n\\u003cp\\u003eWe are unsure where the problem is and how to fix it, can anyone help?\\u003c/p\\u003e\",\"post_number\":1,\"post_type\":1,\"posts_count\":26,\"updated_at\":\"2025-02-18T17:31:19.540Z\",\"reply_count\":0,\"reply_to_post_number\":null,\"quote_count\":0,\"incoming_link_count\":195,\"reads\":710,\"readers_count\":709,\"score\":1117.0,\"yours\":false,\"topic_id\":492188,\"topic_slug\":\"help-in-reef-alignment\",\"display_username\":\"\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":1,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"read\":true,\"user_title\":null,\"bookmarked\":false,\"actions_summary\":[],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":71857,\"hidden\":false,\"trust_level\":2,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"user_custom_fields\":{\"user_field_4\":\"Vigilante\"},\"post_url\":\"/t/help-in-reef-alignment/492188/1\",\"reactions\":[],\"current_user_reaction\":null,\"reaction_users_count\":0,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":true},{\"id\":3531829,\"name\":\"Martin Nemaric\",\"username\":\"Martini159\",\"avatar_template\":\"/letter_avatar_proxy/v4/letter/m/278dde/{size}.png\",\"created_at\":\"2025-02-18T19:51:38.253Z\",\"cooked\":\"\\u003cp\\u003eHere’s my guess…\\u003c/p\\u003e\\n\\u003cp\\u003eWhen you bind this command to a button, your code actually calls the getAlignRightReef() method. Your estimated pose is likely (0, 0) by default upon robot initialization. Whenever you actually trigger (ie. schedule) this command by pressing a button, it \\u003cem\\u003edoes not\\u003c/em\\u003e actually call the method again to update curPose and goalPose - it just uses whatever curPose and goalPose were when you first called the method during the initial creation of the binding. This would explain why it appears that the command uses (0, 0) as your current pose as opposed to the most up-to-date pose from your pose estimator.\\u003c/p\\u003e\\n\\u003cp\\u003eWhat you need to do is defer the creation of this command to when it is actually \\u003cem\\u003escheduled\\u003c/em\\u003e by using a  \\u003ccode\\u003eDeferredCommand\\u003c/code\\u003e .\\u003c/p\\u003e\\n\\u003cp\\u003eAssuming this command is in your drivetrain subsystem, you could try adding the following to your subsystem, and bind a button to this command instead.\\u003c/p\\u003e\\n\\u003cpre\\u003e\\u003ccode class=\\\"lang-auto\\\"\\u003epublic Command alignToRightReef () {\\n  return new DeferredCommand(\\n    () -\\u0026gt; getAlignRightReef(), \\n    Set.of(this)\\n  );\\n}\\n\\u003c/code\\u003e\\u003c/pre\\u003e\\n\\u003cp\\u003eIf this command is not in the drivetrain subsystem, just change \\u003ccode\\u003ethis\\u003c/code\\u003e to your actual drivetrain subsystem. Give it a shot! Hope this works! \\u003cimg src=\\\"https://www.chiefdelphi.com/images/emoji/google/slight_smile.png?v=12\\\" title=\\\":slight_smile:\\\" class=\\\"emoji\\\" alt=\\\":slight_smile:\\\" loading=\\\"lazy\\\" width=\\\"20\\\" height=\\\"20\\\"\\u003e\\u003c/p\\u003e\\n\\u003cp\\u003eProps to mstatistics from 5892 who helped us with something similar in the following thread…\\u003c/p\\u003e\\n\\u003caside class=\\\"quote quote-modified\\\" data-post=\\\"1\\\" data-topic=\\\"491128\\\"\\u003e\\n  \\u003cdiv class=\\\"title\\\"\\u003e\\n    \\u003cdiv class=\\\"quote-controls\\\"\\u003e\\u003c/div\\u003e\\n    \\u003cimg loading=\\\"lazy\\\" alt=\\\"\\\" width=\\\"24\\\" height=\\\"24\\\" src=\\\"https://www.chiefdelphi.com/letter_avatar_proxy/v4/letter/m/278dde/48.png\\\" class=\\\"avatar\\\"\\u003e\\n    \\u003ca href=\\\"https://www.chiefdelphi.com/t/using-suppliers-with-pathplanner-java-help/491128\\\"\\u003eUsing Suppliers with PathPlanner (Java Help!)\\u003c/a\\u003e \\u003ca class=\\\"badge-category__wrapper \\\" href=\\\"/c/first/general-forum/22\\\"\\u003e\\u003cspan data-category-id=\\\"22\\\" style=\\\"--category-badge-color: #F1592A; --category-badge-text-color: #FFF; --parent-category-badge-color: #F7941D;\\\" data-parent-category-id=\\\"7\\\" data-drop-close=\\\"true\\\" class=\\\"badge-category --has-parent\\\" title=\\\"General FIRST discussion.\\\"\\u003e\\u003cspan class=\\\"badge-category__name\\\"\\u003eGeneral Forum\\u003c/span\\u003e\\u003c/span\\u003e\\u003c/a\\u003e\\n  \\u003c/div\\u003e\\n  \\u003cblockquote\\u003e\\n    This is probably more of a Java question than a PathPlanner specific question, but we have been struggling for an entire week with this, and would really appreciate any help! I am confident we are just doing something very small incorrectly, but we cannot figure out what it is \\u003cimg width=\\\"20\\\" height=\\\"20\\\" src=\\\"https://www.chiefdelphi.com/images/emoji/google/slight_smile.png?v=12\\\" title=\\\"slight_smile\\\" alt=\\\"slight_smile\\\" class=\\\"emoji\\\"\\u003e \\n\\u003ca name=\\\"p-3522974-our-situation-1\\\" class=\\\"anchor\\\" href=\\\"#p-3522974-our-situation-1\\\"\\u003e\\u003c/a\\u003eOur Situation:\\nWe have a Command in our Drivetrain subsystem that accepts a supplier of PathPlannerPaths, and then attempts to feed that into pathfindThenFollowPath: \\npublic Command pathFindThenFollowPath (…\\n  \\u003c/blockquote\\u003e\\n\\u003c/aside\\u003e\\n\",\"post_number\":2,\"post_type\":1,\"posts_count\":26,\"updated_at\":\"2025-02-18T20:07:58.296Z\",\"reply_count\":1,\"reply_to_post_number\":null,\"quote_count\":0,\"incoming_link_count\":9,\"reads\":583,\"readers_count\":582,\"score\":211.6,\"yours\":false,\"topic_id\":492188,\"topic_slug\":\"help-in-reef-alignment\",\"display_username\":\"Martin Nemaric\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":2,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"link_counts\":[{\"url\":\"https://www.chiefdelphi.com/t/using-suppliers-with-pathplanner-java-help/491128\",\"internal\":true,\"reflection\":false,\"title\":\"Using Suppliers with PathPlanner (Java Help!)\",\"clicks\":0}],\"read\":true,\"user_title\":null,\"bookmarked\":false,\"actions_summary\":[{\"id\":2,\"count\":3}],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":56673,\"hidden\":false,\"trust_level\":2,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"post_url\":\"/t/help-in-reef-alignment/492188/2\",\"reactions\":[{\"id\":\"heart\",\"type\":\"emoji\",\"count\":3}],\"current_user_reaction\":null,\"reaction_users_count\":3,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":true,\"topic_accepted_answer\":true},{\"id\":3533151,\"name\":\"\",\"username\":\"TheBatman\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/thebatman/{size}/255139_2.png\",\"created_at\":\"2025-02-19T17:52:51.401Z\",\"cooked\":\"\\u003cp\\u003eThanks alot, we tested it and it solved our problem, thank you \\u003cimg src=\\\"https://www.chiefdelphi.com/images/emoji/google/smiley.png?v=12\\\" title=\\\":smiley:\\\" class=\\\"emoji\\\" alt=\\\":smiley:\\\" loading=\\\"lazy\\\" width=\\\"20\\\" height=\\\"20\\\"\\u003e\\u003c/p\\u003e\",\"post_number\":3,\"post_type\":1,\"posts_count\":26,\"updated_at\":\"2025-02-19T17:52:51.401Z\",\"reply_count\":1,\"reply_to_post_number\":2,\"quote_count\":0,\"incoming_link_count\":1,\"reads\":427,\"readers_count\":426,\"score\":95.4,\"yours\":false,\"topic_id\":492188,\"topic_slug\":\"help-in-reef-alignment\",\"display_username\":\"\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":1,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"read\":true,\"user_title\":null,\"reply_to_user\":{\"id\":56673,\"username\":\"Martini159\",\"name\":\"Martin Nemaric\",\"avatar_template\":\"/letter_avatar_proxy/v4/letter/m/278dde/{size}.png\"},\"bookmarked\":false,\"actions_summary\":[],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":71857,\"hidden\":false,\"trust_level\":2,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"user_custom_fields\":{\"user_field_4\":\"Vigilante\"},\"post_url\":\"/t/help-in-reef-alignment/492188/3\",\"reactions\":[],\"current_user_reaction\":null,\"reaction_users_count\":0,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":true},{\"id\":3533437,\"name\":\"Owen Flanagan\",\"username\":\"OwenF\",\"avatar_template\":\"/letter_avatar_proxy/v4/letter/o/edb3f5/{size}.png\",\"created_at\":\"2025-02-19T20:16:11.887Z\",\"cooked\":\"\\u003cp\\u003eJust out of curiosity how good is your accuracy? We are doing something similar but I haven’t gotten the robot yet to try it out.\\u003c/p\\u003e\",\"post_number\":4,\"post_type\":1,\"posts_count\":26,\"updated_at\":\"2025-02-19T20:16:11.887Z\",\"reply_count\":1,\"reply_to_post_number\":3,\"quote_count\":0,\"incoming_link_count\":0,\"reads\":408,\"readers_count\":407,\"score\":86.6,\"yours\":false,\"topic_id\":492188,\"topic_slug\":\"help-in-reef-alignment\",\"display_username\":\"Owen Flanagan\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":1,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"read\":true,\"user_title\":null,\"reply_to_user\":{\"id\":71857,\"username\":\"TheBatman\",\"name\":\"\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/thebatman/{size}/255139_2.png\"},\"bookmarked\":false,\"actions_summary\":[],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":65469,\"hidden\":false,\"trust_level\":2,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"user_custom_fields\":{\"user_field_4\":\"Code Lead\"},\"post_url\":\"/t/help-in-reef-alignment/492188/4\",\"reactions\":[],\"current_user_reaction\":null,\"reaction_users_count\":0,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":true},{\"id\":3533511,\"name\":\"\",\"username\":\"TheBatman\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/thebatman/{size}/255139_2.png\",\"created_at\":\"2025-02-19T21:32:46.759Z\",\"cooked\":\"\\u003cp\\u003eIt’s pretty accurate (don’t really know the numbers).\\u003cbr\\u003e\\nOur accuracy was good enough that in most cases the width of the coral could compensate for any inaccuracies.\\u003cbr\\u003e\\nThe tests we did were simple and limited so i don’t know how well these results were hold in further testings.\\u003cbr\\u003e\\nAfter we do more tests, I will report here - but it may take a while as we don’t have a field readily available for us.\\u003c/p\\u003e\",\"post_number\":5,\"post_type\":1,\"posts_count\":26,\"updated_at\":\"2025-02-19T21:32:46.759Z\",\"reply_count\":1,\"reply_to_post_number\":4,\"quote_count\":0,\"incoming_link_count\":0,\"reads\":391,\"readers_count\":390,\"score\":83.2,\"yours\":false,\"topic_id\":492188,\"topic_slug\":\"help-in-reef-alignment\",\"display_username\":\"\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":1,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"read\":true,\"user_title\":null,\"reply_to_user\":{\"id\":65469,\"username\":\"OwenF\",\"name\":\"Owen Flanagan\",\"avatar_template\":\"/letter_avatar_proxy/v4/letter/o/edb3f5/{size}.png\"},\"bookmarked\":false,\"actions_summary\":[],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":71857,\"hidden\":false,\"trust_level\":2,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"user_custom_fields\":{\"user_field_4\":\"Vigilante\"},\"post_url\":\"/t/help-in-reef-alignment/492188/5\",\"reactions\":[],\"current_user_reaction\":null,\"reaction_users_count\":0,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":true},{\"id\":3533884,\"name\":\"Owen Flanagan\",\"username\":\"OwenF\",\"avatar_template\":\"/letter_avatar_proxy/v4/letter/o/edb3f5/{size}.png\",\"created_at\":\"2025-02-20T03:35:32.433Z\",\"cooked\":\"\\u003cp\\u003eok tysm\\u003c/p\\u003e\",\"post_number\":6,\"post_type\":1,\"posts_count\":26,\"updated_at\":\"2025-02-20T03:35:32.433Z\",\"reply_count\":0,\"reply_to_post_number\":5,\"quote_count\":0,\"incoming_link_count\":3,\"reads\":346,\"readers_count\":345,\"score\":84.2,\"yours\":false,\"topic_id\":492188,\"topic_slug\":\"help-in-reef-alignment\",\"display_username\":\"Owen Flanagan\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":1,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"read\":true,\"user_title\":null,\"reply_to_user\":{\"id\":71857,\"username\":\"TheBatman\",\"name\":\"\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/thebatman/{size}/255139_2.png\"},\"bookmarked\":false,\"actions_summary\":[],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":65469,\"hidden\":false,\"trust_level\":2,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"user_custom_fields\":{\"user_field_4\":\"Code Lead\"},\"post_url\":\"/t/help-in-reef-alignment/492188/6\",\"reactions\":[],\"current_user_reaction\":null,\"reaction_users_count\":0,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":true},{\"id\":3544191,\"name\":\"\",\"username\":\"RoyalKnight\",\"avatar_template\":\"/letter_avatar_proxy/v4/letter/r/ce7236/{size}.png\",\"created_at\":\"2025-03-01T14:30:23.177Z\",\"cooked\":\"\\u003cp\\u003eHey! We are doing something very similar and ran across the same issue… I appreciate the post! I was wondering if I could ask a question about your code. What value are you pulling from “getReefRightPose()” how are you planning on aligning to the reef? I don’t want a hard code any way points and it seems like you aren’t, how? What’s the logic?\\u003c/p\\u003e\\n\\u003cp\\u003eThanks so much!\\u003c/p\\u003e\",\"post_number\":7,\"post_type\":1,\"posts_count\":26,\"updated_at\":\"2025-03-01T14:30:23.177Z\",\"reply_count\":1,\"reply_to_post_number\":null,\"quote_count\":0,\"incoming_link_count\":4,\"reads\":315,\"readers_count\":314,\"score\":88.0,\"yours\":false,\"topic_id\":492188,\"topic_slug\":\"help-in-reef-alignment\",\"display_username\":\"\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":1,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"read\":true,\"user_title\":null,\"bookmarked\":false,\"actions_summary\":[],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":65426,\"hidden\":false,\"trust_level\":2,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"post_url\":\"/t/help-in-reef-alignment/492188/7\",\"reactions\":[],\"current_user_reaction\":null,\"reaction_users_count\":0,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":true},{\"id\":3544206,\"name\":\"\",\"username\":\"TheBatman\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/thebatman/{size}/255139_2.png\",\"created_at\":\"2025-03-01T15:21:58.694Z\",\"cooked\":\"\\u003cp\\u003eThe getReefRightPose() (and its equivalent for the left side) returns the Pose2d (field relative) of the position we want to reach in-order to align to the reef and score on the right branch of the closest reef side.\\u003c/p\\u003e\\n\\u003cp\\u003eIt calculates the goal pose the following way:\\u003cbr\\u003e\\nIt first gets our current pose estimate and finds the nearest reef april tag to our position - we assume that we want to align to the side that corresponds to that april tag.\\u003cbr\\u003e\\nThan we have saved in our constants an x offset - which means how much back from the april tag we need to be in-order to score, we also have a y offset that means how much to the side of the april tag we must be in-order to score, than we calculate using these offsets the pose to align to, the calculation is as follows:\\u003c/p\\u003e\\n\\u003cpre data-code-wrap=\\\"java\\\"\\u003e\\u003ccode class=\\\"lang-java\\\"\\u003epublic Pose2d getReefRightPose() {\\n    Pose2d robotPose = mPoseEstimator.getEstimatedPosition();\\n    List\\u0026lt;Pose2d\\u0026gt; reefAprilTags = new ArrayList\\u0026lt;Pose2d\\u0026gt;(PoseEstimatorConstants.REEF_APRIL_TAG_POSITIONS.values());\\n    Pose2d reefToAlign = robotPose.nearest(reefAprilTags);\\n\\n    final double xOffset = PoseEstimatorConstants.REEF_X_OFFSET;\\n    final double yOffset = PoseEstimatorConstants.REEF_Y_RIGHT_OFFSET;\\n    final double angleOffset = PoseEstimatorConstants.APRIL_TAG_ANGLE_OFFSET;   // This value is 1.5 Pi\\n\\n    double deltaX = xOffset * Math.sin(reefToAlign.getRotation().getRadians() + angleOffset) + yOffset * Math.cos(reefToAlign.getRotation().getRadians() + angleOffset);\\n    double deltaY = -xOffset * Math.cos(reefToAlign.getRotation().getRadians() + angleOffset) + yOffset * Math.sin(reefToAlign.getRotation().getRadians() + angleOffset);\\n\\n    return new Pose2d(reefToAlign.getX() + deltaX, reefToAlign.getY() + deltaY, reefToAlign.getRotation().plus(Rotation2d.k180deg));\\n}\\n\\u003c/code\\u003e\\u003c/pre\\u003e\\n\\u003cp\\u003eOur plan for aligning with the reef was to have our driver get close enough to the reef so that the limelight can see the april tag than press the button to align.\\u003c/p\\u003e\\n\\u003cp\\u003eIf you plan to calculate your x offset and y offset you can do this by measuring how far your robot’s center should be from the center of the april tag in-order to score, for example our X offset is -0.5m because we must be back 50cm from the april tag and our right y offset is around -0.16 as we need to be 17cm to the right (left is around 0.16 as we need to be 16 cm to the left)\\u003c/p\\u003e\\n\\u003cp\\u003eRegarding \\u003ca class=\\\"mention\\\" href=\\\"/u/owenf\\\"\\u003e@OwenF\\u003c/a\\u003e 's question, it took us a while to find a field where we could test it out, we didn’t have the best results - our drivers reported that “it doesn’t work” - we aren’t sure if it’s because our offsets are incorrect or because pathplanner struggles at generating paths for close distances, we are going to work on it soon and report here with our conclusions - we are considering to switch from on-the-fly path generation to using a HolonomicDriveController.\\u003c/p\\u003e\",\"post_number\":8,\"post_type\":1,\"posts_count\":26,\"updated_at\":\"2025-03-01T15:21:58.694Z\",\"reply_count\":1,\"reply_to_post_number\":7,\"quote_count\":0,\"incoming_link_count\":3,\"reads\":303,\"readers_count\":302,\"score\":95.6,\"yours\":false,\"topic_id\":492188,\"topic_slug\":\"help-in-reef-alignment\",\"display_username\":\"\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":1,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"read\":true,\"user_title\":null,\"reply_to_user\":{\"id\":65426,\"username\":\"RoyalKnight\",\"name\":\"\",\"avatar_template\":\"/letter_avatar_proxy/v4/letter/r/ce7236/{size}.png\"},\"bookmarked\":false,\"actions_summary\":[{\"id\":2,\"count\":1}],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":71857,\"hidden\":false,\"trust_level\":2,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"user_custom_fields\":{\"user_field_4\":\"Vigilante\"},\"post_url\":\"/t/help-in-reef-alignment/492188/8\",\"reactions\":[{\"id\":\"heart\",\"type\":\"emoji\",\"count\":1}],\"current_user_reaction\":null,\"reaction_users_count\":1,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":true},{\"id\":3544508,\"name\":\"\",\"username\":\"RoyalKnight\",\"avatar_template\":\"/letter_avatar_proxy/v4/letter/r/ce7236/{size}.png\",\"created_at\":\"2025-03-02T00:31:53.451Z\",\"cooked\":\"\\u003cp\\u003eAwesome thanks! That helps a lot, yeah we noticed that it didnt work perfectly all the time and definitely not when it was super close but from around 3m away it worked perfectly like 10 times in a row for us for both the left alignment and right alignment after perfecting \\u003cspan class=\\\"abbreviation\\\"\\u003ePID\\u003ctemplate class=\\\"tooltiptext\\\" data-text=\\\"Proportional Integral Derivative\\\"\\u003e\\u003c/template\\u003e\\u003c/span\\u003e tuning! However I am curious, are you going to move away from PathPlanner to use WPIlib PIDController? If you do would you please keep updating this thread! I would love to know if that works out better!\\u003c/p\\u003e\",\"post_number\":9,\"post_type\":1,\"posts_count\":26,\"updated_at\":\"2025-03-02T00:32:56.348Z\",\"reply_count\":0,\"reply_to_post_number\":8,\"quote_count\":0,\"incoming_link_count\":0,\"reads\":236,\"readers_count\":235,\"score\":47.2,\"yours\":false,\"topic_id\":492188,\"topic_slug\":\"help-in-reef-alignment\",\"display_username\":\"\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":2,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"read\":true,\"user_title\":null,\"reply_to_user\":{\"id\":71857,\"username\":\"TheBatman\",\"name\":\"\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/thebatman/{size}/255139_2.png\"},\"bookmarked\":false,\"actions_summary\":[],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":65426,\"hidden\":false,\"trust_level\":2,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"post_url\":\"/t/help-in-reef-alignment/492188/9\",\"reactions\":[],\"current_user_reaction\":null,\"reaction_users_count\":0,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":true},{\"id\":3544581,\"name\":\"Justin Buist\",\"username\":\"Justin_Buist\",\"avatar_template\":\"/letter_avatar_proxy/v4/letter/j/c77e96/{size}.png\",\"created_at\":\"2025-03-02T02:10:33.932Z\",\"cooked\":\"\\u003cp\\u003eFWIW  you can lean on the wpilib datatypes a bit and shorten up the whole ‘left/right’ shift of a tag that’s facing a random rotation and leave the trig buried. Not that I don’t like seeing students write the math out, but if you’re doing this a lot in code, and I suspect we all will be this year:\\u003c/p\\u003e\\n\\u003cp\\u003etag_pose.transformBy(Transform2d(Translation2d(front_back_offset, right_left_offset), Rotation2d(0)))\\u003c/p\\u003e\",\"post_number\":10,\"post_type\":1,\"posts_count\":26,\"updated_at\":\"2025-03-02T02:10:33.932Z\",\"reply_count\":0,\"reply_to_post_number\":null,\"quote_count\":0,\"incoming_link_count\":0,\"reads\":225,\"readers_count\":224,\"score\":60.0,\"yours\":false,\"topic_id\":492188,\"topic_slug\":\"help-in-reef-alignment\",\"display_username\":\"Justin Buist\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":1,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"read\":true,\"user_title\":\"\",\"bookmarked\":false,\"actions_summary\":[{\"id\":2,\"count\":1}],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":24678,\"hidden\":false,\"trust_level\":2,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"post_url\":\"/t/help-in-reef-alignment/492188/10\",\"reactions\":[{\"id\":\"heart\",\"type\":\"emoji\",\"count\":1}],\"current_user_reaction\":null,\"reaction_users_count\":1,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":true},{\"id\":3547564,\"name\":\"\",\"username\":\"TheBatman\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/thebatman/{size}/255139_2.png\",\"created_at\":\"2025-03-04T21:05:31.277Z\",\"cooked\":\"\\u003cp\\u003eWe tested it out with a holonomic drive controller and it worked out well, but we did encounter a problem,\\u003cbr\\u003e\\nIt appears as if we need to apply different offsets based on the side of the reef we are aligning to - for example on ths side pointing to the driver station it works just right, but the wall to the right we need to shift a few centimeters to the left.\\u003cbr\\u003e\\nThis doesnt make sense to us as we think that the offsets should remain the same for all of the sides - does anyone have an idea for this or should we just calculate these offsets for each side of the reef?\\u003c/p\\u003e\",\"post_number\":11,\"post_type\":1,\"posts_count\":26,\"updated_at\":\"2025-03-04T21:05:31.277Z\",\"reply_count\":1,\"reply_to_post_number\":null,\"quote_count\":0,\"incoming_link_count\":0,\"reads\":202,\"readers_count\":201,\"score\":45.4,\"yours\":false,\"topic_id\":492188,\"topic_slug\":\"help-in-reef-alignment\",\"display_username\":\"\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":1,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"read\":true,\"user_title\":null,\"bookmarked\":false,\"actions_summary\":[],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":71857,\"hidden\":false,\"trust_level\":2,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"user_custom_fields\":{\"user_field_4\":\"Vigilante\"},\"post_url\":\"/t/help-in-reef-alignment/492188/11\",\"reactions\":[],\"current_user_reaction\":null,\"reaction_users_count\":0,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":true},{\"id\":3548005,\"name\":\"\",\"username\":\"RoyalKnight\",\"avatar_template\":\"/letter_avatar_proxy/v4/letter/r/ce7236/{size}.png\",\"created_at\":\"2025-03-05T05:18:41.931Z\",\"cooked\":\"\\u003cp\\u003eSo you completely stepped away from path planner and used the wpilib trajectory generator? And I’m not sure about the other issue… Could it be a build issue or have you ruled that out?\\u003c/p\\u003e\",\"post_number\":12,\"post_type\":1,\"posts_count\":26,\"updated_at\":\"2025-03-05T05:18:41.931Z\",\"reply_count\":1,\"reply_to_post_number\":11,\"quote_count\":0,\"incoming_link_count\":0,\"reads\":175,\"readers_count\":174,\"score\":40.0,\"yours\":false,\"topic_id\":492188,\"topic_slug\":\"help-in-reef-alignment\",\"display_username\":\"\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":1,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"read\":true,\"user_title\":null,\"reply_to_user\":{\"id\":71857,\"username\":\"TheBatman\",\"name\":\"\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/thebatman/{size}/255139_2.png\"},\"bookmarked\":false,\"actions_summary\":[],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":65426,\"hidden\":false,\"trust_level\":2,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"post_url\":\"/t/help-in-reef-alignment/492188/12\",\"reactions\":[],\"current_user_reaction\":null,\"reaction_users_count\":0,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":true},{\"id\":3548006,\"name\":\"Ric Ferrell Mentor for 5503 Tiger Trons\",\"username\":\"RicDV\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/ricdv/{size}/188502_2.png\",\"created_at\":\"2025-03-05T05:25:49.280Z\",\"cooked\":\"\\u003cp\\u003e\\u003ca class=\\\"mention\\\" href=\\\"/u/thatonemf5503\\\"\\u003e@thatonemf5503\\u003c/a\\u003e\\u003c/p\\u003e\",\"post_number\":13,\"post_type\":1,\"posts_count\":26,\"updated_at\":\"2025-03-05T05:25:49.280Z\",\"reply_count\":0,\"reply_to_post_number\":null,\"quote_count\":0,\"incoming_link_count\":0,\"reads\":169,\"readers_count\":168,\"score\":33.8,\"yours\":false,\"topic_id\":492188,\"topic_slug\":\"help-in-reef-alignment\",\"display_username\":\"Ric Ferrell Mentor for 5503 Tiger Trons\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":1,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"read\":true,\"user_title\":\"\",\"bookmarked\":false,\"actions_summary\":[],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":48664,\"hidden\":false,\"trust_level\":2,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"user_custom_fields\":{\"user_field_4\":\"Mentor 5503\"},\"post_url\":\"/t/help-in-reef-alignment/492188/13\",\"reactions\":[],\"current_user_reaction\":null,\"reaction_users_count\":0,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":true},{\"id\":3548021,\"name\":\"\",\"username\":\"TheBatman\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/thebatman/{size}/255139_2.png\",\"created_at\":\"2025-03-05T05:56:20.025Z\",\"cooked\":\"\\u003cp\\u003eYou misunderstood us, instead od using pathplanner we are using a plain holonomic drive controller\\u003c/p\\u003e\",\"post_number\":14,\"post_type\":1,\"posts_count\":26,\"updated_at\":\"2025-03-05T05:56:20.025Z\",\"reply_count\":1,\"reply_to_post_number\":12,\"quote_count\":0,\"incoming_link_count\":1,\"reads\":164,\"readers_count\":163,\"score\":42.8,\"yours\":false,\"topic_id\":492188,\"topic_slug\":\"help-in-reef-alignment\",\"display_username\":\"\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":1,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"read\":true,\"user_title\":null,\"reply_to_user\":{\"id\":65426,\"username\":\"RoyalKnight\",\"name\":\"\",\"avatar_template\":\"/letter_avatar_proxy/v4/letter/r/ce7236/{size}.png\"},\"bookmarked\":false,\"actions_summary\":[],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":71857,\"hidden\":false,\"trust_level\":2,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"user_custom_fields\":{\"user_field_4\":\"Vigilante\"},\"post_url\":\"/t/help-in-reef-alignment/492188/14\",\"reactions\":[],\"current_user_reaction\":null,\"reaction_users_count\":0,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":true},{\"id\":3548098,\"name\":\"\",\"username\":\"RoyalKnight\",\"avatar_template\":\"/letter_avatar_proxy/v4/letter/r/ce7236/{size}.png\",\"created_at\":\"2025-03-05T11:26:06.473Z\",\"cooked\":\"\\u003cp\\u003eSorry for asking so many questions but using a holonomic drive controller how do you generate the path it takes? Using this right?\\u003c/p\\u003e\\n\\u003caside class=\\\"onebox allowlistedgeneric\\\" data-onebox-src=\\\"https://docs.wpilib.org/en/stable/docs/software/advanced-controls/trajectories/index.html\\\"\\u003e\\n  \\u003cheader class=\\\"source\\\"\\u003e\\n      \\u003cimg src=\\\"https://docs.wpilib.org/en/stable/_static/FIRSTicon_RGB_withTM.ico\\\" class=\\\"site-icon\\\" width=\\\"64\\\" height=\\\"64\\\"\\u003e\\n\\n      \\u003ca href=\\\"https://docs.wpilib.org/en/stable/docs/software/advanced-controls/trajectories/index.html\\\" target=\\\"_blank\\\" rel=\\\"noopener nofollow ugc\\\"\\u003eFIRST Robotics Competition Documentation\\u003c/a\\u003e\\n  \\u003c/header\\u003e\\n\\n  \\u003carticle class=\\\"onebox-body\\\"\\u003e\\n    \\u003cimg width=\\\"256\\\" height=\\\"256\\\" src=\\\"https://raw.githubusercontent.com/wpilibsuite/branding/main/export/png/wpilib-icon-256.png\\\" class=\\\"thumbnail onebox-avatar\\\"\\u003e\\n\\n\\u003ch3\\u003e\\u003ca href=\\\"https://docs.wpilib.org/en/stable/docs/software/advanced-controls/trajectories/index.html\\\" target=\\\"_blank\\\" rel=\\\"noopener nofollow ugc\\\"\\u003eTrajectory Generation and Following with WPILib\\u003c/a\\u003e\\u003c/h3\\u003e\\n\\n  \\u003cp\\u003eThis section describes WPILib support for generating parameterized spline trajectories and following those trajectories with typical FRC ® robot drives. Trajectory Generation, Trajectory Constraint...\\u003c/p\\u003e\\n\\n\\n  \\u003c/article\\u003e\\n\\n  \\u003cdiv class=\\\"onebox-metadata\\\"\\u003e\\n    \\n    \\n  \\u003c/div\\u003e\\n\\n  \\u003cdiv style=\\\"clear: both\\\"\\u003e\\u003c/div\\u003e\\n\\u003c/aside\\u003e\\n\",\"post_number\":15,\"post_type\":1,\"posts_count\":26,\"updated_at\":\"2025-03-05T11:26:06.473Z\",\"reply_count\":2,\"reply_to_post_number\":14,\"quote_count\":0,\"incoming_link_count\":0,\"reads\":160,\"readers_count\":159,\"score\":42.0,\"yours\":false,\"topic_id\":492188,\"topic_slug\":\"help-in-reef-alignment\",\"display_username\":\"\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":1,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"link_counts\":[{\"url\":\"https://docs.wpilib.org/en/stable/docs/software/advanced-controls/trajectories/index.html\",\"internal\":false,\"reflection\":false,\"title\":\"Trajectory Generation and Following with WPILib — FIRST Robotics Competition documentation\",\"clicks\":7}],\"read\":true,\"user_title\":null,\"reply_to_user\":{\"id\":71857,\"username\":\"TheBatman\",\"name\":\"\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/thebatman/{size}/255139_2.png\"},\"bookmarked\":false,\"actions_summary\":[],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":65426,\"hidden\":false,\"trust_level\":2,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"post_url\":\"/t/help-in-reef-alignment/492188/15\",\"reactions\":[],\"current_user_reaction\":null,\"reaction_users_count\":0,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":true},{\"id\":3548106,\"name\":\"\",\"username\":\"TheBatman\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/thebatman/{size}/255139_2.png\",\"created_at\":\"2025-03-05T12:05:04.266Z\",\"cooked\":\"\\u003cp\\u003eNo, we just calculate the pose goal and then what we do is in a command in the execute part:\\u003c/p\\u003e\\n\\u003cpre\\u003e\\u003ccode class=\\\"lang-auto\\\"\\u003e    ChassisSpeeds speeds = mDriveController.calculate(mPoseEstimator.getPose(), mGoal, 0, mGoal.getRotation());\\n    mSwerve.setModuleStates(SwerveSubsystemConstants.DRIVE_KINEMATICS.toSwerveModuleStates(speeds));\\n\\u003c/code\\u003e\\u003c/pre\\u003e\",\"post_number\":16,\"post_type\":1,\"posts_count\":26,\"updated_at\":\"2025-03-05T12:05:04.266Z\",\"reply_count\":2,\"reply_to_post_number\":15,\"quote_count\":0,\"incoming_link_count\":1,\"reads\":156,\"readers_count\":155,\"score\":46.2,\"yours\":false,\"topic_id\":492188,\"topic_slug\":\"help-in-reef-alignment\",\"display_username\":\"\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":1,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"read\":true,\"user_title\":null,\"reply_to_user\":{\"id\":65426,\"username\":\"RoyalKnight\",\"name\":\"\",\"avatar_template\":\"/letter_avatar_proxy/v4/letter/r/ce7236/{size}.png\"},\"bookmarked\":false,\"actions_summary\":[],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":71857,\"hidden\":false,\"trust_level\":2,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"user_custom_fields\":{\"user_field_4\":\"Vigilante\"},\"post_url\":\"/t/help-in-reef-alignment/492188/16\",\"reactions\":[],\"current_user_reaction\":null,\"reaction_users_count\":0,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":true},{\"id\":3548107,\"name\":\"\",\"username\":\"TheBatman\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/thebatman/{size}/255139_2.png\",\"created_at\":\"2025-03-05T12:19:19.063Z\",\"cooked\":\"\\u003cp\\u003eDoes anyone know if it makes sense that we have different offsets (i.e. different values for translation2d) for different sides of the reef.\\u003cbr\\u003e\\nBecause based on testing it looks as if we do need different offsets but it doesn’t really make any sense to us - so we are unsure if we should calculate these offsets for each side of the reef or if there is a somewhere a problem in our logic.\\u003c/p\\u003e\",\"post_number\":17,\"post_type\":1,\"posts_count\":26,\"updated_at\":\"2025-03-05T12:19:19.063Z\",\"reply_count\":1,\"reply_to_post_number\":null,\"quote_count\":0,\"incoming_link_count\":0,\"reads\":155,\"readers_count\":154,\"score\":36.0,\"yours\":false,\"topic_id\":492188,\"topic_slug\":\"help-in-reef-alignment\",\"display_username\":\"\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":1,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"read\":true,\"user_title\":null,\"bookmarked\":false,\"actions_summary\":[],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":71857,\"hidden\":false,\"trust_level\":2,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"user_custom_fields\":{\"user_field_4\":\"Vigilante\"},\"post_url\":\"/t/help-in-reef-alignment/492188/17\",\"reactions\":[],\"current_user_reaction\":null,\"reaction_users_count\":0,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":true},{\"id\":3548691,\"name\":\"\",\"username\":\"TheBatman\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/thebatman/{size}/255139_2.png\",\"created_at\":\"2025-03-05T21:48:57.456Z\",\"cooked\":\"\\u003cp\\u003eWe had some weird problems with calculating our poses for alignment - we are unsure where the problem originates so we are considering just calculating all 24 poses and saving them in the constants.\\u003cbr\\u003e\\nDoes anyone have any advice for managing/saving these many poses?\\u003c/p\\u003e\",\"post_number\":18,\"post_type\":1,\"posts_count\":26,\"updated_at\":\"2025-03-05T21:48:57.456Z\",\"reply_count\":0,\"reply_to_post_number\":null,\"quote_count\":0,\"incoming_link_count\":3,\"reads\":133,\"readers_count\":132,\"score\":41.6,\"yours\":false,\"topic_id\":492188,\"topic_slug\":\"help-in-reef-alignment\",\"display_username\":\"\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":1,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"read\":true,\"user_title\":null,\"bookmarked\":false,\"actions_summary\":[],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":71857,\"hidden\":false,\"trust_level\":2,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"user_custom_fields\":{\"user_field_4\":\"Vigilante\"},\"post_url\":\"/t/help-in-reef-alignment/492188/18\",\"reactions\":[],\"current_user_reaction\":null,\"reaction_users_count\":0,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":true},{\"id\":3548856,\"name\":\"\",\"username\":\"RoyalKnight\",\"avatar_template\":\"/letter_avatar_proxy/v4/letter/r/ce7236/{size}.png\",\"created_at\":\"2025-03-06T01:45:24.520Z\",\"cooked\":\"\\u003cp\\u003eTHIS WORKED SO WELL THANKS! However we did run into one issue… The first time the robot sees the tag the way it moves is super weird and then the second time it moves straight like how it’s expected. I’ve attached a video as example - did you run into this? How did you solve it?\\u003c/p\\u003e\\n          \\u003caside class=\\\"onebox google-photos\\\"\\u003e\\n            \\u003cheader class=\\\"source\\\"\\u003e\\n              \\u003cimg src=\\\"https://www.gstatic.com/social/photosui/images/logo/1x/photos_512dp.png\\\" class=\\\"site-icon\\\" width=\\\"16\\\" height=\\\"16\\\"\\u003e\\n              \\u003ca href=\\\"https://photos.app.goo.gl/W1AuQYrUdo8JEVpCA\\\" target=\\\"_blank\\\" rel=\\\"noopener nofollow ugc\\\"\\u003eGoogle Photos\\u003c/a\\u003e\\n            \\u003c/header\\u003e\\n            \\u003carticle class=\\\"onebox-body\\\"\\u003e\\n              \\u003ch3\\u003e\\u003ca href=\\\"https://photos.app.goo.gl/W1AuQYrUdo8JEVpCA\\\" target=\\\"_blank\\\" rel=\\\"noopener nofollow ugc\\\"\\u003eNew video by Drumz \\u0026amp; Stringz\\u003c/a\\u003e\\u003c/h3\\u003e\\n              \\u003cdiv class=\\\"aspect-image-full-size\\\"\\u003e\\n                \\u003ca href=\\\"https://photos.app.goo.gl/W1AuQYrUdo8JEVpCA\\\" target=\\\"_blank\\\" rel=\\\"noopener nofollow ugc\\\" class=\\\"image-wrapper\\\"\\u003e\\n                  \\u003cimg src=\\\"https://lh3.googleusercontent.com/pw/AP1GczMdVzoZ2Xk0mYdJckjCENlMdVFnT7Wl8dHQz1hsbHJUXyz9MTwRcDi5yFpbpJA_hsZkmBDgfQcsqKvioquz9SFL6_djzHQgNlp3-Cq6BWNAgTfL5mVv=w600-h315-p-k-no\\\" class=\\\"scale-image\\\" width=\\\"600\\\" height=\\\"315\\\"\\u003e\\n                  \\u003cspan class=\\\"video-icon\\\"\\u003e\\u003c/span\\u003e\\n                \\u003c/a\\u003e\\n              \\u003c/div\\u003e\\n            \\u003c/article\\u003e\\n          \\u003c/aside\\u003e\\n\",\"post_number\":19,\"post_type\":1,\"posts_count\":26,\"updated_at\":\"2025-03-06T01:45:24.520Z\",\"reply_count\":1,\"reply_to_post_number\":16,\"quote_count\":0,\"incoming_link_count\":1,\"reads\":128,\"readers_count\":127,\"score\":35.6,\"yours\":false,\"topic_id\":492188,\"topic_slug\":\"help-in-reef-alignment\",\"display_username\":\"\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":1,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"read\":true,\"user_title\":null,\"reply_to_user\":{\"id\":71857,\"username\":\"TheBatman\",\"name\":\"\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/thebatman/{size}/255139_2.png\"},\"bookmarked\":false,\"actions_summary\":[],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":65426,\"hidden\":false,\"trust_level\":2,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"post_url\":\"/t/help-in-reef-alignment/492188/19\",\"reactions\":[],\"current_user_reaction\":null,\"reaction_users_count\":0,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":true},{\"id\":3548885,\"name\":\"Justin Buist\",\"username\":\"Justin_Buist\",\"avatar_template\":\"/letter_avatar_proxy/v4/letter/j/c77e96/{size}.png\",\"created_at\":\"2025-03-06T02:08:37.322Z\",\"cooked\":\"\\u003cp\\u003eThe offsets for right/left should be the same. The reef poles are the same distance from the center of the AprilTags. I’ve written code to ‘place’ corals in the field’s 3D space within AdvantageScope and the calculations are all the same in relation to the tag.\\u003c/p\\u003e\\n\\u003cp\\u003eThe real questions are:\\u003c/p\\u003e\\n\\u003cul\\u003e\\n\\u003cli\\u003eHow accurate is your practice field?\\u003c/li\\u003e\\n\\u003cli\\u003eWhere did the robot think it was vs where was it actually? This applies not only to x/y placement of the structures but also the Apriltags. If they’re all just a bit off (it happens, and will happen on real fields) your pose might not be perfectly correct.\\u003c/li\\u003e\\n\\u003c/ul\\u003e\\n\\u003cp\\u003eI like to use AdvantageScope to debug that stuff. Toss a pose out there for where the robot thinks it is along with one for each estimate you’re getting from vision. Then you can see how they get fused into a master pose and where that is.\\u003c/p\\u003e\",\"post_number\":20,\"post_type\":1,\"posts_count\":26,\"updated_at\":\"2025-03-06T02:08:37.322Z\",\"reply_count\":1,\"reply_to_post_number\":17,\"quote_count\":0,\"incoming_link_count\":2,\"reads\":127,\"readers_count\":126,\"score\":55.4,\"yours\":false,\"topic_id\":492188,\"topic_slug\":\"help-in-reef-alignment\",\"display_username\":\"Justin Buist\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":1,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"read\":true,\"user_title\":\"\",\"reply_to_user\":{\"id\":71857,\"username\":\"TheBatman\",\"name\":\"\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/thebatman/{size}/255139_2.png\"},\"bookmarked\":false,\"actions_summary\":[{\"id\":2,\"count\":1}],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":24678,\"hidden\":false,\"trust_level\":2,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"post_url\":\"/t/help-in-reef-alignment/492188/20\",\"reactions\":[{\"id\":\"heart\",\"type\":\"emoji\",\"count\":1}],\"current_user_reaction\":null,\"reaction_users_count\":1,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":true}],\"stream\":[3531663,3531829,3533151,3533437,3533511,3533884,3544191,3544206,3544508,3544581,3547564,3548005,3548006,3548021,3548098,3548106,3548107,3548691,3548856,3548885,3550326,3550754,3551105,3551142,3551146,3559129]},\"timeline_lookup\":[[1,166],[3,165],[7,155],[11,152],[15,151],[21,149],[23,148],[26,139]],\"tags\":[],\"tags_descriptions\":{},\"id\":492188,\"title\":\"Help in reef alignment\",\"fancy_title\":\"Help in reef alignment\",\"posts_count\":26,\"created_at\":\"2025-02-18T17:31:19.405Z\",\"views\":2033,\"reply_count\":18,\"like_count\":6,\"last_posted_at\":\"2025-03-17T12:40:12.747Z\",\"visible\":true,\"closed\":false,\"archived\":false,\"has_summary\":false,\"archetype\":\"regular\",\"slug\":\"help-in-reef-alignment\",\"category_id\":30,\"word_count\":2205,\"deleted_at\":null,\"user_id\":71857,\"featured_link\":null,\"pinned_globally\":false,\"pinned_at\":null,\"pinned_until\":null,\"image_url\":null,\"slow_mode_seconds\":0,\"draft\":null,\"draft_key\":\"topic_492188\",\"draft_sequence\":null,\"unpinned\":null,\"pinned\":false,\"current_post_number\":1,\"highest_post_number\":26,\"deleted_by\":null,\"actions_summary\":[{\"id\":4,\"count\":0,\"hidden\":false,\"can_act\":false},{\"id\":8,\"count\":0,\"hidden\":false,\"can_act\":false},{\"id\":10,\"count\":0,\"hidden\":false,\"can_act\":false},{\"id\":7,\"count\":0,\"hidden\":false,\"can_act\":false}],\"chunk_size\":20,\"bookmarked\":false,\"topic_timer\":{\"id\":44198,\"execute_at\":\"2026-03-17T12:40:12.747Z\",\"duration_minutes\":525600,\"based_on_last_post\":true,\"status_type\":\"close\",\"category_id\":null},\"message_bus_last_id\":0,\"participant_count\":7,\"show_read_indicator\":false,\"thumbnails\":null,\"slow_mode_enabled_until\":null,\"valid_reactions\":[\"heart\",\"laughing\",\"point_up\",\"+1\",\"-1\",\"100\",\"open_mouth\",\"cry\",\"question\",\"thinking\",\"call_me_hand\",\"hugs\",\"angry\"],\"accepted_answer\":{\"post_number\":2,\"username\":\"Martini159\",\"name\":null,\"excerpt\":\"Here’s my guess… \\nWhen you bind this command to a button, your code actually calls the getAlignRightReef() method. Your estimated pose is likely (0, 0) by default upon robot initialization. Whenever you actually trigger (ie. schedule) this command by pressing a button, it does not actually call the \\u0026hellip;\",\"accepter_name\":null},\"user_chosen_thumbnail_url\":null,\"sidecar_installed\":true,\"details\":{\"can_edit\":false,\"notification_level\":1,\"participants\":[{\"id\":71857,\"username\":\"TheBatman\",\"name\":\"\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/thebatman/{size}/255139_2.png\",\"post_count\":12,\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_color\":null,\"flair_bg_color\":null,\"flair_group_id\":null,\"trust_level\":2},{\"id\":65426,\"username\":\"RoyalKnight\",\"name\":\"\",\"avatar_template\":\"/letter_avatar_proxy/v4/letter/r/ce7236/{size}.png\",\"post_count\":7,\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_color\":null,\"flair_bg_color\":null,\"flair_group_id\":null,\"trust_level\":2},{\"id\":65469,\"username\":\"OwenF\",\"name\":\"Owen Flanagan\",\"avatar_template\":\"/letter_avatar_proxy/v4/letter/o/edb3f5/{size}.png\",\"post_count\":2,\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_color\":null,\"flair_bg_color\":null,\"flair_group_id\":null,\"trust_level\":2},{\"id\":24678,\"username\":\"Justin_Buist\",\"name\":\"Justin Buist\",\"avatar_template\":\"/letter_avatar_proxy/v4/letter/j/c77e96/{size}.png\",\"post_count\":2,\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_color\":null,\"flair_bg_color\":null,\"flair_group_id\":null,\"trust_level\":2},{\"id\":57183,\"username\":\"Xolverr\",\"name\":\"Nathan Manhardt\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/xolverr/{size}/211198_2.png\",\"post_count\":1,\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_color\":null,\"flair_bg_color\":null,\"flair_group_id\":null,\"trust_level\":2},{\"id\":48664,\"username\":\"RicDV\",\"name\":\"Ric Ferrell Mentor for 5503 Tiger Trons\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/ricdv/{size}/188502_2.png\",\"post_count\":1,\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_color\":null,\"flair_bg_color\":null,\"flair_group_id\":null,\"trust_level\":2},{\"id\":56673,\"username\":\"Martini159\",\"name\":\"Martin Nemaric\",\"avatar_template\":\"/letter_avatar_proxy/v4/letter/m/278dde/{size}.png\",\"post_count\":1,\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_color\":null,\"flair_bg_color\":null,\"flair_group_id\":null,\"trust_level\":2}],\"created_by\":{\"id\":71857,\"username\":\"TheBatman\",\"name\":\"\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/thebatman/{size}/255139_2.png\"},\"last_poster\":{\"id\":57183,\"username\":\"Xolverr\",\"name\":\"Nathan Manhardt\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/xolverr/{size}/211198_2.png\"},\"links\":[{\"url\":\"https://docs.wpilib.org/en/stable/docs/software/advanced-controls/trajectories/index.html\",\"title\":\"Trajectory Generation and Following with WPILib — FIRST Robotics Competition documentation\",\"internal\":false,\"attachment\":false,\"reflection\":false,\"clicks\":7,\"user_id\":65426,\"domain\":\"docs.wpilib.org\",\"root_domain\":\"wpilib.org\"}]},\"bookmarks\":[]}"}
