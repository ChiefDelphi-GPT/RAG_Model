{"data":"{\"post_stream\":{\"posts\":[{\"id\":3428658,\"name\":\"Alex Tsekhansky\",\"username\":\"atsekhan\",\"avatar_template\":\"/letter_avatar_proxy/v4/letter/a/0ea827/{size}.png\",\"created_at\":\"2024-09-28T16:09:46.308Z\",\"cooked\":\"\\u003cp\\u003eWe’re trying to perfect the turn-to-angle for our swerve drive. The swerve is fully CTR-based (falcons + cancoders+Pigeon2), and has a Pro license in case we need to pull sensors more often.\\u003c/p\\u003e\\n\\u003cp\\u003eWe would like to be able to implement the precise turn-to-angle from a stopped position with tolerance of half-degree.\\u003c/p\\u003e\\n\\u003cp\\u003eRight now we’re trying to use the profilePIDController with trapezoid profile. However,  we could greatly benefit on advice of handling static friction. So, the turn essentially is done as a call to a\\\"drive\\\" method that works with SwerveChassis class (meaning - we do not operate with wheel motors directly - maybe that’s a mistake and we should?)\\u003c/p\\u003e\\n\\u003cp\\u003eWe essentially use equivalent of joystick inputs to move the robot (meaning - the \\u003cspan class=\\\"abbreviation\\\"\\u003ePID\\u003ctemplate class=\\\"tooltiptext\\\" data-text=\\\"Proportional Integral Derivative\\\"\\u003e\\u003c/template\\u003e\\u003c/span\\u003e really generates that, we translate that into velocities based on the max angular velocity and assuming that dependency on joystick vs velocity is linear). So, we also also that a joystick input that starts robot moving is 0.02. However, to keep it going it needs to be above 0.015. So, we ping IMU every cycle and recalculate the necessary input in a profile based on that. I do not really think this is the best way to do it. And so I’d like some input from the community.\\u003c/p\\u003e\\n\\u003cp\\u003eAnother way would be, for instance, is to calculate how much the wheels need to turn, and do a Position \\u003cspan class=\\\"abbreviation\\\"\\u003ePID\\u003ctemplate class=\\\"tooltiptext\\\" data-text=\\\"Proportional Integral Derivative\\\"\\u003e\\u003c/template\\u003e\\u003c/span\\u003e on the wheel motors once they’re turned to the right angle. The idea is that the length of the motion is fairly small (e.g. angles to turn will generally be 30 degrees or less; any bigger ones can be done with the trajectory controller, like PathPlanner, but for in-place turns its error is often around 3 degrees). So, we’re trying to really adjust the turns of, say 5 degree clockwise.\\u003cbr\\u003e\\nWe found those to be important with precision shooting at a distance. Our cameras, when combined, can get us pretty reliable angular and fairly reliable linear positions.\\u003c/p\\u003e\",\"post_number\":1,\"post_type\":1,\"posts_count\":34,\"updated_at\":\"2024-09-28T16:09:46.308Z\",\"reply_count\":1,\"reply_to_post_number\":null,\"quote_count\":0,\"incoming_link_count\":46,\"reads\":378,\"readers_count\":377,\"score\":310.6,\"yours\":false,\"topic_id\":472069,\"topic_slug\":\"best-pid-profile-for-in-place-turns\",\"display_username\":\"Alex Tsekhansky\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":1,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"read\":true,\"user_title\":null,\"bookmarked\":false,\"actions_summary\":[],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":50762,\"hidden\":false,\"trust_level\":2,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"post_url\":\"/t/best-pid-profile-for-in-place-turns/472069/1\",\"custom_user_title\":null,\"reactions\":[],\"current_user_reaction\":null,\"reaction_users_count\":0,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":null,\"can_vote\":false},{\"id\":3428662,\"name\":\"viggy96\",\"username\":\"viggy96\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/viggy96/{size}/252784_2.png\",\"created_at\":\"2024-09-28T16:35:50.702Z\",\"cooked\":\"\\u003cp\\u003eWe use a profiled \\u003cspan class=\\\"abbreviation\\\"\\u003ePID\\u003ctemplate class=\\\"tooltiptext\\\" data-text=\\\"Proportional Integral Derivative\\\"\\u003e\\u003c/template\\u003e\\u003c/span\\u003e controller as well, using yaw angle as the input, and omega radians per second (from the chassis speeds object) as the output. In fact, we’re always running \\u003cspan class=\\\"abbreviation\\\"\\u003ePID\\u003ctemplate class=\\\"tooltiptext\\\" data-text=\\\"Proportional Integral Derivative\\\"\\u003e\\u003c/template\\u003e\\u003c/span\\u003e on our rotation, and our rotation stick just adjusts the setpoint. Though that \\u003cspan class=\\\"abbreviation\\\"\\u003ePID\\u003ctemplate class=\\\"tooltiptext\\\" data-text=\\\"Proportional Integral Derivative\\\"\\u003e\\u003c/template\\u003e\\u003c/span\\u003e loop isn’t profiled, but our aiming ones are.\\u003c/p\\u003e\",\"post_number\":2,\"post_type\":1,\"posts_count\":34,\"updated_at\":\"2024-09-28T16:35:50.702Z\",\"reply_count\":1,\"reply_to_post_number\":null,\"quote_count\":0,\"incoming_link_count\":2,\"reads\":329,\"readers_count\":328,\"score\":80.8,\"yours\":false,\"topic_id\":472069,\"topic_slug\":\"best-pid-profile-for-in-place-turns\",\"display_username\":\"viggy96\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":1,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"read\":true,\"user_title\":\"\",\"bookmarked\":false,\"actions_summary\":[],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":24613,\"hidden\":false,\"trust_level\":2,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"user_custom_fields\":{\"user_field_4\":\"418 Mentor | Tries to be smart\"},\"post_url\":\"/t/best-pid-profile-for-in-place-turns/472069/2\",\"custom_user_title\":\"418 Mentor | Tries to be smart\",\"reactions\":[],\"current_user_reaction\":null,\"reaction_users_count\":0,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":null},{\"id\":3428679,\"name\":\"Alex Tsekhansky\",\"username\":\"atsekhan\",\"avatar_template\":\"/letter_avatar_proxy/v4/letter/a/0ea827/{size}.png\",\"created_at\":\"2024-09-28T17:17:14.109Z\",\"cooked\":\"\\u003cp\\u003eCould you provide a reference to a code, please?\\u003c/p\\u003e\\n\\u003cp\\u003eWe actually did run quasistatic SysId loop on the turns based on the joystick input. Do not know how good the \\u003cspan class=\\\"abbreviation\\\"\\u003ePID\\u003ctemplate class=\\\"tooltiptext\\\" data-text=\\\"Proportional Integral Derivative\\\"\\u003e\\u003c/template\\u003e\\u003c/span\\u003e constants are that are determined that way, but we will try.\\u003c/p\\u003e\",\"post_number\":3,\"post_type\":1,\"posts_count\":34,\"updated_at\":\"2024-09-28T17:17:14.109Z\",\"reply_count\":1,\"reply_to_post_number\":2,\"quote_count\":0,\"incoming_link_count\":0,\"reads\":318,\"readers_count\":317,\"score\":68.6,\"yours\":false,\"topic_id\":472069,\"topic_slug\":\"best-pid-profile-for-in-place-turns\",\"display_username\":\"Alex Tsekhansky\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":1,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"read\":true,\"user_title\":null,\"reply_to_user\":{\"id\":24613,\"username\":\"viggy96\",\"name\":\"viggy96\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/viggy96/{size}/252784_2.png\"},\"bookmarked\":false,\"actions_summary\":[],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":50762,\"hidden\":false,\"trust_level\":2,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"post_url\":\"/t/best-pid-profile-for-in-place-turns/472069/3\",\"custom_user_title\":null,\"reactions\":[],\"current_user_reaction\":null,\"reaction_users_count\":0,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":null},{\"id\":3428682,\"name\":\"viggy96\",\"username\":\"viggy96\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/viggy96/{size}/252784_2.png\",\"created_at\":\"2024-09-28T17:32:14.168Z\",\"cooked\":\"\\u003cp\\u003eWe’re not actually running any feed forward for that \\u003cspan class=\\\"abbreviation\\\"\\u003ePID\\u003ctemplate class=\\\"tooltiptext\\\" data-text=\\\"Proportional Integral Derivative\\\"\\u003e\\u003c/template\\u003e\\u003c/span\\u003e.\\u003c/p\\u003e\\n\\u003caside class=\\\"onebox githubrepo\\\" data-onebox-src=\\\"https://github.com/lasarobotics/PH2024\\\"\\u003e\\n  \\u003cheader class=\\\"source\\\"\\u003e\\n\\n      \\u003ca href=\\\"https://github.com/lasarobotics/PH2024\\\" target=\\\"_blank\\\" rel=\\\"noopener nofollow ugc\\\"\\u003egithub.com\\u003c/a\\u003e\\n  \\u003c/header\\u003e\\n\\n  \\u003carticle class=\\\"onebox-body\\\"\\u003e\\n    \\u003cdiv class=\\\"github-row\\\" data-github-private-repo=\\\"false\\\"\\u003e\\n  \\u003cimg width=\\\"690\\\" height=\\\"344\\\" src=\\\"https://opengraph.githubassets.com/3b01950a0643059397d8413cc972e845/lasarobotics/PH2024\\\" class=\\\"thumbnail\\\"\\u003e\\n\\n  \\u003ch3\\u003e\\u003ca href=\\\"https://github.com/lasarobotics/PH2024\\\" target=\\\"_blank\\\" rel=\\\"noopener nofollow ugc\\\"\\u003eGitHub - lasarobotics/PH2024: 2024 Purple Haze FRC\\u003c/a\\u003e\\u003c/h3\\u003e\\n\\n    \\u003cp\\u003e\\u003cspan class=\\\"github-repo-description\\\"\\u003e2024 Purple Haze FRC\\u003c/span\\u003e\\u003c/p\\u003e\\n\\u003c/div\\u003e\\n\\n  \\u003c/article\\u003e\\n\\n  \\u003cdiv class=\\\"onebox-metadata\\\"\\u003e\\n    \\n    \\n  \\u003c/div\\u003e\\n\\n  \\u003cdiv style=\\\"clear: both\\\"\\u003e\\u003c/div\\u003e\\n\\u003c/aside\\u003e\\n\",\"post_number\":4,\"post_type\":1,\"posts_count\":34,\"updated_at\":\"2024-09-28T17:32:14.168Z\",\"reply_count\":1,\"reply_to_post_number\":3,\"quote_count\":0,\"incoming_link_count\":0,\"reads\":298,\"readers_count\":297,\"score\":79.6,\"yours\":false,\"topic_id\":472069,\"topic_slug\":\"best-pid-profile-for-in-place-turns\",\"display_username\":\"viggy96\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":1,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"link_counts\":[{\"url\":\"https://github.com/lasarobotics/PH2024\",\"internal\":false,\"reflection\":false,\"title\":\"GitHub - lasarobotics/PH2024: 2024 Purple Haze FRC\",\"clicks\":14}],\"read\":true,\"user_title\":\"\",\"reply_to_user\":{\"id\":50762,\"username\":\"atsekhan\",\"name\":\"Alex Tsekhansky\",\"avatar_template\":\"/letter_avatar_proxy/v4/letter/a/0ea827/{size}.png\"},\"bookmarked\":false,\"actions_summary\":[{\"id\":2,\"count\":1}],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":24613,\"hidden\":false,\"trust_level\":2,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"user_custom_fields\":{\"user_field_4\":\"418 Mentor | Tries to be smart\"},\"post_url\":\"/t/best-pid-profile-for-in-place-turns/472069/4\",\"custom_user_title\":\"418 Mentor | Tries to be smart\",\"reactions\":[{\"id\":\"heart\",\"type\":\"emoji\",\"count\":1}],\"current_user_reaction\":null,\"reaction_users_count\":1,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":null},{\"id\":3428691,\"name\":\"Alex Tsekhansky\",\"username\":\"atsekhan\",\"avatar_template\":\"/letter_avatar_proxy/v4/letter/a/0ea827/{size}.png\",\"created_at\":\"2024-09-28T18:10:15.090Z\",\"cooked\":\"\\u003cp\\u003eThanks! So, as far as I could see, the aimAtAngle method is it, correct?\\u003c/p\\u003e\\n\\u003caside class=\\\"onebox githubblob\\\" data-onebox-src=\\\"https://github.com/lasarobotics/PH2024/blob/24e0d98e8d80e3ff622deb30bc7d4698abcc7f74/src/main/java/frc/robot/subsystems/drive/DriveSubsystem.java#L750\\\"\\u003e\\n  \\u003cheader class=\\\"source\\\"\\u003e\\n\\n      \\u003ca href=\\\"https://github.com/lasarobotics/PH2024/blob/24e0d98e8d80e3ff622deb30bc7d4698abcc7f74/src/main/java/frc/robot/subsystems/drive/DriveSubsystem.java#L750\\\" target=\\\"_blank\\\" rel=\\\"noopener nofollow ugc\\\"\\u003egithub.com\\u003c/a\\u003e\\n  \\u003c/header\\u003e\\n\\n  \\u003carticle class=\\\"onebox-body\\\"\\u003e\\n    \\u003ch4\\u003e\\u003ca href=\\\"https://github.com/lasarobotics/PH2024/blob/24e0d98e8d80e3ff622deb30bc7d4698abcc7f74/src/main/java/frc/robot/subsystems/drive/DriveSubsystem.java#L750\\\" target=\\\"_blank\\\" rel=\\\"noopener nofollow ugc\\\"\\u003elasarobotics/PH2024/blob/24e0d98e8d80e3ff622deb30bc7d4698abcc7f74/src/main/java/frc/robot/subsystems/drive/DriveSubsystem.java#L750\\u003c/a\\u003e\\u003c/h4\\u003e\\n\\n\\n\\n    \\u003cpre class=\\\"onebox\\\"\\u003e\\u003ccode class=\\\"lang-java\\\"\\u003e\\n      \\u003col class=\\\"start lines\\\" start=\\\"740\\\" style=\\\"counter-reset: li-counter 739 ;\\\"\\u003e\\n          \\u003cli\\u003e    rotateOutput,\\u003c/li\\u003e\\n          \\u003cli\\u003e    getInertialVelocity(),\\u003c/li\\u003e\\n          \\u003cli\\u003e    getRotateRate()\\u003c/li\\u003e\\n          \\u003cli\\u003e  );\\u003c/li\\u003e\\n          \\u003cli\\u003e}\\u003c/li\\u003e\\n          \\u003cli\\u003e\\u003c/li\\u003e\\n          \\u003cli\\u003e/**\\u003c/li\\u003e\\n          \\u003cli\\u003e * Aim robot by given angle\\u003c/li\\u003e\\n          \\u003cli\\u003e * @param angle Desired angle in degrees\\u003c/li\\u003e\\n          \\u003cli\\u003e */\\u003c/li\\u003e\\n          \\u003cli class=\\\"selected\\\"\\u003eprivate void aimAtAngle(double angle) {\\u003c/li\\u003e\\n          \\u003cli\\u003e  double rotateOutput = m_rotatePIDController.calculate(getAngle().in(Units.Degrees), getAngle().in(Units.Degrees) + angle);\\u003c/li\\u003e\\n          \\u003cli\\u003e\\u003c/li\\u003e\\n          \\u003cli\\u003e  drive(\\u003c/li\\u003e\\n          \\u003cli\\u003e    m_controlCentricity,\\u003c/li\\u003e\\n          \\u003cli\\u003e    Units.MetersPerSecond.of(0),\\u003c/li\\u003e\\n          \\u003cli\\u003e    Units.MetersPerSecond.of(0),\\u003c/li\\u003e\\n          \\u003cli\\u003e    Units.DegreesPerSecond.of(rotateOutput),\\u003c/li\\u003e\\n          \\u003cli\\u003e    getInertialVelocity(),\\u003c/li\\u003e\\n          \\u003cli\\u003e    getRotateRate()\\u003c/li\\u003e\\n          \\u003cli\\u003e  );\\u003c/li\\u003e\\n      \\u003c/ol\\u003e\\n    \\u003c/code\\u003e\\u003c/pre\\u003e\\n\\n\\n\\n  \\u003c/article\\u003e\\n\\n  \\u003cdiv class=\\\"onebox-metadata\\\"\\u003e\\n    \\n    \\n  \\u003c/div\\u003e\\n\\n  \\u003cdiv style=\\\"clear: both\\\"\\u003e\\u003c/div\\u003e\\n\\u003c/aside\\u003e\\n\\n\\u003cp\\u003eHowever, it’s based not on a standard \\u003cspan class=\\\"abbreviation\\\"\\u003ePID\\u003ctemplate class=\\\"tooltiptext\\\" data-text=\\\"Proportional Integral Derivative\\\"\\u003e\\u003c/template\\u003e\\u003c/span\\u003e controller, but rather on this one -\\u003c/p\\u003e\\n\\u003cp\\u003eimport org.lasarobotics.drive.RotatePIDController;\\u003c/p\\u003e\\n\\u003cp\\u003ewhich I found here -\\u003c/p\\u003e\\n\\u003caside class=\\\"onebox githubblob\\\" data-onebox-src=\\\"https://github.com/lasarobotics/PurpleLib/blob/master/src/main/java/org/lasarobotics/drive/RotatePIDController.java\\\"\\u003e\\n  \\u003cheader class=\\\"source\\\"\\u003e\\n\\n      \\u003ca href=\\\"https://github.com/lasarobotics/PurpleLib/blob/master/src/main/java/org/lasarobotics/drive/RotatePIDController.java\\\" target=\\\"_blank\\\" rel=\\\"noopener nofollow ugc\\\"\\u003egithub.com\\u003c/a\\u003e\\n  \\u003c/header\\u003e\\n\\n  \\u003carticle class=\\\"onebox-body\\\"\\u003e\\n    \\u003ch4\\u003e\\u003ca href=\\\"https://github.com/lasarobotics/PurpleLib/blob/master/src/main/java/org/lasarobotics/drive/RotatePIDController.java\\\" target=\\\"_blank\\\" rel=\\\"noopener nofollow ugc\\\"\\u003elasarobotics/PurpleLib/blob/master/src/main/java/org/lasarobotics/drive/RotatePIDController.java\\u003c/a\\u003e\\u003c/h4\\u003e\\n\\n\\n      \\u003cpre\\u003e\\u003ccode class=\\\"lang-java\\\"\\u003e// Copyright (c) LASA Robotics and other contributors\\n// Open Source Software; you can modify and/or share it under the terms of\\n// the MIT license file in the root directory of this project.\\n\\npackage org.lasarobotics.drive;\\n\\nimport java.util.HashMap;\\n\\nimport org.apache.commons.math3.analysis.polynomials.PolynomialSplineFunction;\\nimport org.lasarobotics.utils.GlobalConstants;\\nimport org.lasarobotics.utils.PIDConstants;\\n\\nimport edu.wpi.first.math.MathUtil;\\nimport edu.wpi.first.math.controller.PIDController;\\nimport edu.wpi.first.units.Angle;\\nimport edu.wpi.first.units.Measure;\\nimport edu.wpi.first.units.Units;\\nimport edu.wpi.first.units.Velocity;\\n\\n/** Rotate PID controller */\\n\\u003c/code\\u003e\\u003c/pre\\u003e\\n\\n\\n\\n  This file has been truncated. \\u003ca href=\\\"https://github.com/lasarobotics/PurpleLib/blob/master/src/main/java/org/lasarobotics/drive/RotatePIDController.java\\\" target=\\\"_blank\\\" rel=\\\"noopener nofollow ugc\\\"\\u003eshow original\\u003c/a\\u003e\\n\\n  \\u003c/article\\u003e\\n\\n  \\u003cdiv class=\\\"onebox-metadata\\\"\\u003e\\n    \\n    \\n  \\u003c/div\\u003e\\n\\n  \\u003cdiv style=\\\"clear: both\\\"\\u003e\\u003c/div\\u003e\\n\\u003c/aside\\u003e\\n\\n\\u003cp\\u003e(is master branch of it the one with the latest good code?)\\u003cbr\\u003e\\nThat controller uses PolynomialSplineFunction to calculate the curve.\\u003c/p\\u003e\\n\\u003cp\\u003eIn fact, the drive and turn functions are presented as interpolated polynomials -\\u003c/p\\u003e\\u003caside class=\\\"onebox githubblob\\\" data-onebox-src=\\\"https://github.com/lasarobotics/PH2024/blob/24e0d98e8d80e3ff622deb30bc7d4698abcc7f74/src/main/java/frc/robot/Constants.java#L127\\\"\\u003e\\n  \\u003cheader class=\\\"source\\\"\\u003e\\n\\n      \\u003ca href=\\\"https://github.com/lasarobotics/PH2024/blob/24e0d98e8d80e3ff622deb30bc7d4698abcc7f74/src/main/java/frc/robot/Constants.java#L127\\\" target=\\\"_blank\\\" rel=\\\"noopener nofollow ugc\\\"\\u003egithub.com\\u003c/a\\u003e\\n  \\u003c/header\\u003e\\n\\n  \\u003carticle class=\\\"onebox-body\\\"\\u003e\\n    \\u003ch4\\u003e\\u003ca href=\\\"https://github.com/lasarobotics/PH2024/blob/24e0d98e8d80e3ff622deb30bc7d4698abcc7f74/src/main/java/frc/robot/Constants.java#L127\\\" target=\\\"_blank\\\" rel=\\\"noopener nofollow ugc\\\"\\u003elasarobotics/PH2024/blob/24e0d98e8d80e3ff622deb30bc7d4698abcc7f74/src/main/java/frc/robot/Constants.java#L127\\u003c/a\\u003e\\u003c/h4\\u003e\\n\\n\\n\\n    \\u003cpre class=\\\"onebox\\\"\\u003e\\u003ccode class=\\\"lang-java\\\"\\u003e\\n      \\u003col class=\\\"start lines\\\" start=\\\"117\\\" style=\\\"counter-reset: li-counter 116 ;\\\"\\u003e\\n          \\u003cli\\u003e\\u003c/li\\u003e\\n          \\u003cli\\u003epublic static class Drive {\\u003c/li\\u003e\\n          \\u003cli\\u003e  public static final DriveWheel DRIVE_WHEEL = new DriveWheel(Units.Inches.of(3.0), Units.Value.of(0.9), Units.Value.of(0.8));\\u003c/li\\u003e\\n          \\u003cli\\u003e  public static final PIDConstants DRIVE_ROTATE_PID = new PIDConstants(8.0, 0.0, 0.3, 0.0, 0.0);\\u003c/li\\u003e\\n          \\u003cli\\u003e  public static final Measure\\u0026lt;Dimensionless\\u0026gt; DRIVE_SLIP_RATIO = Units.Percent.of(12.0);\\u003c/li\\u003e\\n          \\u003cli\\u003e  public static final double DRIVE_TURN_SCALAR = 90.0;\\u003c/li\\u003e\\n          \\u003cli\\u003e  public static final double DRIVE_LOOKAHEAD = 10;\\u003c/li\\u003e\\n          \\u003cli\\u003e\\u003c/li\\u003e\\n          \\u003cli\\u003e  public static final ControlCentricity DRIVE_CONTROL_CENTRICITY = ControlCentricity.FIELD_CENTRIC;\\u003c/li\\u003e\\n          \\u003cli\\u003e\\u003c/li\\u003e\\n          \\u003cli class=\\\"selected\\\"\\u003e  private static final double DRIVE_THROTTLE_INPUT_CURVE_X[] = { 0.0, 0.100, 0.200, 0.300, 0.400, 0.500, 0.600, 0.700, 0.800, 0.900, 1.000 };\\u003c/li\\u003e\\n          \\u003cli\\u003e  private static final double DRIVE_THROTTLE_INPUT_CURVE_Y[] = { 0.0, 0.052, 0.207, 0.465, 0.827, 1.293, 1.862, 2.534, 3.310, 4.189, 5.172 };\\u003c/li\\u003e\\n          \\u003cli\\u003e  private static final double DRIVE_TURN_INPUT_CURVE_X[] = { 0.0, 0.100, 0.200, 0.300, 0.400, 0.500, 0.600, 0.700, 0.800, 0.900, 1.0 };\\u003c/li\\u003e\\n          \\u003cli\\u003e  private static final double DRIVE_TURN_INPUT_CURVE_Y[] = { 0.0, 0.010, 0.050, 0.100, 0.150, 0.200, 0.250, 0.300, 0.400, 0.600, 1.0 };\\u003c/li\\u003e\\n          \\u003cli\\u003e\\u003c/li\\u003e\\n          \\u003cli\\u003e  private static final SplineInterpolator SPLINE_INTERPOLATOR = new SplineInterpolator();\\u003c/li\\u003e\\n          \\u003cli\\u003e  public static final PolynomialSplineFunction DRIVE_THROTTLE_INPUT_CURVE = SPLINE_INTERPOLATOR.interpolate(DRIVE_THROTTLE_INPUT_CURVE_X, DRIVE_THROTTLE_INPUT_CURVE_Y);\\u003c/li\\u003e\\n          \\u003cli\\u003e  public static final PolynomialSplineFunction DRIVE_TURN_INPUT_CURVE = SPLINE_INTERPOLATOR.interpolate(DRIVE_TURN_INPUT_CURVE_X, DRIVE_TURN_INPUT_CURVE_Y);\\u003c/li\\u003e\\n          \\u003cli\\u003e\\u003c/li\\u003e\\n          \\u003cli\\u003e  public static final MAXSwerveModule.GearRatio GEAR_RATIO = MAXSwerveModule.GearRatio.L3;\\u003c/li\\u003e\\n          \\u003cli\\u003e}\\u003c/li\\u003e\\n      \\u003c/ol\\u003e\\n    \\u003c/code\\u003e\\u003c/pre\\u003e\\n\\n\\n\\n  \\u003c/article\\u003e\\n\\n  \\u003cdiv class=\\\"onebox-metadata\\\"\\u003e\\n    \\n    \\n  \\u003c/div\\u003e\\n\\n  \\u003cdiv style=\\\"clear: both\\\"\\u003e\\u003c/div\\u003e\\n\\u003c/aside\\u003e\\n\\n\\u003cp\\u003eDo those represent the velocities corresponding to the joystick inputs? in this case - why the TURN ends with 1? Our robot, for instance, can do about 2.5 rps when “floored” to rotate. Is that the way to clamp the max angular velocity?\\u003c/p\\u003e\\n\\u003cp\\u003eJust trying to make sure I understand your code properly. This also does not quite answer the question - what would happen if the angle of rotation is too small - meaning - it’s very likely that \\u003cspan class=\\\"abbreviation\\\"\\u003ePID\\u003ctemplate class=\\\"tooltiptext\\\" data-text=\\\"Proportional Integral Derivative\\\"\\u003e\\u003c/template\\u003e\\u003c/span\\u003e will calculate a value well within the deadband, if you ask it to run say 1 degree). I see that the kI in the \\u003cspan class=\\\"abbreviation\\\"\\u003ePID\\u003ctemplate class=\\\"tooltiptext\\\" data-text=\\\"Proportional Integral Derivative\\\"\\u003e\\u003c/template\\u003e\\u003c/span\\u003e is set to 0 (line 42 of RotatePIDController).\\u003c/p\\u003e\",\"post_number\":5,\"post_type\":1,\"posts_count\":34,\"updated_at\":\"2024-09-28T18:10:15.090Z\",\"reply_count\":1,\"reply_to_post_number\":4,\"quote_count\":0,\"incoming_link_count\":3,\"reads\":277,\"readers_count\":276,\"score\":75.4,\"yours\":false,\"topic_id\":472069,\"topic_slug\":\"best-pid-profile-for-in-place-turns\",\"display_username\":\"Alex Tsekhansky\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":1,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"link_counts\":[{\"url\":\"https://github.com/lasarobotics/PurpleLib/blob/master/src/main/java/org/lasarobotics/drive/RotatePIDController.java\",\"internal\":false,\"reflection\":false,\"title\":\"PurpleLib/src/main/java/org/lasarobotics/drive/RotatePIDController.java at master · lasarobotics/PurpleLib · GitHub\",\"clicks\":5},{\"url\":\"https://github.com/lasarobotics/PH2024/blob/24e0d98e8d80e3ff622deb30bc7d4698abcc7f74/src/main/java/frc/robot/Constants.java#L127\",\"internal\":false,\"reflection\":false,\"title\":\"PH2024/src/main/java/frc/robot/Constants.java at 24e0d98e8d80e3ff622deb30bc7d4698abcc7f74 · lasarobotics/PH2024 · GitHub\",\"clicks\":1},{\"url\":\"https://github.com/lasarobotics/PH2024/blob/24e0d98e8d80e3ff622deb30bc7d4698abcc7f74/src/main/java/frc/robot/subsystems/drive/DriveSubsystem.java#L750\",\"internal\":false,\"reflection\":false,\"title\":\"PH2024/src/main/java/frc/robot/subsystems/drive/DriveSubsystem.java at 24e0d98e8d80e3ff622deb30bc7d4698abcc7f74 · lasarobotics/PH2024 · GitHub\",\"clicks\":0}],\"read\":true,\"user_title\":null,\"reply_to_user\":{\"id\":24613,\"username\":\"viggy96\",\"name\":\"viggy96\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/viggy96/{size}/252784_2.png\"},\"bookmarked\":false,\"actions_summary\":[],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":50762,\"hidden\":false,\"trust_level\":2,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"post_url\":\"/t/best-pid-profile-for-in-place-turns/472069/5\",\"custom_user_title\":null,\"reactions\":[],\"current_user_reaction\":null,\"reaction_users_count\":0,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":null},{\"id\":3428694,\"name\":\"viggy96\",\"username\":\"viggy96\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/viggy96/{size}/252784_2.png\",\"created_at\":\"2024-09-28T18:56:35.781Z\",\"cooked\":\"\\u003cp\\u003eYes those are joystick inputs, which is why that makes out at 1, and it’s multiplied by the “DRIVE_TURN_SCALAR” to determine how much to move the setpoint by.\\u003c/p\\u003e\\n\\u003cp\\u003eSo in this example, when the driver pushes the rotate stick all the way, the setpoint is set to 90 degrees from the current IMU value.\\u003c/p\\u003e\",\"post_number\":6,\"post_type\":1,\"posts_count\":34,\"updated_at\":\"2024-09-28T18:56:35.781Z\",\"reply_count\":1,\"reply_to_post_number\":5,\"quote_count\":0,\"incoming_link_count\":0,\"reads\":208,\"readers_count\":207,\"score\":46.6,\"yours\":false,\"topic_id\":472069,\"topic_slug\":\"best-pid-profile-for-in-place-turns\",\"display_username\":\"viggy96\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":1,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"read\":true,\"user_title\":\"\",\"reply_to_user\":{\"id\":50762,\"username\":\"atsekhan\",\"name\":\"Alex Tsekhansky\",\"avatar_template\":\"/letter_avatar_proxy/v4/letter/a/0ea827/{size}.png\"},\"bookmarked\":false,\"actions_summary\":[],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":24613,\"hidden\":false,\"trust_level\":2,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"user_custom_fields\":{\"user_field_4\":\"418 Mentor | Tries to be smart\"},\"post_url\":\"/t/best-pid-profile-for-in-place-turns/472069/6\",\"custom_user_title\":\"418 Mentor | Tries to be smart\",\"reactions\":[],\"current_user_reaction\":null,\"reaction_users_count\":0,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":null},{\"id\":3428696,\"name\":\"Alex Tsekhansky\",\"username\":\"atsekhan\",\"avatar_template\":\"/letter_avatar_proxy/v4/letter/a/0ea827/{size}.png\",\"created_at\":\"2024-09-28T19:14:50.580Z\",\"cooked\":\"\\u003cp\\u003eGot it. In our case the drivers are used to do manual rotation where the rotation joystick indicates “degree of rotation power” (in other word, if that joystick is held, the robot will spin continuously).\\u003c/p\\u003e\\n\\u003cp\\u003eSo, since in my case I am only looking for automated turns, am I correct and I do not really need to subclass PIDController, like you did?\\u003cbr\\u003e\\nIt appears while in your case the “calculate” takes momentary angular velocity into consideration, it does not use it to calculate the the actual requested velocity.\\u003c/p\\u003e\\n\\u003cp\\u003eI also did not seem to see the code that would handle the “last mile” precision handling, where you’re not at the position, and the robot does not seem to move based on whatever number you calculated (due to friction).\\u003c/p\\u003e\",\"post_number\":7,\"post_type\":1,\"posts_count\":34,\"updated_at\":\"2024-09-28T19:14:50.580Z\",\"reply_count\":1,\"reply_to_post_number\":6,\"quote_count\":0,\"incoming_link_count\":0,\"reads\":209,\"readers_count\":208,\"score\":46.8,\"yours\":false,\"topic_id\":472069,\"topic_slug\":\"best-pid-profile-for-in-place-turns\",\"display_username\":\"Alex Tsekhansky\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":1,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"read\":true,\"user_title\":null,\"reply_to_user\":{\"id\":24613,\"username\":\"viggy96\",\"name\":\"viggy96\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/viggy96/{size}/252784_2.png\"},\"bookmarked\":false,\"actions_summary\":[],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":50762,\"hidden\":false,\"trust_level\":2,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"post_url\":\"/t/best-pid-profile-for-in-place-turns/472069/7\",\"custom_user_title\":null,\"reactions\":[],\"current_user_reaction\":null,\"reaction_users_count\":0,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":null},{\"id\":3428732,\"name\":\"viggy96\",\"username\":\"viggy96\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/viggy96/{size}/252784_2.png\",\"created_at\":\"2024-09-28T23:13:49.484Z\",\"cooked\":\"\\u003cp\\u003eLike I said, we use a regular profiled \\u003cspan class=\\\"abbreviation\\\"\\u003ePID\\u003ctemplate class=\\\"tooltiptext\\\" data-text=\\\"Proportional Integral Derivative\\\"\\u003e\\u003c/template\\u003e\\u003c/span\\u003e controller for aiming at objects. You can see this in \\u003ccode\\u003eaimAtPoint\\u003c/code\\u003e method. Using this method, we can aim at any arbitrary coordinate on the field, and it worked to great effect to aim at the speaker.\\u003c/p\\u003e\",\"post_number\":8,\"post_type\":1,\"posts_count\":34,\"updated_at\":\"2024-09-28T23:13:58.800Z\",\"reply_count\":1,\"reply_to_post_number\":7,\"quote_count\":0,\"incoming_link_count\":0,\"reads\":180,\"readers_count\":179,\"score\":56.0,\"yours\":false,\"topic_id\":472069,\"topic_slug\":\"best-pid-profile-for-in-place-turns\",\"display_username\":\"viggy96\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":1,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"read\":true,\"user_title\":\"\",\"reply_to_user\":{\"id\":50762,\"username\":\"atsekhan\",\"name\":\"Alex Tsekhansky\",\"avatar_template\":\"/letter_avatar_proxy/v4/letter/a/0ea827/{size}.png\"},\"bookmarked\":false,\"actions_summary\":[{\"id\":2,\"count\":1}],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":24613,\"hidden\":false,\"trust_level\":2,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"user_custom_fields\":{\"user_field_4\":\"418 Mentor | Tries to be smart\"},\"post_url\":\"/t/best-pid-profile-for-in-place-turns/472069/8\",\"custom_user_title\":\"418 Mentor | Tries to be smart\",\"reactions\":[{\"id\":\"heart\",\"type\":\"emoji\",\"count\":1}],\"current_user_reaction\":null,\"reaction_users_count\":1,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":null},{\"id\":3428740,\"name\":\"Alex Tsekhansky\",\"username\":\"atsekhan\",\"avatar_template\":\"/letter_avatar_proxy/v4/letter/a/0ea827/{size}.png\",\"created_at\":\"2024-09-28T23:26:52.200Z\",\"cooked\":\"\\u003cp\\u003eI will try it. As I said, my main issue was - the friction seems too high, so for small angles the controller would generate a gain that would not actually move the robot. The velocity \\u003cspan class=\\\"abbreviation\\\"\\u003ePID\\u003ctemplate class=\\\"tooltiptext\\\" data-text=\\\"Proportional Integral Derivative\\\"\\u003e\\u003c/template\\u003e\\u003c/span\\u003e does not really help much here as velocity gains are translated into voltages or duty cycle settings anyway. And if a given voltage would sustain the robot moving, but not start the move, a simple \\u003cspan class=\\\"abbreviation\\\"\\u003ePID\\u003ctemplate class=\\\"tooltiptext\\\" data-text=\\\"Proportional Integral Derivative\\\"\\u003e\\u003c/template\\u003e\\u003c/span\\u003e controller does not define such behavior well. That may be a defect of the build, but I am trying to see if there is a model that can deal with such issue.\\u003c/p\\u003e\",\"post_number\":9,\"post_type\":1,\"posts_count\":34,\"updated_at\":\"2024-09-28T23:26:52.200Z\",\"reply_count\":1,\"reply_to_post_number\":8,\"quote_count\":0,\"incoming_link_count\":0,\"reads\":176,\"readers_count\":175,\"score\":40.2,\"yours\":false,\"topic_id\":472069,\"topic_slug\":\"best-pid-profile-for-in-place-turns\",\"display_username\":\"Alex Tsekhansky\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":1,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"read\":true,\"user_title\":null,\"reply_to_user\":{\"id\":24613,\"username\":\"viggy96\",\"name\":\"viggy96\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/viggy96/{size}/252784_2.png\"},\"bookmarked\":false,\"actions_summary\":[],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":50762,\"hidden\":false,\"trust_level\":2,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"post_url\":\"/t/best-pid-profile-for-in-place-turns/472069/9\",\"custom_user_title\":null,\"reactions\":[],\"current_user_reaction\":null,\"reaction_users_count\":0,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":null},{\"id\":3428744,\"name\":\"viggy96\",\"username\":\"viggy96\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/viggy96/{size}/252784_2.png\",\"created_at\":\"2024-09-28T23:32:51.388Z\",\"cooked\":\"\\u003cp\\u003eI believe your issue is more mechanical. What level of accuracy are you looking for? \\u0026lt;2 degrees, \\u0026lt;1 degree?\\u003c/p\\u003e\\n\\u003cp\\u003eA regular position \\u003cspan class=\\\"abbreviation\\\"\\u003ePID\\u003ctemplate class=\\\"tooltiptext\\\" data-text=\\\"Proportional Integral Derivative\\\"\\u003e\\u003c/template\\u003e\\u003c/span\\u003e controller should be more than sufficient to accurately rotate the robot to your desired orientation.\\u003c/p\\u003e\\n\\u003cp\\u003eAre you guys using closed loop control on your swerve modules (velocity \\u003cspan class=\\\"abbreviation\\\"\\u003ePID\\u003ctemplate class=\\\"tooltiptext\\\" data-text=\\\"Proportional Integral Derivative\\\"\\u003e\\u003c/template\\u003e\\u003c/span\\u003e for drive motors)?\\u003c/p\\u003e\",\"post_number\":10,\"post_type\":1,\"posts_count\":34,\"updated_at\":\"2024-09-28T23:41:23.554Z\",\"reply_count\":0,\"reply_to_post_number\":9,\"quote_count\":0,\"incoming_link_count\":1,\"reads\":165,\"readers_count\":164,\"score\":38.0,\"yours\":false,\"topic_id\":472069,\"topic_slug\":\"best-pid-profile-for-in-place-turns\",\"display_username\":\"viggy96\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":2,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"read\":true,\"user_title\":\"\",\"reply_to_user\":{\"id\":50762,\"username\":\"atsekhan\",\"name\":\"Alex Tsekhansky\",\"avatar_template\":\"/letter_avatar_proxy/v4/letter/a/0ea827/{size}.png\"},\"bookmarked\":false,\"actions_summary\":[],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":24613,\"hidden\":false,\"trust_level\":2,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"user_custom_fields\":{\"user_field_4\":\"418 Mentor | Tries to be smart\"},\"post_url\":\"/t/best-pid-profile-for-in-place-turns/472069/10\",\"custom_user_title\":\"418 Mentor | Tries to be smart\",\"reactions\":[],\"current_user_reaction\":null,\"reaction_users_count\":0,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":null},{\"id\":3428745,\"name\":\"joel truher\",\"username\":\"truher\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/truher/{size}/172222_2.png\",\"created_at\":\"2024-09-28T23:46:19.895Z\",\"cooked\":\"\\u003cp\\u003eI think the confusion here is that OP is asking about including friction in the top level pose theta controller, which is the wrong level to worry about friction.  you should be using a friction term in your low level motor control, and using closed loop velocity control there, so if the top level controller produces a velocity command, it will be obeyed, even if it’s small.\\u003c/p\\u003e\",\"post_number\":11,\"post_type\":1,\"posts_count\":34,\"updated_at\":\"2024-09-28T23:46:19.895Z\",\"reply_count\":2,\"reply_to_post_number\":null,\"quote_count\":0,\"incoming_link_count\":1,\"reads\":163,\"readers_count\":162,\"score\":92.6,\"yours\":false,\"topic_id\":472069,\"topic_slug\":\"best-pid-profile-for-in-place-turns\",\"display_username\":\"joel truher\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":1,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"read\":true,\"user_title\":null,\"bookmarked\":false,\"actions_summary\":[{\"id\":2,\"count\":3}],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":53190,\"hidden\":false,\"trust_level\":2,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"user_custom_fields\":{\"user_field_4\":\"\"},\"post_url\":\"/t/best-pid-profile-for-in-place-turns/472069/11\",\"custom_user_title\":null,\"reactions\":[{\"id\":\"heart\",\"type\":\"emoji\",\"count\":3}],\"current_user_reaction\":null,\"reaction_users_count\":3,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":null},{\"id\":3428747,\"name\":\"viggy96\",\"username\":\"viggy96\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/viggy96/{size}/252784_2.png\",\"created_at\":\"2024-09-29T00:10:27.569Z\",\"cooked\":\"\\u003cp\\u003eAh I see. Indeed, that is the right place to do it.\\u003c/p\\u003e\",\"post_number\":12,\"post_type\":1,\"posts_count\":34,\"updated_at\":\"2024-09-29T00:10:27.569Z\",\"reply_count\":0,\"reply_to_post_number\":11,\"quote_count\":0,\"incoming_link_count\":0,\"reads\":155,\"readers_count\":154,\"score\":46.0,\"yours\":false,\"topic_id\":472069,\"topic_slug\":\"best-pid-profile-for-in-place-turns\",\"display_username\":\"viggy96\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":1,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"read\":true,\"user_title\":\"\",\"reply_to_user\":{\"id\":53190,\"username\":\"truher\",\"name\":\"joel truher\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/truher/{size}/172222_2.png\"},\"bookmarked\":false,\"actions_summary\":[{\"id\":2,\"count\":1}],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":24613,\"hidden\":false,\"trust_level\":2,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"user_custom_fields\":{\"user_field_4\":\"418 Mentor | Tries to be smart\"},\"post_url\":\"/t/best-pid-profile-for-in-place-turns/472069/12\",\"custom_user_title\":\"418 Mentor | Tries to be smart\",\"reactions\":[{\"id\":\"heart\",\"type\":\"emoji\",\"count\":1}],\"current_user_reaction\":null,\"reaction_users_count\":1,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":null},{\"id\":3428754,\"name\":\"sam liu\",\"username\":\"catrix\",\"avatar_template\":\"/letter_avatar_proxy/v4/letter/c/dbc845/{size}.png\",\"created_at\":\"2024-09-29T00:57:28.059Z\",\"cooked\":\"\\u003caside class=\\\"quote no-group\\\" data-username=\\\"atsekhan\\\" data-post=\\\"1\\\" data-topic=\\\"472069\\\"\\u003e\\n\\u003cdiv class=\\\"title\\\"\\u003e\\n\\u003cdiv class=\\\"quote-controls\\\"\\u003e\\u003c/div\\u003e\\n\\u003cimg loading=\\\"lazy\\\" alt=\\\"\\\" width=\\\"24\\\" height=\\\"24\\\" src=\\\"https://www.chiefdelphi.com/letter_avatar_proxy/v4/letter/a/0ea827/48.png\\\" class=\\\"avatar\\\"\\u003e atsekhan:\\u003c/div\\u003e\\n\\u003cblockquote\\u003e\\n\\u003cp\\u003ewith tolerance of half-degree\\u003c/p\\u003e\\n\\u003c/blockquote\\u003e\\n\\u003c/aside\\u003e\\n\\u003cp\\u003eI think it’s nearly impossible to get 0.5 degrees of accuracy in \\u003cspan class=\\\"abbreviation\\\"\\u003eFRC\\u003ctemplate class=\\\"tooltiptext\\\" data-text=\\\"FIRST Robotics Competition\\\"\\u003e\\u003c/template\\u003e\\u003c/span\\u003e.  if you’re trying to aim at a shooter target, 2 degrees of tolerance is what I would go for instead.   We had five cameras running 720p April tag detection with photo vision; we still have around 2 degrees of error margin for rotation.\\u003c/p\\u003e\\n\\u003caside class=\\\"quote no-group\\\" data-username=\\\"atsekhan\\\" data-post=\\\"1\\\" data-topic=\\\"472069\\\"\\u003e\\n\\u003cdiv class=\\\"title\\\"\\u003e\\n\\u003cdiv class=\\\"quote-controls\\\"\\u003e\\u003c/div\\u003e\\n\\u003cimg loading=\\\"lazy\\\" alt=\\\"\\\" width=\\\"24\\\" height=\\\"24\\\" src=\\\"https://www.chiefdelphi.com/letter_avatar_proxy/v4/letter/a/0ea827/48.png\\\" class=\\\"avatar\\\"\\u003e atsekhan:\\u003c/div\\u003e\\n\\u003cblockquote\\u003e\\n\\u003cp\\u003eHowever, to keep it going it needs to be above 0.015.\\u003c/p\\u003e\\n\\u003c/blockquote\\u003e\\n\\u003c/aside\\u003e\\n\\u003cp\\u003eYou could try turning up the friction gain of the feed-forward controller for your driving motor a bit.\\u003c/p\\u003e\\n\\u003caside class=\\\"quote no-group\\\" data-username=\\\"atsekhan\\\" data-post=\\\"1\\\" data-topic=\\\"472069\\\"\\u003e\\n\\u003cdiv class=\\\"title\\\"\\u003e\\n\\u003cdiv class=\\\"quote-controls\\\"\\u003e\\u003c/div\\u003e\\n\\u003cimg loading=\\\"lazy\\\" alt=\\\"\\\" width=\\\"24\\\" height=\\\"24\\\" src=\\\"https://www.chiefdelphi.com/letter_avatar_proxy/v4/letter/a/0ea827/48.png\\\" class=\\\"avatar\\\"\\u003e atsekhan:\\u003c/div\\u003e\\n\\u003cblockquote\\u003e\\n\\u003cp\\u003eAnother way would be, for instance, is to calculate how much the wheels need to turn, and do a Position \\u003cspan class=\\\"abbreviation\\\"\\u003ePID\\u003ctemplate class=\\\"tooltiptext\\\" data-text=\\\"Proportional Integral Derivative\\\"\\u003e\\u003c/template\\u003e\\u003c/span\\u003e on the wheel motors once they’re turned to the right angle.\\u003c/p\\u003e\\n\\u003c/blockquote\\u003e\\n\\u003c/aside\\u003e\\n\\u003cp\\u003eI’ve never heard someone do that. When rotating your chassis, the driving wheels should be turning at the same speed; they shouldn’t be running separate position PIDs.\\u003c/p\\u003e\",\"post_number\":13,\"post_type\":1,\"posts_count\":34,\"updated_at\":\"2024-09-29T00:57:28.059Z\",\"reply_count\":2,\"reply_to_post_number\":null,\"quote_count\":1,\"incoming_link_count\":0,\"reads\":157,\"readers_count\":156,\"score\":41.4,\"yours\":false,\"topic_id\":472069,\"topic_slug\":\"best-pid-profile-for-in-place-turns\",\"display_username\":\"sam liu\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":1,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"read\":true,\"user_title\":\"\",\"bookmarked\":false,\"actions_summary\":[],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":60033,\"hidden\":false,\"trust_level\":2,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"user_custom_fields\":{\"user_field_4\":\"CE Student @ UWaterloo | 5516 Alum \"},\"post_url\":\"/t/best-pid-profile-for-in-place-turns/472069/13\",\"custom_user_title\":\"CE Student @ UWaterloo | 5516 Alum \",\"reactions\":[],\"current_user_reaction\":null,\"reaction_users_count\":0,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":null},{\"id\":3428758,\"name\":\"Alex Tsekhansky\",\"username\":\"atsekhan\",\"avatar_template\":\"/letter_avatar_proxy/v4/letter/a/0ea827/{size}.png\",\"created_at\":\"2024-09-29T01:36:12.884Z\",\"cooked\":\"\\u003cp\\u003eI may be mistaken, but the low level control done via SwerveDrive class of CTR does not have a friction component. We looked into the actual library code, and it appears to convert velocity into direct voltage, that’s about it.\\u003cbr\\u003e\\nIn other words, if you tell the chassis to run with a low velocity, it will NOT move.\\u003cbr\\u003e\\nWe’re trying to simplify our swerve code from last year (where we did all of the code, including low-level one) and see if we can get the code smaller.\\u003c/p\\u003e\\n\\u003cp\\u003eFor instance, the code that was given as a reference, the drive is done via swervemodulestates -\\u003cbr\\u003e\\nimport org.lasarobotics.drive.MAXSwerveModule;\\u003cbr\\u003e\\nand the actual command to drive is set here:\\u003c/p\\u003e\\u003caside class=\\\"onebox githubblob\\\" data-onebox-src=\\\"https://github.com/lasarobotics/PurpleLib/blob/fe6ad873d94901087ac05cf6a6bef4a2b8860287/src/main/java/org/lasarobotics/drive/MAXSwerveModule.java#L405C4-L405C82\\\"\\u003e\\n  \\u003cheader class=\\\"source\\\"\\u003e\\n\\n      \\u003ca href=\\\"https://github.com/lasarobotics/PurpleLib/blob/fe6ad873d94901087ac05cf6a6bef4a2b8860287/src/main/java/org/lasarobotics/drive/MAXSwerveModule.java#L405C4-L405C82\\\" target=\\\"_blank\\\" rel=\\\"noopener nofollow ugc\\\"\\u003egithub.com\\u003c/a\\u003e\\n  \\u003c/header\\u003e\\n\\n  \\u003carticle class=\\\"onebox-body\\\"\\u003e\\n    \\u003ch4\\u003e\\u003ca href=\\\"https://github.com/lasarobotics/PurpleLib/blob/fe6ad873d94901087ac05cf6a6bef4a2b8860287/src/main/java/org/lasarobotics/drive/MAXSwerveModule.java#L405C4-L405C82\\\" target=\\\"_blank\\\" rel=\\\"noopener nofollow ugc\\\"\\u003elasarobotics/PurpleLib/blob/fe6ad873d94901087ac05cf6a6bef4a2b8860287/src/main/java/org/lasarobotics/drive/MAXSwerveModule.java#L405C4-L405C82\\u003c/a\\u003e\\u003c/h4\\u003e\\n\\n\\n\\n    \\u003cpre class=\\\"onebox\\\"\\u003e\\u003ccode class=\\\"lang-java\\\"\\u003e\\n      \\u003col class=\\\"start lines\\\" start=\\\"405\\\" style=\\\"counter-reset: li-counter 404 ;\\\"\\u003e\\n          \\u003cli\\u003em_driveMotor.set(m_desiredState.speedMetersPerSecond, ControlType.kVelocity);\\u003c/li\\u003e\\n      \\u003c/ol\\u003e\\n    \\u003c/code\\u003e\\u003c/pre\\u003e\\n\\n\\n\\n  \\u003c/article\\u003e\\n\\n  \\u003cdiv class=\\\"onebox-metadata\\\"\\u003e\\n    \\n    \\n  \\u003c/div\\u003e\\n\\n  \\u003cdiv style=\\\"clear: both\\\"\\u003e\\u003c/div\\u003e\\n\\u003c/aside\\u003e\\n\\n\\u003cp\\u003eWith the CTR library, however, the drive is essentially done like this -\\u003c/p\\u003e\\n\\u003cpre\\u003e\\u003ccode class=\\\"lang-auto\\\"\\u003e    this.setControl(\\n      drive.withVelocityX(xVelocity_m_per_s)\\n        .withVelocityY(yVelocity_m_per_s)\\n        .withRotationalRate(omega_rad_per_s)\\n    );\\n\\u003c/code\\u003e\\u003c/pre\\u003e\\n\\u003cp\\u003eThe library code does the drive requests like this -\\u003c/p\\u003e\\n\\u003cpre\\u003e\\u003ccode class=\\\"lang-auto\\\"\\u003epublic SwerveModule.DriveRequestType DriveRequestType = SwerveModule.DriveRequestType.OpenLoopVoltage;\\n\\u003c/code\\u003e\\u003c/pre\\u003e\\n\\u003cp\\u003eThe actual code that makes the wheels move inside the library looks like this:\\u003c/p\\u003e\\n\\u003cpre data-code-wrap=\\\"case\\\"\\u003e\\u003ccode class=\\\"lang-case\\\"\\u003e                switch (m_driveClosedLoopOutput) {\\n                    case Voltage:\\n                        m_driveMotor.setControl(m_velocityVoltageSetter.withVelocity(velocityToSet));\\n                        break;\\n\\n                    case TorqueCurrentFOC:\\n                        m_driveMotor.setControl(m_velocityTorqueSetter.withVelocity(velocityToSet));\\n                        break;\\n                }\\n\\u003c/code\\u003e\\u003c/pre\\u003e\\n\\u003cp\\u003eThe library class that handles it is \\u003ccode\\u003eVelocityVoltage\\u003c/code\\u003e indeed appears to have an ability to set a voltage \\u003cspan class=\\\"abbreviation\\\"\\u003ePID\\u003ctemplate class=\\\"tooltiptext\\\" data-text=\\\"Proportional Integral Derivative\\\"\\u003e\\u003c/template\\u003e\\u003c/span\\u003e. But with very low velocities it just does not seem to happen, ever. Any ideas how to troubleshoot that?\\u003c/p\\u003e\",\"post_number\":14,\"post_type\":1,\"posts_count\":34,\"updated_at\":\"2024-09-29T01:36:12.884Z\",\"reply_count\":1,\"reply_to_post_number\":11,\"quote_count\":0,\"incoming_link_count\":1,\"reads\":148,\"readers_count\":147,\"score\":39.6,\"yours\":false,\"topic_id\":472069,\"topic_slug\":\"best-pid-profile-for-in-place-turns\",\"display_username\":\"Alex Tsekhansky\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":1,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"link_counts\":[{\"url\":\"https://github.com/lasarobotics/PurpleLib/blob/fe6ad873d94901087ac05cf6a6bef4a2b8860287/src/main/java/org/lasarobotics/drive/MAXSwerveModule.java#L405C4-L405C82\",\"internal\":false,\"reflection\":false,\"title\":\"PurpleLib/src/main/java/org/lasarobotics/drive/MAXSwerveModule.java at fe6ad873d94901087ac05cf6a6bef4a2b8860287 · lasarobotics/PurpleLib · GitHub\",\"clicks\":0}],\"read\":true,\"user_title\":null,\"reply_to_user\":{\"id\":53190,\"username\":\"truher\",\"name\":\"joel truher\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/truher/{size}/172222_2.png\"},\"bookmarked\":false,\"actions_summary\":[],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":50762,\"hidden\":false,\"trust_level\":2,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"post_url\":\"/t/best-pid-profile-for-in-place-turns/472069/14\",\"custom_user_title\":null,\"reactions\":[{\"id\":\"question\",\"type\":\"emoji\",\"count\":1}],\"current_user_reaction\":null,\"reaction_users_count\":1,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":null},{\"id\":3428759,\"name\":\"Alex Tsekhansky\",\"username\":\"atsekhan\",\"avatar_template\":\"/letter_avatar_proxy/v4/letter/a/0ea827/{size}.png\",\"created_at\":\"2024-09-29T01:44:43.773Z\",\"cooked\":\"\\u003cp\\u003eWe easily get 3 degrees or less about 90% of the time with properly tuned PathPlanner on-the-fly trajectory. However, shooting from far distances requires substantially better precision. An error of 3 degrees at 3 meters gets you 0.26 target deviation. That’s quite substantial, considering that the cameras and other devices would also have their own errors. Compounding all these errors may get you to 10 degrees or so, which will make it miss the target. We did not test \\u003cspan class=\\\"abbreviation\\\"\\u003eLL\\u003ctemplate class=\\\"tooltiptext\\\" data-text=\\\"Limelight, an integrated vision coprocessor\\\"\\u003e\\u003c/template\\u003e\\u003c/span\\u003e megapose2 that claims to be much more precise this year, though. But even then the drive of the robot usually introduces enough jitter in the camera stand to cause 2-3 degree deviation, which may be compounded.\\u003c/p\\u003e\\n\\u003cp\\u003eI still think that with proper \\u003cspan class=\\\"abbreviation\\\"\\u003ePID\\u003ctemplate class=\\\"tooltiptext\\\" data-text=\\\"Proportional Integral Derivative\\\"\\u003e\\u003c/template\\u003e\\u003c/span\\u003e on low turn speed you can get such precision of 0.5 degree (per IMU setting), if you would be Ok with low speeds (e.g. allocate 1.5 seconds per, say, 20 degree or less turn)\\u003c/p\\u003e\\n\\u003cp\\u003eRe: driving wheels and the same speed - they’re still issued separate commands inside individual swerve modules. They definitely do not run with the same momentary speed in a holonomic movement. Since the commands change often you do not really see the jitter. But one chassis motor definitely does not watch the other ones.\\u003c/p\\u003e\",\"post_number\":15,\"post_type\":1,\"posts_count\":34,\"updated_at\":\"2024-09-29T01:44:43.773Z\",\"reply_count\":1,\"reply_to_post_number\":13,\"quote_count\":0,\"incoming_link_count\":0,\"reads\":128,\"readers_count\":127,\"score\":30.6,\"yours\":false,\"topic_id\":472069,\"topic_slug\":\"best-pid-profile-for-in-place-turns\",\"display_username\":\"Alex Tsekhansky\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":1,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"read\":true,\"user_title\":null,\"reply_to_user\":{\"id\":60033,\"username\":\"catrix\",\"name\":\"sam liu\",\"avatar_template\":\"/letter_avatar_proxy/v4/letter/c/dbc845/{size}.png\"},\"bookmarked\":false,\"actions_summary\":[],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":50762,\"hidden\":false,\"trust_level\":2,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"post_url\":\"/t/best-pid-profile-for-in-place-turns/472069/15\",\"custom_user_title\":null,\"reactions\":[],\"current_user_reaction\":null,\"reaction_users_count\":0,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":null},{\"id\":3428771,\"name\":\"Eli Barnett\",\"username\":\"Oblarg\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/oblarg/{size}/161674_2.png\",\"created_at\":\"2024-09-29T02:49:20.313Z\",\"cooked\":\"\\u003cp\\u003eSet the kS gain to an appropriate value and you will have stiction compensation.\\u003c/p\\u003e\",\"post_number\":16,\"post_type\":1,\"posts_count\":34,\"updated_at\":\"2024-09-29T02:49:43.505Z\",\"reply_count\":2,\"reply_to_post_number\":14,\"quote_count\":0,\"incoming_link_count\":0,\"reads\":124,\"readers_count\":123,\"score\":79.8,\"yours\":false,\"topic_id\":472069,\"topic_slug\":\"best-pid-profile-for-in-place-turns\",\"display_username\":\"Eli Barnett\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":1,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"read\":true,\"user_title\":\"\",\"reply_to_user\":{\"id\":50762,\"username\":\"atsekhan\",\"name\":\"Alex Tsekhansky\",\"avatar_template\":\"/letter_avatar_proxy/v4/letter/a/0ea827/{size}.png\"},\"bookmarked\":false,\"actions_summary\":[{\"id\":2,\"count\":3}],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":12381,\"hidden\":false,\"trust_level\":2,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"user_custom_fields\":{\"user_field_4\":\"Robot apartments! invisible suburbs! skeleton treasuries!\"},\"post_url\":\"/t/best-pid-profile-for-in-place-turns/472069/16\",\"custom_user_title\":\"Robot apartments! invisible suburbs! skeleton treasuries!\",\"reactions\":[{\"id\":\"heart\",\"type\":\"emoji\",\"count\":2},{\"id\":\"100\",\"type\":\"emoji\",\"count\":1}],\"current_user_reaction\":null,\"reaction_users_count\":3,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":null},{\"id\":3428774,\"name\":\"Geoffrey\",\"username\":\"Geoffrey8814\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/geoffrey8814/{size}/262430_2.png\",\"created_at\":\"2024-09-29T03:13:12.224Z\",\"cooked\":\"\\u003cp\\u003eWe made a switch from using a profiledPIDController to using a normal PIDController with a custom acceleration limitation on top of it. The issue with profiledPIDController is that its “profile” is not very accurate, especially with acceleration. Since the magnitude of the acceleration and deceleration is the same for profiledPIDController, our robot can’t keep up with high acceleration, but low acceleration will make small adjustments very slow. Additionally, to achieve accurate aiming, I recommend tracking the tag on the speaker and using the relative angle to aim. This is because other tags might be slightly off, and pose estimation will have some error in it. If you’re calculating the pose and then the angle, why not just directly calculate the angle?\\u003c/p\\u003e\",\"post_number\":17,\"post_type\":1,\"posts_count\":34,\"updated_at\":\"2024-09-29T03:13:12.224Z\",\"reply_count\":1,\"reply_to_post_number\":null,\"quote_count\":0,\"incoming_link_count\":0,\"reads\":128,\"readers_count\":127,\"score\":45.6,\"yours\":false,\"topic_id\":472069,\"topic_slug\":\"best-pid-profile-for-in-place-turns\",\"display_username\":\"Geoffrey\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":1,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"read\":true,\"user_title\":\"\",\"bookmarked\":false,\"actions_summary\":[{\"id\":2,\"count\":1}],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":60663,\"hidden\":false,\"trust_level\":2,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"user_custom_fields\":{\"user_field_4\":\"\"},\"post_url\":\"/t/best-pid-profile-for-in-place-turns/472069/17\",\"custom_user_title\":null,\"reactions\":[{\"id\":\"heart\",\"type\":\"emoji\",\"count\":1}],\"current_user_reaction\":null,\"reaction_users_count\":1,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":null},{\"id\":3428775,\"name\":\"Alex Tsekhansky\",\"username\":\"atsekhan\",\"avatar_template\":\"/letter_avatar_proxy/v4/letter/a/0ea827/{size}.png\",\"created_at\":\"2024-09-29T03:16:07.191Z\",\"cooked\":\"\\u003cp\\u003eI do not think the \\u003ccode\\u003eProfiledPIDController\\u003c/code\\u003e or \\u003ccode\\u003ePIDController\\u003c/code\\u003e classes have kS. However, there is \\u003ccode\\u003ewithDriveFrictionVoltage\\u003c/code\\u003e in \\u003ccode\\u003eSwerveModuleConstantsFactory\\u003c/code\\u003e. But the documentation appears to state it’s for simulation? May be someone from CTR would clarify that.\\u003c/p\\u003e\\n\\u003cp\\u003eOr you mean using \\u003ccode\\u003eSimpleMotorFeedforward\\u003c/code\\u003e and combine the output with \\u003cspan class=\\\"abbreviation\\\"\\u003ePID\\u003ctemplate class=\\\"tooltiptext\\\" data-text=\\\"Proportional Integral Derivative\\\"\\u003e\\u003c/template\\u003e\\u003c/span\\u003e? That one indeed has kS, and that’s the one I was going to try next.\\u003c/p\\u003e\",\"post_number\":18,\"post_type\":1,\"posts_count\":34,\"updated_at\":\"2024-09-29T03:16:07.191Z\",\"reply_count\":1,\"reply_to_post_number\":16,\"quote_count\":0,\"incoming_link_count\":0,\"reads\":129,\"readers_count\":128,\"score\":30.8,\"yours\":false,\"topic_id\":472069,\"topic_slug\":\"best-pid-profile-for-in-place-turns\",\"display_username\":\"Alex Tsekhansky\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":1,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"read\":true,\"user_title\":null,\"reply_to_user\":{\"id\":12381,\"username\":\"Oblarg\",\"name\":\"Eli Barnett\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/oblarg/{size}/161674_2.png\"},\"bookmarked\":false,\"actions_summary\":[],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":50762,\"hidden\":false,\"trust_level\":2,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"post_url\":\"/t/best-pid-profile-for-in-place-turns/472069/18\",\"custom_user_title\":null,\"reactions\":[],\"current_user_reaction\":null,\"reaction_users_count\":0,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":null},{\"id\":3428777,\"name\":\"Alex Tsekhansky\",\"username\":\"atsekhan\",\"avatar_template\":\"/letter_avatar_proxy/v4/letter/a/0ea827/{size}.png\",\"created_at\":\"2024-09-29T03:20:05.854Z\",\"cooked\":\"\\u003cp\\u003eCould you share the code for the subclassed controller?\\u003c/p\\u003e\\n\\u003cp\\u003eI think that’s exactly what I may be looking for, for the exact reasons you stated.\\u003c/p\\u003e\\n\\u003cp\\u003eRe: accurate aiming - yes, we’re doing exactly that. We generally only uses chassis poses for auto-driving, not for aiming-when-stopped.  That’s why turn-to-angle would be a command separate from driving.\\u003c/p\\u003e\",\"post_number\":19,\"post_type\":1,\"posts_count\":34,\"updated_at\":\"2024-09-29T03:20:05.854Z\",\"reply_count\":1,\"reply_to_post_number\":17,\"quote_count\":0,\"incoming_link_count\":1,\"reads\":129,\"readers_count\":128,\"score\":35.8,\"yours\":false,\"topic_id\":472069,\"topic_slug\":\"best-pid-profile-for-in-place-turns\",\"display_username\":\"Alex Tsekhansky\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":1,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"read\":true,\"user_title\":null,\"reply_to_user\":{\"id\":60663,\"username\":\"Geoffrey8814\",\"name\":\"Geoffrey\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/geoffrey8814/{size}/262430_2.png\"},\"bookmarked\":false,\"actions_summary\":[],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":50762,\"hidden\":false,\"trust_level\":2,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"post_url\":\"/t/best-pid-profile-for-in-place-turns/472069/19\",\"custom_user_title\":null,\"reactions\":[],\"current_user_reaction\":null,\"reaction_users_count\":0,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":null},{\"id\":3428783,\"name\":\"Geoffrey\",\"username\":\"Geoffrey8814\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/geoffrey8814/{size}/262430_2.png\",\"created_at\":\"2024-09-29T03:48:26.491Z\",\"cooked\":\"\\u003cp\\u003eThe code looks like this:\\u003cbr\\u003e\\n\\u003cdiv class=\\\"lightbox-wrapper\\\"\\u003e\\u003ca class=\\\"lightbox\\\" href=\\\"https://www.chiefdelphi.com/uploads/default/original/3X/4/2/4229aec3fd9d7121a52a0d0ae7cf3a437469e16f.png\\\" data-download-href=\\\"https://www.chiefdelphi.com/uploads/default/4229aec3fd9d7121a52a0d0ae7cf3a437469e16f\\\" title=\\\"image\\\"\\u003e\\u003cimg src=\\\"https://www.chiefdelphi.com/uploads/default/optimized/3X/4/2/4229aec3fd9d7121a52a0d0ae7cf3a437469e16f_2_690x259.png\\\" alt=\\\"image\\\" data-base62-sha1=\\\"9riOHwOo2GPaUW7bEAdCF4LnKMv\\\" width=\\\"690\\\" height=\\\"259\\\" srcset=\\\"https://www.chiefdelphi.com/uploads/default/optimized/3X/4/2/4229aec3fd9d7121a52a0d0ae7cf3a437469e16f_2_690x259.png, https://www.chiefdelphi.com/uploads/default/optimized/3X/4/2/4229aec3fd9d7121a52a0d0ae7cf3a437469e16f_2_1035x388.png 1.5x, https://www.chiefdelphi.com/uploads/default/optimized/3X/4/2/4229aec3fd9d7121a52a0d0ae7cf3a437469e16f_2_1380x518.png 2x\\\" data-dominant-color=\\\"252729\\\"\\u003e\\u003cdiv class=\\\"meta\\\"\\u003e\\u003csvg class=\\\"fa d-icon d-icon-far-image svg-icon\\\" aria-hidden=\\\"true\\\"\\u003e\\u003cuse href=\\\"#far-image\\\"\\u003e\\u003c/use\\u003e\\u003c/svg\\u003e\\u003cspan class=\\\"filename\\\"\\u003eimage\\u003c/span\\u003e\\u003cspan class=\\\"informations\\\"\\u003e2333×876 212 KB\\u003c/span\\u003e\\u003csvg class=\\\"fa d-icon d-icon-discourse-expand svg-icon\\\" aria-hidden=\\\"true\\\"\\u003e\\u003cuse href=\\\"#discourse-expand\\\"\\u003e\\u003c/use\\u003e\\u003c/svg\\u003e\\u003c/div\\u003e\\u003c/a\\u003e\\u003c/div\\u003e\\u003cbr\\u003e\\nIt is an open-loop operation. We found that if you make it close-loop by replacing the current desired chassis angular speed with the actual angular speed, and your controller isn’t very accurate, it will not work. For example, if the desired speed is 2 rad/s, but your robot goes up to 3 rad/s, and the algorithm tries to slow it down by setting it to 2.5 rad/s, it will actually go faster.\\u003c/p\\u003e\",\"post_number\":20,\"post_type\":1,\"posts_count\":34,\"updated_at\":\"2024-09-29T03:49:43.242Z\",\"reply_count\":0,\"reply_to_post_number\":19,\"quote_count\":0,\"incoming_link_count\":0,\"reads\":130,\"readers_count\":129,\"score\":26.0,\"yours\":false,\"topic_id\":472069,\"topic_slug\":\"best-pid-profile-for-in-place-turns\",\"display_username\":\"Geoffrey\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":1,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"read\":true,\"user_title\":\"\",\"reply_to_user\":{\"id\":50762,\"username\":\"atsekhan\",\"name\":\"Alex Tsekhansky\",\"avatar_template\":\"/letter_avatar_proxy/v4/letter/a/0ea827/{size}.png\"},\"bookmarked\":false,\"actions_summary\":[],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":60663,\"hidden\":false,\"trust_level\":2,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"user_custom_fields\":{\"user_field_4\":\"\"},\"post_url\":\"/t/best-pid-profile-for-in-place-turns/472069/20\",\"custom_user_title\":null,\"reactions\":[],\"current_user_reaction\":null,\"reaction_users_count\":0,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":null}],\"stream\":[3428658,3428662,3428679,3428682,3428691,3428694,3428696,3428732,3428740,3428744,3428745,3428747,3428754,3428758,3428759,3428771,3428774,3428775,3428777,3428783,3428784,3428787,3428789,3428790,3428793,3428794,3428802,3428855,3428857,3428861,3431686,3432305,3432399,3757787]},\"timeline_lookup\":[[1,378],[28,377],[31,370],[32,369],[33,368],[34,3]],\"tags\":[\"robot\",\"swerve\",\"pid\"],\"tags_descriptions\":{},\"fancy_title\":\"Best PID profile for in-place turns?\",\"id\":472069,\"title\":\"Best PID profile for in-place turns?\",\"posts_count\":34,\"created_at\":\"2024-09-28T16:09:46.246Z\",\"views\":946,\"reply_count\":27,\"like_count\":21,\"last_posted_at\":\"2025-10-08T14:43:57.106Z\",\"visible\":true,\"closed\":true,\"archived\":false,\"has_summary\":false,\"archetype\":\"regular\",\"slug\":\"best-pid-profile-for-in-place-turns\",\"category_id\":25,\"word_count\":3314,\"deleted_at\":null,\"user_id\":50762,\"featured_link\":null,\"pinned_globally\":false,\"pinned_at\":null,\"pinned_until\":null,\"image_url\":null,\"slow_mode_seconds\":0,\"draft\":null,\"draft_key\":\"topic_472069\",\"draft_sequence\":null,\"unpinned\":null,\"pinned\":false,\"current_post_number\":1,\"highest_post_number\":34,\"deleted_by\":null,\"actions_summary\":[{\"id\":4,\"count\":0,\"hidden\":false,\"can_act\":false},{\"id\":8,\"count\":0,\"hidden\":false,\"can_act\":false},{\"id\":10,\"count\":0,\"hidden\":false,\"can_act\":false},{\"id\":7,\"count\":0,\"hidden\":false,\"can_act\":false}],\"chunk_size\":20,\"bookmarked\":false,\"topic_timer\":null,\"message_bus_last_id\":4,\"participant_count\":7,\"show_read_indicator\":false,\"thumbnails\":null,\"slow_mode_enabled_until\":null,\"valid_reactions\":[\"heart\",\"laughing\",\"point_up\",\"+1\",\"-1\",\"100\",\"open_mouth\",\"cry\",\"question\",\"thinking\",\"call_me_hand\",\"hugs\",\"angry\"],\"user_chosen_thumbnail_url\":null,\"sidecar_installed\":true,\"can_vote\":false,\"vote_count\":0,\"user_voted\":false,\"discourse_zendesk_plugin_zendesk_id\":null,\"discourse_zendesk_plugin_zendesk_url\":\"https://your-url.zendesk.com/agent/tickets/\",\"details\":{\"can_edit\":false,\"notification_level\":1,\"participants\":[{\"id\":50762,\"username\":\"atsekhan\",\"name\":\"Alex Tsekhansky\",\"avatar_template\":\"/letter_avatar_proxy/v4/letter/a/0ea827/{size}.png\",\"post_count\":15,\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_color\":null,\"flair_bg_color\":null,\"flair_group_id\":null,\"trust_level\":2},{\"id\":24613,\"username\":\"viggy96\",\"name\":\"viggy96\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/viggy96/{size}/252784_2.png\",\"post_count\":7,\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_color\":null,\"flair_bg_color\":null,\"flair_group_id\":null,\"trust_level\":2},{\"id\":60033,\"username\":\"catrix\",\"name\":\"sam liu\",\"avatar_template\":\"/letter_avatar_proxy/v4/letter/c/dbc845/{size}.png\",\"post_count\":4,\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_color\":null,\"flair_bg_color\":null,\"flair_group_id\":null,\"trust_level\":2},{\"id\":48146,\"username\":\"bhall-ctre\",\"name\":\"Benjamin Hall\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/bhall-ctre/{size}/198180_2.png\",\"post_count\":3,\"primary_group_name\":\"CTRE\",\"flair_name\":\"CTRE\",\"flair_url\":\"/uploads/default/original/3X/1/b/1bd2b430e1bb6427d1c6504ff6abcd31de851a6d.png\",\"flair_color\":\"\",\"flair_bg_color\":\"\",\"flair_group_id\":57,\"trust_level\":2},{\"id\":60663,\"username\":\"Geoffrey8814\",\"name\":\"Geoffrey\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/geoffrey8814/{size}/262430_2.png\",\"post_count\":2,\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_color\":null,\"flair_bg_color\":null,\"flair_group_id\":null,\"trust_level\":2},{\"id\":12381,\"username\":\"Oblarg\",\"name\":\"Eli Barnett\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/oblarg/{size}/161674_2.png\",\"post_count\":1,\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_color\":null,\"flair_bg_color\":null,\"flair_group_id\":null,\"trust_level\":2},{\"id\":53190,\"username\":\"truher\",\"name\":\"joel truher\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/truher/{size}/172222_2.png\",\"post_count\":1,\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_color\":null,\"flair_bg_color\":null,\"flair_group_id\":null,\"trust_level\":2}],\"created_by\":{\"id\":50762,\"username\":\"atsekhan\",\"name\":\"Alex Tsekhansky\",\"avatar_template\":\"/letter_avatar_proxy/v4/letter/a/0ea827/{size}.png\"},\"last_poster\":{\"id\":-1,\"username\":\"system\",\"name\":\"system\",\"avatar_template\":\"/uploads/default/original/4X/9/3/2/93234578e69f55873c63fc00fe2d0d85f23bce55.png\"},\"links\":[{\"url\":\"https://github.com/lasarobotics/PH2024\",\"title\":\"GitHub - lasarobotics/PH2024: 2024 Purple Haze FRC\",\"internal\":false,\"attachment\":false,\"reflection\":false,\"clicks\":14,\"user_id\":24613,\"domain\":\"github.com\",\"root_domain\":\"github.com\"},{\"url\":\"https://github.com/FRC999/2025SwervePrototype/blob/CharacterizationSysID/src/main/java/frc/robot/commands/TurnToRelativeAngleSoftwarePIDCommand.java\",\"title\":\"2025SwervePrototype/src/main/java/frc/robot/commands/TurnToRelativeAngleSoftwarePIDCommand.java at CharacterizationSysID · FRC999/2025SwervePrototype · GitHub\",\"internal\":false,\"attachment\":false,\"reflection\":false,\"clicks\":5,\"user_id\":50762,\"domain\":\"github.com\",\"root_domain\":\"github.com\"},{\"url\":\"https://github.com/lasarobotics/PurpleLib/blob/master/src/main/java/org/lasarobotics/drive/RotatePIDController.java\",\"title\":\"PurpleLib/src/main/java/org/lasarobotics/drive/RotatePIDController.java at master · lasarobotics/PurpleLib · GitHub\",\"internal\":false,\"attachment\":false,\"reflection\":false,\"clicks\":5,\"user_id\":50762,\"domain\":\"github.com\",\"root_domain\":\"github.com\"},{\"url\":\"https://github.com/CrossTheRoadElec/Phoenix6-Examples/blob/main/java/SwerveWithPathPlanner/src/main/java/frc/robot/generated/TunerConstants.java#L29\",\"title\":\"Phoenix6-Examples/java/SwerveWithPathPlanner/src/main/java/frc/robot/generated/TunerConstants.java at main · CrossTheRoadElec/Phoenix6-Examples · GitHub\",\"internal\":false,\"attachment\":false,\"reflection\":false,\"clicks\":2,\"user_id\":48146,\"domain\":\"github.com\",\"root_domain\":\"github.com\"},{\"url\":\"https://github.com/FRC999/2025SwervePrototype/tree/CharacterizationSysID/src/main/java/frc/robot\",\"title\":\"2025SwervePrototype/src/main/java/frc/robot at CharacterizationSysID · FRC999/2025SwervePrototype · GitHub\",\"internal\":false,\"attachment\":false,\"reflection\":false,\"clicks\":1,\"user_id\":50762,\"domain\":\"github.com\",\"root_domain\":\"github.com\"},{\"url\":\"https://github.com/lasarobotics/PH2024/blob/24e0d98e8d80e3ff622deb30bc7d4698abcc7f74/src/main/java/frc/robot/Constants.java#L127\",\"title\":\"PH2024/src/main/java/frc/robot/Constants.java at 24e0d98e8d80e3ff622deb30bc7d4698abcc7f74 · lasarobotics/PH2024 · GitHub\",\"internal\":false,\"attachment\":false,\"reflection\":false,\"clicks\":1,\"user_id\":50762,\"domain\":\"github.com\",\"root_domain\":\"github.com\"}]},\"bookmarks\":[]}"}
