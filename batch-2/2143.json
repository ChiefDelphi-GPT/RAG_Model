{"data":"{\"post_stream\":{\"posts\":[{\"id\":3416379,\"name\":\"Warrior \",\"username\":\"FRCnew\",\"avatar_template\":\"/letter_avatar_proxy/v4/letter/f/43a26b/{size}.png\",\"created_at\":\"2024-08-19T06:55:04.714Z\",\"cooked\":\"\\u003chr\\u003e\\n\\u003cp\\u003eThis is our first attempt at using feedforward control for our arm mechanism. We’ve written the following code:\\u003c/p\\u003e\\n\\u003cpre data-code-wrap=\\\"java\\\"\\u003e\\u003ccode class=\\\"lang-java\\\"\\u003epackage frc.robot.subsystems;\\n\\nimport com.revrobotics.AbsoluteEncoder;\\nimport com.revrobotics.CANSparkMax;\\nimport com.revrobotics.CANSparkLowLevel.MotorType;\\nimport com.revrobotics.SparkAbsoluteEncoder.Type;\\n\\nimport edu.wpi.first.math.controller.ProfiledPIDController;\\nimport edu.wpi.first.math.trajectory.TrapezoidProfile;\\nimport edu.wpi.first.wpilibj2.command.Command;\\nimport edu.wpi.first.wpilibj2.command.ProfiledPIDSubsystem;\\nimport frc.robot.Commandlib.NormalCommand;\\n\\npublic class ShooterArmPivotSubsystem extends ProfiledPIDSubsystem {\\n\\n    private final CANSparkMax motor;\\n    private final AbsoluteEncoder absoluteEncoder;\\n\\n    // Feedforward control parameters\\n    private double Ks;\\n    private double Kv;\\n    private double Kg;\\n    private double Kacc;\\n\\n    public ShooterArmPivotSubsystem(double Ks, double Kv, double Kg, double Kacc) {\\n        super(\\n                new ProfiledPIDController(\\n                        0.0, 0.0, 0.0,\\n                        new TrapezoidProfile.Constraints(2.0, 1.0) // Set velocity and acceleration constraints\\n                ));\\n        this.Ks = Ks;\\n        this.Kv = Kv;\\n        this.Kg = Kg;\\n        this.Kacc = Kacc;\\n\\n        motor = new CANSparkMax(1, MotorType.kBrushless);\\n        absoluteEncoder = motor.getAbsoluteEncoder(Type.kDutyCycle);\\n\\n        // Set PID parameters\\n        getController().setTolerance(0.3); // Set tolerance\\n\\n        // Set motor to \\\"Coast\\\" mode for testing Kg\\n        motor.setIdleMode(CANSparkMax.IdleMode.kCoast);\\n    }\\n\\n    public void adjustKg(double newKg) {\\n        this.Kg = newKg;\\n    }\\n\\n    @Override\\n    public void useOutput(double output, TrapezoidProfile.State setpoint) {\\n        double feedforwardOutput = calculateFeedForward(setpoint.position, setpoint.velocity, 0);\\n        motor.setVoltage(output + feedforwardOutput);\\n    }\\n\\n    @Override\\n    public double getMeasurement() {\\n        return absoluteEncoder.getPosition();\\n    }\\n\\n    /**\\n     * Calculate feedforward control output\\n     * \\n     * @param angle     Angle (radians)\\n     * @param velWanted Target velocity (rad/s)\\n     * @param accRobot  Robot acceleration (rad/s^2)\\n     * @return Feedforward control output\\n     */\\n    private double calculateFeedForward(double angle, double velWanted, double accRobot) {\\n        return Ks * Math.signum(velWanted)\\n                + Kv * velWanted\\n                + Kg * Math.cos(angle)\\n                + Kacc * accRobot * Math.sin(angle);\\n    }\\n\\n    @Override\\n    public void periodic() {\\n        super.periodic();\\n    }\\n\\n    private void StopMotor() {\\n        motor.stopMotor();\\n    }\\n\\n    public Command armPIDcontrol(double Angle) {\\n        double goal = Math.toDegrees(Angle);\\n        return NormalCommand.startRunEndRequirements(\\n            () -\\u0026gt; System.out.println(\\\"ArmPIDStart\\\"), \\n            () -\\u0026gt; {\\n            this.setGoal(goal);\\n            this.enable();\\n            },\\n            (interrupted) -\\u0026gt; this.StopMotor(), \\n            () -\\u0026gt; getController().atGoal());\\n    }\\n}\\n\\u003c/code\\u003e\\u003c/pre\\u003e\\n\\u003cp\\u003eWe’re not entirely sure if this approach will work or how we should adjust the parameters to test it effectively. If anyone has any suggestions or advice, it would be greatly appreciated!\\u003c/p\\u003e\\n\\u003cp\\u003eThanks in advance!\\u003c/p\\u003e\\n\\u003chr\\u003e\",\"post_number\":1,\"post_type\":1,\"posts_count\":20,\"updated_at\":\"2024-08-19T06:55:04.714Z\",\"reply_count\":0,\"reply_to_post_number\":null,\"quote_count\":0,\"incoming_link_count\":75,\"reads\":184,\"readers_count\":183,\"score\":411.8,\"yours\":false,\"topic_id\":469988,\"topic_slug\":\"feedforward-issue-with-a-sparkmax-controlled-arm-motor\",\"display_username\":\"Warrior \",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":1,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"read\":true,\"user_title\":null,\"bookmarked\":false,\"actions_summary\":[],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":60347,\"hidden\":false,\"trust_level\":1,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"post_url\":\"/t/feedforward-issue-with-a-sparkmax-controlled-arm-motor/469988/1\",\"custom_user_title\":null,\"reactions\":[],\"current_user_reaction\":null,\"reaction_users_count\":0,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":null,\"can_vote\":false},{\"id\":3416383,\"name\":\"Yishai Levy\",\"username\":\"levyishai\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/levyishai/{size}/264719_2.png\",\"created_at\":\"2024-08-19T10:02:52.719Z\",\"cooked\":\"\\u003cp\\u003eOne problem I’ve spotted is that you update your controller’s measurement by rotations from the encoder, but when applying the feedforward calculation, \\u003ccode\\u003eMath.cos\\u003c/code\\u003e requires radians.\\u003c/p\\u003e\\n\\u003cp\\u003eI would highly suggest moving away from ProfiledPIDSubystem. Writing the code yourself will give you more control over what’s happening and a better understanding of how everything operates.\\u003cbr\\u003e\\nBest practice IMO is writing the code yourself, and even a more readable approach.\\u003c/p\\u003e\\n\\u003cp\\u003eFor adjusting params, you can find all the feedforward gains (kS, kV, kG and kA) using SysID, and add a bit of a kP to the controller for feedback control. I would also make sure to reset the controller when the command initializes.\\u003c/p\\u003e\",\"post_number\":2,\"post_type\":1,\"posts_count\":20,\"updated_at\":\"2024-08-19T10:03:26.850Z\",\"reply_count\":1,\"reply_to_post_number\":null,\"quote_count\":0,\"incoming_link_count\":0,\"reads\":161,\"readers_count\":160,\"score\":37.2,\"yours\":false,\"topic_id\":469988,\"topic_slug\":\"feedforward-issue-with-a-sparkmax-controlled-arm-motor\",\"display_username\":\"Yishai Levy\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":1,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"read\":true,\"user_title\":\"\",\"bookmarked\":false,\"actions_summary\":[],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":57809,\"hidden\":false,\"trust_level\":2,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"user_custom_fields\":{\"user_field_4\":\"Team Captain, Programming Lead \\u0026 Operator\"},\"post_url\":\"/t/feedforward-issue-with-a-sparkmax-controlled-arm-motor/469988/2\",\"custom_user_title\":\"Team Captain, Programming Lead \\u0026 Operator\",\"reactions\":[],\"current_user_reaction\":null,\"reaction_users_count\":0,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":null},{\"id\":3416386,\"name\":\"Warrior \",\"username\":\"FRCnew\",\"avatar_template\":\"/letter_avatar_proxy/v4/letter/f/43a26b/{size}.png\",\"created_at\":\"2024-08-19T11:34:41.256Z\",\"cooked\":\"\\u003chr\\u003e\\n\\u003cp\\u003eWe’ve tried to rewrite the code based on your suggestions:\\u003c/p\\u003e\\n\\u003cpre data-code-wrap=\\\"java\\\"\\u003e\\u003ccode class=\\\"lang-java\\\"\\u003epackage frc.robot.subsystems;\\n\\nimport com.revrobotics.AbsoluteEncoder;\\nimport com.revrobotics.CANSparkMax;\\nimport com.revrobotics.CANSparkLowLevel.MotorType;\\nimport com.revrobotics.SparkPIDController;\\n\\nimport edu.wpi.first.math.controller.ArmFeedforward;\\nimport edu.wpi.first.wpilibj2.command.SubsystemBase;\\nimport edu.wpi.first.wpilibj2.command.Command;\\nimport frc.robot.Commandlib.NormalCommand;\\n\\npublic class ShooterArmPivotSubsystem extends SubsystemBase {\\n\\n    private final CANSparkMax motor;\\n    private final AbsoluteEncoder absoluteEncoder;\\n    private final SparkPIDController pidController;\\n\\n    private final ArmFeedforward feedforward;\\n\\n    public ShooterArmPivotSubsystem(double Ks, double Kv, double Kg, double Kacc, double kP) {\\n        // Initialize the motor and encoder\\n        motor = new CANSparkMax(1, MotorType.kBrushless);\\n        absoluteEncoder = motor.getAbsoluteEncoder();\\n        pidController = motor.getPIDController();\\n\\n        // Set the position conversion factor to convert encoder units to radians\\n        absoluteEncoder.setPositionConversionFactor(Math.toRadians(360));\\n\\n        // Initialize the feedforward controller with provided gains\\n        feedforward = new ArmFeedforward(Ks, Kv, Kg, Kacc);\\n\\n        // Set the PID controller parameters\\n        pidController.setP(kP);\\n        pidController.setTolerance(0.3);\\n\\n        // Set the motor to \\\"Coast\\\" mode for testing gravity compensation (Kg)\\n        motor.setIdleMode(CANSparkMax.IdleMode.kCoast);\\n    }\\n\\n    /**\\n     * Sets the target goal for the arm in radians.\\n     * \\n     * @param radians Target angle in radians.\\n     */\\n    public void setGoal(double radians) {\\n        pidController.setReference(radians, CANSparkMax.ControlType.kPosition);\\n    }\\n\\n    @Override\\n    public void periodic() {\\n        // Get the current angle in radians directly from the encoder\\n        double currentAngleRadians = absoluteEncoder.getPosition();\\n        // Calculate the feedforward output based on the current angle, velocity, and acceleration\\n        double feedforwardOutput = feedforward.calculate(currentAngleRadians, 0, 0);\\n\\n        // Apply the combined feedforward and PID output to the motor\\n        pidController.setReference(feedforwardOutput, CANSparkMax.ControlType.kVoltage);\\n    }\\n\\n    /**\\n     * Creates a command to control the arm position using PID.\\n     * \\n     * @param angleRadians Desired target angle in radians.\\n     * @return A command to control the arm position.\\n     */\\n    public Command armPIDcontrol(double angleRadians) {\\n        return NormalCommand.startRunEndRequirements(\\n            () -\\u0026gt; System.out.println(\\\"ArmPIDStart\\\"), \\n            () -\\u0026gt; {\\n            this.setGoal(angleRadians);\\n            },\\n            (interrupted) -\\u0026gt; motor.stopMotor(), \\n            () -\\u0026gt; pidController.atSetpoint());\\n    }\\n}\\n\\u003c/code\\u003e\\u003c/pre\\u003e\\n\\u003cp\\u003eHowever, I’m still not quite sure how to effectively combine feedforward with \\u003cspan class=\\\"abbreviation\\\"\\u003ePID\\u003ctemplate class=\\\"tooltiptext\\\" data-text=\\\"Proportional Integral Derivative\\\"\\u003e\\u003c/template\\u003e\\u003c/span\\u003e control. In our current design, we apply the feedforward output directly as voltage, while using the \\u003cspan class=\\\"abbreviation\\\"\\u003ePID\\u003ctemplate class=\\\"tooltiptext\\\" data-text=\\\"Proportional Integral Derivative\\\"\\u003e\\u003c/template\\u003e\\u003c/span\\u003e controller for position control. But this setup seems to risk having the feedforward output overpower the \\u003cspan class=\\\"abbreviation\\\"\\u003ePID\\u003ctemplate class=\\\"tooltiptext\\\" data-text=\\\"Proportional Integral Derivative\\\"\\u003e\\u003c/template\\u003e\\u003c/span\\u003e control, especially during small angle adjustments or when high precision is required. How should we balance the feedforward and \\u003cspan class=\\\"abbreviation\\\"\\u003ePID\\u003ctemplate class=\\\"tooltiptext\\\" data-text=\\\"Proportional Integral Derivative\\\"\\u003e\\u003c/template\\u003e\\u003c/span\\u003e outputs to ensure precision without causing control conflicts?\\u003c/p\\u003e\\n\\u003chr\\u003e\",\"post_number\":3,\"post_type\":1,\"posts_count\":20,\"updated_at\":\"2024-08-19T11:34:41.256Z\",\"reply_count\":1,\"reply_to_post_number\":2,\"quote_count\":0,\"incoming_link_count\":2,\"reads\":152,\"readers_count\":151,\"score\":45.4,\"yours\":false,\"topic_id\":469988,\"topic_slug\":\"feedforward-issue-with-a-sparkmax-controlled-arm-motor\",\"display_username\":\"Warrior \",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":1,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"read\":true,\"user_title\":null,\"reply_to_user\":{\"id\":57809,\"username\":\"levyishai\",\"name\":\"Yishai Levy\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/levyishai/{size}/264719_2.png\"},\"bookmarked\":false,\"actions_summary\":[],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":60347,\"hidden\":false,\"trust_level\":1,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"post_url\":\"/t/feedforward-issue-with-a-sparkmax-controlled-arm-motor/469988/3\",\"custom_user_title\":null,\"reactions\":[],\"current_user_reaction\":null,\"reaction_users_count\":0,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":null},{\"id\":3416387,\"name\":\"Yishai Levy\",\"username\":\"levyishai\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/levyishai/{size}/264719_2.png\",\"created_at\":\"2024-08-19T11:42:50.168Z\",\"cooked\":\"\\u003cp\\u003eFor tuning, I would use the FF SysID gains, and just adjust the P to have more versatile control and for that small precision. The FF should get you most of the way to your goal, and the P would fix the small inaccuracies that happen.\\u003c/p\\u003e\\n\\u003cp\\u003eOne more thing I would suggest is not having anything in \\u003ccode\\u003eperiodic\\u003c/code\\u003e that controls hardware or moves a motor. This is risky, and not really how you should operate with command-based. The better approach IMO is calling \\u003ccode\\u003econtroller.reset\\u003c/code\\u003e and \\u003ccode\\u003econtroller.setGoal\\u003c/code\\u003e in the \\u003ccode\\u003eonInit\\u003c/code\\u003e of a \\u003ccode\\u003eFunctionalCommand\\u003c/code\\u003e, call a function to apply all the gains and follow the profile in the command’s \\u003ccode\\u003eonExecute\\u003c/code\\u003e, and stop the motor \\u003ccode\\u003eonEnd\\u003c/code\\u003e. You can also add an \\u003ccode\\u003eisFinished\\u003c/code\\u003e for when you reach the target, but keep in mind that your arm might fall when you reach the target and the motor stops applying \\u003ccode\\u003ekG\\u003c/code\\u003e.\\u003c/p\\u003e\",\"post_number\":4,\"post_type\":1,\"posts_count\":20,\"updated_at\":\"2024-08-19T11:42:50.168Z\",\"reply_count\":0,\"reply_to_post_number\":3,\"quote_count\":0,\"incoming_link_count\":0,\"reads\":123,\"readers_count\":122,\"score\":54.6,\"yours\":false,\"topic_id\":469988,\"topic_slug\":\"feedforward-issue-with-a-sparkmax-controlled-arm-motor\",\"display_username\":\"Yishai Levy\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":1,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"read\":true,\"user_title\":\"\",\"reply_to_user\":{\"id\":60347,\"username\":\"FRCnew\",\"name\":\"Warrior \",\"avatar_template\":\"/letter_avatar_proxy/v4/letter/f/43a26b/{size}.png\"},\"bookmarked\":false,\"actions_summary\":[{\"id\":2,\"count\":2}],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":57809,\"hidden\":false,\"trust_level\":2,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"user_custom_fields\":{\"user_field_4\":\"Team Captain, Programming Lead \\u0026 Operator\"},\"post_url\":\"/t/feedforward-issue-with-a-sparkmax-controlled-arm-motor/469988/4\",\"custom_user_title\":\"Team Captain, Programming Lead \\u0026 Operator\",\"reactions\":[{\"id\":\"heart\",\"type\":\"emoji\",\"count\":2}],\"current_user_reaction\":null,\"reaction_users_count\":2,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":null},{\"id\":3416408,\"name\":\"paulonis\",\"username\":\"paulonis\",\"avatar_template\":\"/letter_avatar_proxy/v4/letter/p/5fc32e/{size}.png\",\"created_at\":\"2024-08-19T14:10:28.401Z\",\"cooked\":\"\\u003cp\\u003eYour pidController.setReference in periodic is not correct.  The first argument should be the desired position.  The feedforward voltage is passed in a separate argument \\u003ca href=\\\"https://codedocs.revrobotics.com/java/com/revrobotics/sparkpidcontroller#setReference(double,com.revrobotics.CANSparkBase.ControlType,int,double)\\\" rel=\\\"noopener nofollow ugc\\\"\\u003eas shown in the documentation\\u003c/a\\u003e.\\u003c/p\\u003e\\n\\u003cp\\u003eThe feedforward output should be dominant.  If your feedforward model is excellent, the \\u003cspan class=\\\"abbreviation\\\"\\u003ePID\\u003ctemplate class=\\\"tooltiptext\\\" data-text=\\\"Proportional Integral Derivative\\\"\\u003e\\u003c/template\\u003e\\u003c/span\\u003e feedback should do almost nothing, with the output staying near zero volts at all times.\\u003c/p\\u003e\\n\\u003cp\\u003eThe way your code is written, you are technically using the feedforward model as feedback linearization for the effect of gravity on the arm since you are passing currentAngleRadians as the position argument.  To use it as true feedforward, you would need to pass the position setpoint.  What you are doing is probably best since you don’t have a trapezoidal profile for your arm setpoint.  If you pass a position setpoint to the feedforward calculation that is only reachable in the future because the arm motor can’t spin infinitely quickly, you may do more harm than good.  However, if you pass position and velocity targets computed from a trapeziodal velocity profile which is achievable, feedforward will work best.  You may want to look \\u003ca href=\\\"https://www.chiefdelphi.com/t/arm-gravity-feedforward-w-neo-motors/454727\\\"\\u003eat this \\u003cspan class=\\\"abbreviation\\\"\\u003eCD\\u003ctemplate class=\\\"tooltiptext\\\" data-text=\\\"Chief Delphi\\\"\\u003e\\u003c/template\\u003e\\u003c/span\\u003e thread\\u003c/a\\u003e for additional comments.\\u003c/p\\u003e\\n\\u003cp\\u003eLastly, you may want to start your journey toward getting good feedforward model parameters by using the \\u003ca href=\\\"https://www.reca.lc/arm\\\" rel=\\\"noopener nofollow ugc\\\"\\u003ereca.lc arm calculator\\u003c/a\\u003e.  By putting in decent estimates of your arm center of mass distance from the pivot and the the arm mass, you will be in the ballpark with the computed FF parameters at the bottom of the page.  You can still attempt sysID on the arm if you want, but you need to be careful and make sure you have SparkMAX features to stop moving the arm before it hits physical stops (e.g. soft rotation limits or hard limits based on sensors).  I personally prefer to start with the estimates from reca.lc and then tune those by moving the arm under combined FF + FB control and adjusting the FF model parameters (usually not by much) until the FB output stays reasonably close to zero when the arm is parallel to the ground (kG), and then when moving to other positions (kV).\\u003c/p\\u003e\",\"post_number\":5,\"post_type\":1,\"posts_count\":20,\"updated_at\":\"2024-08-19T14:10:28.401Z\",\"reply_count\":1,\"reply_to_post_number\":null,\"quote_count\":0,\"incoming_link_count\":7,\"reads\":118,\"readers_count\":117,\"score\":63.6,\"yours\":false,\"topic_id\":469988,\"topic_slug\":\"feedforward-issue-with-a-sparkmax-controlled-arm-motor\",\"display_username\":\"paulonis\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":1,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"link_counts\":[{\"url\":\"https://codedocs.revrobotics.com/java/com/revrobotics/sparkpidcontroller#setReference(double,com.revrobotics.CANSparkBase.ControlType,int,double)\",\"internal\":false,\"reflection\":false,\"title\":\"SparkPIDController (FRC-REVLib API)\",\"clicks\":8},{\"url\":\"https://www.chiefdelphi.com/t/arm-gravity-feedforward-w-neo-motors/454727\",\"internal\":true,\"reflection\":false,\"title\":\"Arm Gravity Feedforward w NEO motors\",\"clicks\":4},{\"url\":\"https://www.reca.lc/arm\",\"internal\":false,\"reflection\":false,\"title\":\"ReCalc\",\"clicks\":2}],\"read\":true,\"user_title\":\"\",\"bookmarked\":false,\"actions_summary\":[],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":22261,\"hidden\":false,\"trust_level\":2,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"post_url\":\"/t/feedforward-issue-with-a-sparkmax-controlled-arm-motor/469988/5\",\"custom_user_title\":null,\"reactions\":[],\"current_user_reaction\":null,\"reaction_users_count\":0,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":null},{\"id\":3416410,\"name\":\"Anand Rajamani\",\"username\":\"asid61\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/asid61/{size}/7179_2.png\",\"created_at\":\"2024-08-19T14:15:00.788Z\",\"cooked\":\"\\u003cp\\u003eQuick correction: for kG, you definitely want to pass in your current position so that your kV and kA can create the actual motion profile. This is to avoid a case where your arm is 180deg off and feeding forward in the wrong direction into a hardstop.\\u003c/p\\u003e\\n\\u003cp\\u003eTo OP: start with manually finding kG such that the arm stays still when you don’t apply any other output. Then do sysID on top of that or roughly calculate kV and kA based on your motor and gear ratio (recalc does this for you!). Then add some P control. You can also do P before kV and kA. And honestly, kA is probably wholly unnecessary for an arm.\\u003c/p\\u003e\\n\\u003cp\\u003eThere is no need at all to write your own profiled \\u003cspan class=\\\"abbreviation\\\"\\u003ePID\\u003ctemplate class=\\\"tooltiptext\\\" data-text=\\\"Proportional Integral Derivative\\\"\\u003e\\u003c/template\\u003e\\u003c/span\\u003e controller from scratch. Nothing wrong with starting simple here with the library.\\u003c/p\\u003e\",\"post_number\":6,\"post_type\":1,\"posts_count\":20,\"updated_at\":\"2024-08-19T14:16:14.732Z\",\"reply_count\":1,\"reply_to_post_number\":5,\"quote_count\":0,\"incoming_link_count\":1,\"reads\":99,\"readers_count\":98,\"score\":44.8,\"yours\":false,\"topic_id\":469988,\"topic_slug\":\"feedforward-issue-with-a-sparkmax-controlled-arm-motor\",\"display_username\":\"Anand Rajamani\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":1,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"read\":true,\"user_title\":\"\",\"reply_to_user\":{\"id\":22261,\"username\":\"paulonis\",\"name\":\"paulonis\",\"avatar_template\":\"/letter_avatar_proxy/v4/letter/p/5fc32e/{size}.png\"},\"bookmarked\":false,\"actions_summary\":[{\"id\":2,\"count\":1}],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":21715,\"hidden\":false,\"trust_level\":2,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"user_custom_fields\":{\"user_field_4\":\"\"},\"post_url\":\"/t/feedforward-issue-with-a-sparkmax-controlled-arm-motor/469988/6\",\"custom_user_title\":null,\"reactions\":[{\"id\":\"heart\",\"type\":\"emoji\",\"count\":1}],\"current_user_reaction\":null,\"reaction_users_count\":1,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":null},{\"id\":3416424,\"name\":\"paulonis\",\"username\":\"paulonis\",\"avatar_template\":\"/letter_avatar_proxy/v4/letter/p/5fc32e/{size}.png\",\"created_at\":\"2024-08-19T14:51:15.812Z\",\"cooked\":\"\\u003cp\\u003eThe intended way to use ArmFeedforward is with the arm position and velocity setpoints as shown in the \\u003ca href=\\\"https://docs.wpilib.org/en/stable/docs/software/advanced-controls/introduction/tuning-vertical-arm.html\\\" rel=\\\"noopener nofollow ugc\\\"\\u003earm control documentation in WPILib\\u003c/a\\u003e.  The feedforward model gets r(t), not y(t).\\u003c/p\\u003e\\n\\u003cp\\u003e\\u003cdiv class=\\\"lightbox-wrapper\\\"\\u003e\\u003ca class=\\\"lightbox\\\" href=\\\"https://www.chiefdelphi.com/uploads/default/original/3X/5/9/59f90c6fa128837b9f5e2d358f16a5ae5bf5ed48.png\\\" data-download-href=\\\"https://www.chiefdelphi.com/uploads/default/59f90c6fa128837b9f5e2d358f16a5ae5bf5ed48\\\" title=\\\"image\\\"\\u003e\\u003cimg src=\\\"https://www.chiefdelphi.com/uploads/default/optimized/3X/5/9/59f90c6fa128837b9f5e2d358f16a5ae5bf5ed48_2_690x310.png\\\" alt=\\\"image\\\" data-base62-sha1=\\\"cPW4TD5Qop7550OvHHi6JgldCPK\\\" width=\\\"690\\\" height=\\\"310\\\" srcset=\\\"https://www.chiefdelphi.com/uploads/default/optimized/3X/5/9/59f90c6fa128837b9f5e2d358f16a5ae5bf5ed48_2_690x310.png, https://www.chiefdelphi.com/uploads/default/original/3X/5/9/59f90c6fa128837b9f5e2d358f16a5ae5bf5ed48.png 1.5x, https://www.chiefdelphi.com/uploads/default/original/3X/5/9/59f90c6fa128837b9f5e2d358f16a5ae5bf5ed48.png 2x\\\" data-dominant-color=\\\"F5F5F5\\\"\\u003e\\u003cdiv class=\\\"meta\\\"\\u003e\\u003csvg class=\\\"fa d-icon d-icon-far-image svg-icon\\\" aria-hidden=\\\"true\\\"\\u003e\\u003cuse href=\\\"#far-image\\\"\\u003e\\u003c/use\\u003e\\u003c/svg\\u003e\\u003cspan class=\\\"filename\\\"\\u003eimage\\u003c/span\\u003e\\u003cspan class=\\\"informations\\\"\\u003e895×403 45.3 KB\\u003c/span\\u003e\\u003csvg class=\\\"fa d-icon d-icon-discourse-expand svg-icon\\\" aria-hidden=\\\"true\\\"\\u003e\\u003cuse href=\\\"#discourse-expand\\\"\\u003e\\u003c/use\\u003e\\u003c/svg\\u003e\\u003c/div\\u003e\\u003c/a\\u003e\\u003c/div\\u003e\\u003c/p\\u003e\\n\\u003cp\\u003eIf you have a potential problem with wrapping of your position, that should be handled, but it doesn’t mean that you can’t use true feedforward control.\\u003c/p\\u003e\\n\\u003cp\\u003eUsing a model for feedback linearization is certainly possible, but it’s not feedforward control.\\u003c/p\\u003e\\n\\u003cp\\u003e\\u003cdiv class=\\\"lightbox-wrapper\\\"\\u003e\\u003ca class=\\\"lightbox\\\" href=\\\"https://www.chiefdelphi.com/uploads/default/original/3X/e/7/e78aa6934959ef517b1c1d64a0851a748505deeb.png\\\" data-download-href=\\\"https://www.chiefdelphi.com/uploads/default/e78aa6934959ef517b1c1d64a0851a748505deeb\\\" title=\\\"image\\\"\\u003e\\u003cimg src=\\\"https://www.chiefdelphi.com/uploads/default/optimized/3X/e/7/e78aa6934959ef517b1c1d64a0851a748505deeb_2_690x192.png\\\" alt=\\\"image\\\" data-base62-sha1=\\\"x2jlUscaj2ndKuMJcVguvrM7rGH\\\" width=\\\"690\\\" height=\\\"192\\\" srcset=\\\"https://www.chiefdelphi.com/uploads/default/optimized/3X/e/7/e78aa6934959ef517b1c1d64a0851a748505deeb_2_690x192.png, https://www.chiefdelphi.com/uploads/default/original/3X/e/7/e78aa6934959ef517b1c1d64a0851a748505deeb.png 1.5x, https://www.chiefdelphi.com/uploads/default/original/3X/e/7/e78aa6934959ef517b1c1d64a0851a748505deeb.png 2x\\\" data-dominant-color=\\\"F2F0F0\\\"\\u003e\\u003cdiv class=\\\"meta\\\"\\u003e\\u003csvg class=\\\"fa d-icon d-icon-far-image svg-icon\\\" aria-hidden=\\\"true\\\"\\u003e\\u003cuse href=\\\"#far-image\\\"\\u003e\\u003c/use\\u003e\\u003c/svg\\u003e\\u003cspan class=\\\"filename\\\"\\u003eimage\\u003c/span\\u003e\\u003cspan class=\\\"informations\\\"\\u003e894×249 35.5 KB\\u003c/span\\u003e\\u003csvg class=\\\"fa d-icon d-icon-discourse-expand svg-icon\\\" aria-hidden=\\\"true\\\"\\u003e\\u003cuse href=\\\"#discourse-expand\\\"\\u003e\\u003c/use\\u003e\\u003c/svg\\u003e\\u003c/div\\u003e\\u003c/a\\u003e\\u003c/div\\u003e\\u003c/p\\u003e\",\"post_number\":7,\"post_type\":1,\"posts_count\":20,\"updated_at\":\"2024-08-19T14:51:15.812Z\",\"reply_count\":2,\"reply_to_post_number\":6,\"quote_count\":0,\"incoming_link_count\":2,\"reads\":99,\"readers_count\":98,\"score\":39.8,\"yours\":false,\"topic_id\":469988,\"topic_slug\":\"feedforward-issue-with-a-sparkmax-controlled-arm-motor\",\"display_username\":\"paulonis\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":1,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"link_counts\":[{\"url\":\"https://docs.wpilib.org/en/stable/docs/software/advanced-controls/introduction/tuning-vertical-arm.html\",\"internal\":false,\"reflection\":false,\"title\":\"Tuning a Vertical Arm Position Controller — FIRST Robotics Competition documentation\",\"clicks\":2}],\"read\":true,\"user_title\":\"\",\"reply_to_user\":{\"id\":21715,\"username\":\"asid61\",\"name\":\"Anand Rajamani\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/asid61/{size}/7179_2.png\"},\"bookmarked\":false,\"actions_summary\":[],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":22261,\"hidden\":false,\"trust_level\":2,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"post_url\":\"/t/feedforward-issue-with-a-sparkmax-controlled-arm-motor/469988/7\",\"custom_user_title\":null,\"reactions\":[],\"current_user_reaction\":null,\"reaction_users_count\":0,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":null},{\"id\":3416439,\"name\":\"Warrior \",\"username\":\"FRCnew\",\"avatar_template\":\"/letter_avatar_proxy/v4/letter/f/43a26b/{size}.png\",\"created_at\":\"2024-08-19T15:35:59.032Z\",\"cooked\":\"\\u003chr\\u003e\\n\\u003cp\\u003eThank you very much for your feedback. I’ve made some updates based on your suggestions:\\u003c/p\\u003e\\n\\u003cpre data-code-wrap=\\\"java\\\"\\u003e\\u003ccode class=\\\"lang-java\\\"\\u003epackage frc.robot.subsystems;\\n\\nimport com.revrobotics.CANSparkMax;\\nimport com.revrobotics.AbsoluteEncoder;\\nimport com.revrobotics.SparkPIDController;\\nimport com.revrobotics.CANSparkMax.ControlType;\\nimport com.revrobotics.CANSparkMax.IdleMode;\\nimport com.revrobotics.CANSparkMaxLowLevel.MotorType;\\n\\nimport edu.wpi.first.math.controller.ArmFeedforward;\\nimport edu.wpi.first.wpilibj2.command.Command;\\nimport edu.wpi.first.wpilibj2.command.SubsystemBase;\\nimport frc.robot.Commandlib.NormalCommand;\\n\\npublic class ShooterArmPivotSubsystem extends SubsystemBase {\\n\\n    private final CANSparkMax motor;\\n    private final AbsoluteEncoder absoluteEncoder;\\n    private final SparkPIDController pidController;\\n    private final ArmFeedforward feedforward;\\n\\n    private double setpointRadians = 0.0;\\n\\n    public ShooterArmPivotSubsystem(double Ks, double Kv, double Kg, double Kacc, double kP, double kI, double kD) {\\n        motor = new CANSparkMax(1, MotorType.kBrushless);\\n        absoluteEncoder = motor.getAbsoluteEncoder();\\n        pidController = motor.getPIDController();\\n\\n        absoluteEncoder.setPositionConversionFactor(Math.toRadians(360));\\n\\n        feedforward = new ArmFeedforward(Ks, Kv, Kg, Kacc);\\n\\n        pidController.setP(kP);\\n        pidController.setI(kI);\\n        pidController.setD(kD);\\n        pidController.setTolerance(0.3);\\n\\n        motor.setIdleMode(IdleMode.kCoast);\\n    }\\n\\n    public void setGoal(double radians) {\\n        setpointRadians = radians;\\n    }\\n\\n    public void moveArmToSetpoint() {\\n        double feedforwardOutput = feedforward.calculate(setpointRadians, 0, 0);\\n        pidController.setReference(setpointRadians, ControlType.kPosition, 0, feedforwardOutput);\\n    }\\n\\n    public Command armPIDcontrol(double angleRadians) {\\n        return NormalCommand.startRunEndRequirements(\\n            () -\\u0026gt; {\\n                System.out.println(\\\"ArmPIDStart\\\");\\n                this.setGoal(angleRadians);\\n            },\\n            this::moveArmToSetpoint,\\n            (interrupted) -\\u0026gt; motor.stopMotor(),\\n            () -\\u0026gt; pidController.atSetpoint()\\n        );\\n    }\\n}\\n\\u003c/code\\u003e\\u003c/pre\\u003e\\n\\u003cp\\u003eDoes this approach correctly implement feedforward and \\u003cspan class=\\\"abbreviation\\\"\\u003ePID\\u003ctemplate class=\\\"tooltiptext\\\" data-text=\\\"Proportional Integral Derivative\\\"\\u003e\\u003c/template\\u003e\\u003c/span\\u003e control? Specifically, is the usage of \\u003ccode\\u003esetReference\\u003c/code\\u003e correct, with the setpoint as the position parameter and the feedforward voltage as a separate argument? Additionally, does the \\u003ccode\\u003emoveArmToSetpoint\\u003c/code\\u003e method effectively combine feedforward and feedback control?\\u003c/p\\u003e\\n\\u003cp\\u003eThanks again for your valuable advice!\\u003c/p\\u003e\\n\\u003chr\\u003e\",\"post_number\":9,\"post_type\":1,\"posts_count\":20,\"updated_at\":\"2024-08-19T15:35:59.032Z\",\"reply_count\":1,\"reply_to_post_number\":7,\"quote_count\":0,\"incoming_link_count\":0,\"reads\":94,\"readers_count\":93,\"score\":23.8,\"yours\":false,\"topic_id\":469988,\"topic_slug\":\"feedforward-issue-with-a-sparkmax-controlled-arm-motor\",\"display_username\":\"Warrior \",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":1,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"read\":true,\"user_title\":null,\"reply_to_user\":{\"id\":22261,\"username\":\"paulonis\",\"name\":\"paulonis\",\"avatar_template\":\"/letter_avatar_proxy/v4/letter/p/5fc32e/{size}.png\"},\"bookmarked\":false,\"actions_summary\":[],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":60347,\"hidden\":false,\"trust_level\":1,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"post_url\":\"/t/feedforward-issue-with-a-sparkmax-controlled-arm-motor/469988/9\",\"custom_user_title\":null,\"reactions\":[],\"current_user_reaction\":null,\"reaction_users_count\":0,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":null},{\"id\":3416459,\"name\":\"SLAB-Mr.Thomas\",\"username\":\"SLAB-Mr.Thomas\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/slab-mr.thomas/{size}/182153_2.png\",\"created_at\":\"2024-08-19T16:31:40.521Z\",\"cooked\":\"\\u003cp\\u003eTo reiterate in one post the above advice:\\u003cbr\\u003e\\nDon’t use the WPILib \\u003ccode\\u003ecommand.ProfiledPIDSubsystem\\u003c/code\\u003e; make your own \\u003ccode\\u003esubsystem\\u003c/code\\u003e.\\u003cbr\\u003e\\nIf you want a profiled control, then do use the WPILib \\u003ccode\\u003eProfiledPIDController\\u003c/code\\u003e.\\u003c/p\\u003e\",\"post_number\":10,\"post_type\":1,\"posts_count\":20,\"updated_at\":\"2024-08-19T16:31:40.521Z\",\"reply_count\":0,\"reply_to_post_number\":null,\"quote_count\":0,\"incoming_link_count\":0,\"reads\":78,\"readers_count\":77,\"score\":30.6,\"yours\":false,\"topic_id\":469988,\"topic_slug\":\"feedforward-issue-with-a-sparkmax-controlled-arm-motor\",\"display_username\":\"SLAB-Mr.Thomas\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":1,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"read\":true,\"user_title\":\"\",\"bookmarked\":false,\"actions_summary\":[{\"id\":2,\"count\":1}],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":24594,\"hidden\":false,\"trust_level\":2,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"user_custom_fields\":{\"user_field_4\":\"\"},\"post_url\":\"/t/feedforward-issue-with-a-sparkmax-controlled-arm-motor/469988/10\",\"custom_user_title\":null,\"reactions\":[{\"id\":\"heart\",\"type\":\"emoji\",\"count\":1}],\"current_user_reaction\":null,\"reaction_users_count\":1,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":null},{\"id\":3416474,\"name\":\"paulonis\",\"username\":\"paulonis\",\"avatar_template\":\"/letter_avatar_proxy/v4/letter/p/5fc32e/{size}.png\",\"created_at\":\"2024-08-19T17:47:02.255Z\",\"cooked\":\"\\u003cp\\u003eThe setReference call looks correct.\\u003c/p\\u003e\\n\\u003cp\\u003eI don’t think the \\u003ca href=\\\"https://codedocs.revrobotics.com/java/com/revrobotics/sparkpidcontroller\\\" rel=\\\"noopener nofollow ugc\\\"\\u003e\\u003cspan class=\\\"abbreviation\\\"\\u003ePID\\u003ctemplate class=\\\"tooltiptext\\\" data-text=\\\"Proportional Integral Derivative\\\"\\u003e\\u003c/template\\u003e\\u003c/span\\u003e controller object\\u003c/a\\u003e from the SparkMAX has methods setTolerance() or atSetpoint().  You may be confusing a SparkMAX controller with a \\u003ca href=\\\"https://github.wpilib.org/allwpilib/docs/release/java/edu/wpi/first/math/controller/PIDController.html\\\" rel=\\\"noopener nofollow ugc\\\"\\u003eWPILIb PIDController\\u003c/a\\u003e.  Does VSCode complain about these calls?\\u003c/p\\u003e\\n\\u003cp\\u003eYou also need something that initializes the controller and your encoder when you enable the robot.  I’m assuming that when you enable, the arm is not perfectly parallel to the floor such that the current arm angle is 0.0 and your motor encoder should be returning 0.0.\\u003c/p\\u003e\\n\\u003cp\\u003eWith an arm, I typically keep it under closed-loop control at all times.  No matter what you are doing, whether in teleop or auto, you typically want the arm to be under control in a specific position.  If you put the controller in open-loop and stop the motor (e.g. voltage = 0), the arm is going to fall down, dramatically if you’ve got the motor set to coast.  Assuming that your NormalCommand is implementing FunctionalCommand behind the scenes and if there was a way to detect that the arm angle controller had reached setpoint to end the command, your command would stop control and let the arm fall.\\u003c/p\\u003e\",\"post_number\":11,\"post_type\":1,\"posts_count\":20,\"updated_at\":\"2024-08-19T17:47:02.255Z\",\"reply_count\":1,\"reply_to_post_number\":9,\"quote_count\":0,\"incoming_link_count\":0,\"reads\":75,\"readers_count\":74,\"score\":20.0,\"yours\":false,\"topic_id\":469988,\"topic_slug\":\"feedforward-issue-with-a-sparkmax-controlled-arm-motor\",\"display_username\":\"paulonis\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":1,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"link_counts\":[{\"url\":\"https://codedocs.revrobotics.com/java/com/revrobotics/sparkpidcontroller\",\"internal\":false,\"reflection\":false,\"title\":\"SparkPIDController (FRC-REVLib API)\",\"clicks\":0},{\"url\":\"https://github.wpilib.org/allwpilib/docs/release/java/edu/wpi/first/math/controller/PIDController.html\",\"internal\":false,\"reflection\":false,\"title\":\"PIDController (WPILib API 2024.3.2)\",\"clicks\":0}],\"read\":true,\"user_title\":\"\",\"reply_to_user\":{\"id\":60347,\"username\":\"FRCnew\",\"name\":\"Warrior \",\"avatar_template\":\"/letter_avatar_proxy/v4/letter/f/43a26b/{size}.png\"},\"bookmarked\":false,\"actions_summary\":[],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":22261,\"hidden\":false,\"trust_level\":2,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"post_url\":\"/t/feedforward-issue-with-a-sparkmax-controlled-arm-motor/469988/11\",\"custom_user_title\":null,\"reactions\":[],\"current_user_reaction\":null,\"reaction_users_count\":0,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":null},{\"id\":3416492,\"name\":\"Anand Rajamani\",\"username\":\"asid61\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/asid61/{size}/7179_2.png\",\"created_at\":\"2024-08-19T19:03:31.551Z\",\"cooked\":\"\\u003cp\\u003eYou are correct about the dictionary definition of feedforward and feedback. However, I think that the point of kG is to linearize the system and simplify controls. You could apply kG by using the current commanded trajectory point, but it’s safer to just apply kG for the position you are at. That way, if kG is larger than your other control efforts, you won’t end up in a situation where kG is fighting your controller. The motion system is linearized by using kG; your arm should act like a linear \\u003cspan class=\\\"abbreviation\\\"\\u003ePID\\u003ctemplate class=\\\"tooltiptext\\\" data-text=\\\"Proportional Integral Derivative\\\"\\u003e\\u003c/template\\u003e\\u003c/span\\u003e controller after kG is applied IMO. It’s very easy to tune kG, then add a little kP, and end up with a good arm controller. That’s not necessarily the case if you use a kG based on target position.\\u003c/p\\u003e\\n\\u003cp\\u003ePlus, applying kG at your current angle means you can implement manual overrides trivially.\\u003c/p\\u003e\",\"post_number\":12,\"post_type\":1,\"posts_count\":20,\"updated_at\":\"2024-08-19T19:03:31.551Z\",\"reply_count\":1,\"reply_to_post_number\":7,\"quote_count\":0,\"incoming_link_count\":1,\"reads\":72,\"readers_count\":71,\"score\":24.4,\"yours\":false,\"topic_id\":469988,\"topic_slug\":\"feedforward-issue-with-a-sparkmax-controlled-arm-motor\",\"display_username\":\"Anand Rajamani\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":1,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"read\":true,\"user_title\":\"\",\"reply_to_user\":{\"id\":22261,\"username\":\"paulonis\",\"name\":\"paulonis\",\"avatar_template\":\"/letter_avatar_proxy/v4/letter/p/5fc32e/{size}.png\"},\"bookmarked\":false,\"actions_summary\":[],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":21715,\"hidden\":false,\"trust_level\":2,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"user_custom_fields\":{\"user_field_4\":\"\"},\"post_url\":\"/t/feedforward-issue-with-a-sparkmax-controlled-arm-motor/469988/12\",\"custom_user_title\":null,\"reactions\":[],\"current_user_reaction\":null,\"reaction_users_count\":0,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":null},{\"id\":3416527,\"name\":\"Eli Barnett\",\"username\":\"Oblarg\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/oblarg/{size}/161674_2.png\",\"created_at\":\"2024-08-19T19:40:21.210Z\",\"cooked\":\"\\u003cp\\u003eIt really depends on signal quality and mechanism dynamics.  There’s no “right answer” but there are a lot of wrong ones (e.g. using kG feedforward without a motion profile).\\u003c/p\\u003e\\n\\u003cp\\u003eFeedback linearization w/ kG is typically “safer” than feedforward linearization as long as you don’t have a ton of sensor lag.\\u003c/p\\u003e\",\"post_number\":13,\"post_type\":1,\"posts_count\":20,\"updated_at\":\"2024-08-19T19:41:39.582Z\",\"reply_count\":0,\"reply_to_post_number\":12,\"quote_count\":0,\"incoming_link_count\":0,\"reads\":72,\"readers_count\":71,\"score\":29.4,\"yours\":false,\"topic_id\":469988,\"topic_slug\":\"feedforward-issue-with-a-sparkmax-controlled-arm-motor\",\"display_username\":\"Eli Barnett\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":1,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"read\":true,\"user_title\":\"\",\"reply_to_user\":{\"id\":21715,\"username\":\"asid61\",\"name\":\"Anand Rajamani\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/asid61/{size}/7179_2.png\"},\"bookmarked\":false,\"actions_summary\":[{\"id\":2,\"count\":1}],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":12381,\"hidden\":false,\"trust_level\":2,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"user_custom_fields\":{\"user_field_4\":\"Robot apartments! invisible suburbs! skeleton treasuries!\"},\"post_url\":\"/t/feedforward-issue-with-a-sparkmax-controlled-arm-motor/469988/13\",\"custom_user_title\":\"Robot apartments! invisible suburbs! skeleton treasuries!\",\"reactions\":[{\"id\":\"+1\",\"type\":\"emoji\",\"count\":1}],\"current_user_reaction\":null,\"reaction_users_count\":1,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":null},{\"id\":3416728,\"name\":\"Warrior \",\"username\":\"FRCnew\",\"avatar_template\":\"/letter_avatar_proxy/v4/letter/f/43a26b/{size}.png\",\"created_at\":\"2024-08-20T06:06:23.397Z\",\"cooked\":\"\\u003chr\\u003e\\n\\u003cp\\u003e\\\"We tried not to use the WPILib \\u003ccode\\u003ecommand.ProfiledPIDSubsystem\\u003c/code\\u003e and instead wrote our own code. Here’s what we came up with:\\u003c/p\\u003e\\n\\u003cpre data-code-wrap=\\\"java\\\"\\u003e\\u003ccode class=\\\"lang-java\\\"\\u003epackage frc.robot.subsystems;\\n\\nimport java.util.function.Consumer;\\n\\nimport com.revrobotics.AbsoluteEncoder;\\nimport com.revrobotics.CANSparkBase.IdleMode;\\nimport com.revrobotics.CANSparkMax;\\nimport com.revrobotics.CANSparkLowLevel.MotorType;\\nimport com.revrobotics.SparkAbsoluteEncoder.Type;\\n\\nimport edu.wpi.first.math.controller.PIDController;\\nimport edu.wpi.first.wpilibj2.command.Command;\\nimport edu.wpi.first.wpilibj2.command.SubsystemBase;\\nimport frc.robot.Commandlib.NormalCommand;\\nimport frc.robot.Constants.Inverted;\\n\\npublic class ShooterShaft extends SubsystemBase {\\n\\n    private final CANSparkMax shootershaft = new CANSparkMax(frc.robot.Constants.shootershaftClass.kshootershaftID,\\n            MotorType.kBrushless);\\n    private final CANSparkMax shootershaft2 = new CANSparkMax(frc.robot.Constants.shootershaftClass.kshootershaft2ID,\\n            MotorType.kBrushless);\\n    private final AbsoluteEncoder shootershaftEncoder;\\n    private final PIDController shootershaftPID;\\n\\n    Consumer\\u0026lt;String\\u0026gt; print = System.out::println;\\n\\n    private double Ks;\\n    private double Kv;\\n    private double Kg;\\n    private double Kacc;\\n    private double P = 0.0;\\n    private double I = 0.0;\\n    private double D = 0.0;\\n\\n    public ShooterShaft(double Ks, double Kv, double Kg, double Kacc) {\\n        this.Ks = Ks;\\n        this.Kv = Kv;\\n        this.Kg = Kg;\\n        this.Kacc = Kacc;\\n        shootershaft.restoreFactoryDefaults();\\n        shootershaft2.restoreFactoryDefaults();\\n        shootershaft.setIdleMode(IdleMode.kBrake);\\n        shootershaft2.setIdleMode(IdleMode.kBrake);\\n        shootershaft2.setInverted(Inverted.F);\\n        shootershaft.follow(shootershaft2, Inverted.T);\\n        shootershaftEncoder = shootershaft2.getAbsoluteEncoder(Type.kDutyCycle);\\n        shootershaftEncoder.setPositionConversionFactor(frc.robot.Constants.shootershaftClass.rotio);\\n        shootershaftEncoder.setInverted(Inverted.F);\\n        shootershaftPID = new PIDController(P, I, D);\\n        shootershaftPID.enableContinuousInput(-0.3, 0.3);\\n        shootershaft2.burnFlash();\\n    }\\n\\n    private void shooterShaftOutputPercentage(double outputPercentage) {\\n        shootershaft2.set(outputPercentage);\\n    }\\n\\n    /**\\n     * Calculate feedforward control output\\n     * \\n     * @param angle     Angle (radians)\\n     * @param velWanted Target velocity (rad/s)\\n     * @param accRobot  Robot acceleration (rad/s^2)\\n     * @return Feedforward control output\\n     */\\n    private double calculateFeedForward(double angle, double velWanted, double accRobot) {\\n        return Ks * Math.signum(velWanted)\\n                + Kv * velWanted\\n                + Kg * Math.cos(angle)\\n                + Kacc * accRobot * Math.sin(angle);\\n    }\\n\\n    public double shooterShaftGetposition() {\\n        return shootershaftEncoder.getPosition();\\n    }\\n\\n    public void stopMotor() {\\n        shootershaft2.stopMotor();\\n    }\\n\\n    public double getAppliedOutput() {\\n        return shootershaft2.getAppliedOutput();\\n    }\\n\\n    /**\\n     * Calculate feedforward Combine PID control output\\n     * \\n     * @param velWanted Target velocity (rad/s)\\n     * @param accRobot  Robot acceleration (rad/s^2)\\n     * @param setpoint  TargetAngle (degrees)\\n     * @return Feedforward Combine PID control output\\n     */\\n    private void armFeedForward(double setpoint, double velWanted, double accRobot) {\\n        double angleforradians = Math.toRadians(setpoint);\\n        shootershaft2.setVoltage(calculateFeedForward(angleforradians, velWanted, accRobot)\\n                + shootershaftPID.calculate(shooterShaftGetposition(), setpoint));\\n    }\\n    /**\\n     * @param outputPercentage Enter a value from 1 to -1, indicating the output percentage\\n     * @return A Command that controls the output of a manual arm at a constant percentage\\n     */\\n    public Command teloOutputShaft(double outputPercentage) {\\n        return NormalCommand.startRunEndRequirements(\\n                () -\\u0026gt; print.accept(\\\"teloControl\\\"),\\n                () -\\u0026gt; this.shooterShaftOutputPercentage(outputPercentage),\\n                (interrupted) -\\u0026gt; this.stopMotor(),\\n                () -\\u0026gt; false);\\n    }\\n    /**\\n     * \\n     * @param setpoint TargetAngle (degrees)\\n     * @return An arm control Command that uses feed-forward as the main PID as the auxiliary\\n     */\\n    public Command armFeedForwardControl(double setpoint) {\\n        return NormalCommand.startRunEndRequirements(\\n                () -\\u0026gt; print.accept(\\\"armFeedForwardControl\\\"),\\n                () -\\u0026gt; this.armFeedForward(setpoint, 0.0, 0.0),\\n                (interrupted) -\\u0026gt; this.stopMotor(),\\n                () -\\u0026gt; shootershaftPID.atSetpoint());\\n    }\\n}\\n\\u003c/code\\u003e\\u003c/pre\\u003e\\n\\u003cp\\u003eWe did indeed implement \\u003ccode\\u003eFunctionalCommand\\u003c/code\\u003e behind the scenes in \\u003ccode\\u003eNormalCommand\\u003c/code\\u003e, and we have a way to detect when the arm angle controller has reached the setpoint to end the command. However, it seems that when we do this, the arm tends to fall down. We’ve decided to add some condition to determine whether to stop the command, such as when an object is ejected…\\u003c/p\\u003e\\n\\u003cp\\u003eIf we continue the command after reaching the setpoint, would that cause any issues? Once again, thank you for your response.\\\"\\u003c/p\\u003e\\n\\u003cp\\u003e—.\\u003c/p\\u003e\",\"post_number\":14,\"post_type\":1,\"posts_count\":20,\"updated_at\":\"2024-08-20T06:06:23.397Z\",\"reply_count\":3,\"reply_to_post_number\":11,\"quote_count\":0,\"incoming_link_count\":0,\"reads\":60,\"readers_count\":59,\"score\":27.0,\"yours\":false,\"topic_id\":469988,\"topic_slug\":\"feedforward-issue-with-a-sparkmax-controlled-arm-motor\",\"display_username\":\"Warrior \",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":1,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"read\":true,\"user_title\":null,\"reply_to_user\":{\"id\":22261,\"username\":\"paulonis\",\"name\":\"paulonis\",\"avatar_template\":\"/letter_avatar_proxy/v4/letter/p/5fc32e/{size}.png\"},\"bookmarked\":false,\"actions_summary\":[],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":60347,\"hidden\":false,\"trust_level\":1,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"post_url\":\"/t/feedforward-issue-with-a-sparkmax-controlled-arm-motor/469988/14\",\"custom_user_title\":null,\"reactions\":[],\"current_user_reaction\":null,\"reaction_users_count\":0,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":null},{\"id\":3416771,\"name\":\"Anand Rajamani\",\"username\":\"asid61\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/asid61/{size}/7179_2.png\",\"created_at\":\"2024-08-20T14:01:27.013Z\",\"cooked\":\"\\u003cp\\u003eYou should be able to continue the command at the end. I find it helpful to make a default command for the arm that holds its position with kG and \\u003cspan class=\\\"abbreviation\\\"\\u003ePID\\u003ctemplate class=\\\"tooltiptext\\\" data-text=\\\"Proportional Integral Derivative\\\"\\u003e\\u003c/template\\u003e\\u003c/span\\u003e when called. This can also incorporate manual control by adding some power controlled by joystick, and setting the new target position once you release the joystick.\\u003c/p\\u003e\",\"post_number\":15,\"post_type\":1,\"posts_count\":20,\"updated_at\":\"2024-08-20T14:02:17.924Z\",\"reply_count\":0,\"reply_to_post_number\":14,\"quote_count\":0,\"incoming_link_count\":0,\"reads\":47,\"readers_count\":46,\"score\":9.4,\"yours\":false,\"topic_id\":469988,\"topic_slug\":\"feedforward-issue-with-a-sparkmax-controlled-arm-motor\",\"display_username\":\"Anand Rajamani\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":1,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"read\":true,\"user_title\":\"\",\"reply_to_user\":{\"id\":60347,\"username\":\"FRCnew\",\"name\":\"Warrior \",\"avatar_template\":\"/letter_avatar_proxy/v4/letter/f/43a26b/{size}.png\"},\"bookmarked\":false,\"actions_summary\":[],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":21715,\"hidden\":false,\"trust_level\":2,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"user_custom_fields\":{\"user_field_4\":\"\"},\"post_url\":\"/t/feedforward-issue-with-a-sparkmax-controlled-arm-motor/469988/15\",\"custom_user_title\":null,\"reactions\":[],\"current_user_reaction\":null,\"reaction_users_count\":0,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":null},{\"id\":3416776,\"name\":\"paulonis\",\"username\":\"paulonis\",\"avatar_template\":\"/letter_avatar_proxy/v4/letter/p/5fc32e/{size}.png\",\"created_at\":\"2024-08-20T14:17:31.352Z\",\"cooked\":\"\\u003cp\\u003eThere should not be an issue with continuing your angle control command once the angle has reached setpoint.  The controller needs to continue to send the necessary voltage to the arm motors to hold the arm in place.  Assuming that you have sufficient gear reduction between the motors and arm, this will be a reasonably small voltage and holding the motor shafts stationary with this voltage will not burn up the motors.\\u003c/p\\u003e\\n\\u003cp\\u003eYou need to have some way to send new setpoints to the arm.  If you are doing the control calculations in a command rather than something in periodic, one way is to make sure the arm subsystem is specified as a requirement for the command.  That way, if you send a new arm angle command, the scheduler will cancel the old one and run the new one with the new setpoint.  You could also write your command so it gets the setpoint from a double supplier allowing it to get new setpoints whenever they change in the supplier.  With this approach, you would not need to send new commands.\\u003c/p\\u003e\",\"post_number\":16,\"post_type\":1,\"posts_count\":20,\"updated_at\":\"2024-08-20T14:17:31.352Z\",\"reply_count\":1,\"reply_to_post_number\":14,\"quote_count\":0,\"incoming_link_count\":0,\"reads\":52,\"readers_count\":51,\"score\":15.4,\"yours\":false,\"topic_id\":469988,\"topic_slug\":\"feedforward-issue-with-a-sparkmax-controlled-arm-motor\",\"display_username\":\"paulonis\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":1,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"read\":true,\"user_title\":\"\",\"reply_to_user\":{\"id\":60347,\"username\":\"FRCnew\",\"name\":\"Warrior \",\"avatar_template\":\"/letter_avatar_proxy/v4/letter/f/43a26b/{size}.png\"},\"bookmarked\":false,\"actions_summary\":[],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":22261,\"hidden\":false,\"trust_level\":2,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"post_url\":\"/t/feedforward-issue-with-a-sparkmax-controlled-arm-motor/469988/16\",\"custom_user_title\":null,\"reactions\":[],\"current_user_reaction\":null,\"reaction_users_count\":0,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":null},{\"id\":3416790,\"name\":\"SLAB-Mr.Thomas\",\"username\":\"SLAB-Mr.Thomas\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/slab-mr.thomas/{size}/182153_2.png\",\"created_at\":\"2024-08-20T15:09:56.839Z\",\"cooked\":\"\\u003caside class=\\\"quote no-group\\\" data-username=\\\"FRCnew\\\" data-post=\\\"14\\\" data-topic=\\\"469988\\\"\\u003e\\n\\u003cdiv class=\\\"title\\\"\\u003e\\n\\u003cdiv class=\\\"quote-controls\\\"\\u003e\\u003c/div\\u003e\\n\\u003cimg loading=\\\"lazy\\\" alt=\\\"\\\" width=\\\"24\\\" height=\\\"24\\\" src=\\\"https://www.chiefdelphi.com/letter_avatar_proxy/v4/letter/f/43a26b/48.png\\\" class=\\\"avatar\\\"\\u003e FRCnew:\\u003c/div\\u003e\\n\\u003cblockquote\\u003e\\n\\u003cp\\u003e\\u003ccode\\u003eshootershaftPID.enableContinuousInput(-0.3, 0.3);\\u003c/code\\u003e\\u003c/p\\u003e\\n\\u003c/blockquote\\u003e\\n\\u003c/aside\\u003e\\n\\u003cp\\u003eBeware of this feature of this method:\\u003c/p\\u003e\\n\\u003cblockquote\\u003e\\n\\u003cp\\u003eRather then using the max and min input range as constraints, it considers them to be the same point and automatically calculates the shortest route to the setpoint.\\u003c/p\\u003e\\n\\u003c/blockquote\\u003e\\n\\u003cp\\u003eShortest path will break mechanisms if they were not designed to rotate continuously which most \\u003cspan class=\\\"abbreviation\\\"\\u003eFRC\\u003ctemplate class=\\\"tooltiptext\\\" data-text=\\\"FIRST Robotics Competition\\\"\\u003e\\u003c/template\\u003e\\u003c/span\\u003e mechanisms are not.\\u003c/p\\u003e\",\"post_number\":17,\"post_type\":1,\"posts_count\":20,\"updated_at\":\"2024-08-20T15:09:56.839Z\",\"reply_count\":1,\"reply_to_post_number\":14,\"quote_count\":1,\"incoming_link_count\":1,\"reads\":45,\"readers_count\":44,\"score\":34.0,\"yours\":false,\"topic_id\":469988,\"topic_slug\":\"feedforward-issue-with-a-sparkmax-controlled-arm-motor\",\"display_username\":\"SLAB-Mr.Thomas\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":1,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"read\":true,\"user_title\":\"\",\"bookmarked\":false,\"actions_summary\":[{\"id\":2,\"count\":1}],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":24594,\"hidden\":false,\"trust_level\":2,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"user_custom_fields\":{\"user_field_4\":\"\"},\"post_url\":\"/t/feedforward-issue-with-a-sparkmax-controlled-arm-motor/469988/17\",\"custom_user_title\":null,\"reactions\":[{\"id\":\"heart\",\"type\":\"emoji\",\"count\":1}],\"current_user_reaction\":null,\"reaction_users_count\":1,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":null},{\"id\":3416794,\"name\":\"Warrior \",\"username\":\"FRCnew\",\"avatar_template\":\"/letter_avatar_proxy/v4/letter/f/43a26b/{size}.png\",\"created_at\":\"2024-08-20T15:13:36.172Z\",\"cooked\":\"\\u003cp\\u003eOh, wow, I totally messed that up. Thanks for pointing it out！\\u003c/p\\u003e\",\"post_number\":18,\"post_type\":1,\"posts_count\":20,\"updated_at\":\"2024-08-20T15:13:36.172Z\",\"reply_count\":0,\"reply_to_post_number\":17,\"quote_count\":0,\"incoming_link_count\":0,\"reads\":44,\"readers_count\":43,\"score\":8.8,\"yours\":false,\"topic_id\":469988,\"topic_slug\":\"feedforward-issue-with-a-sparkmax-controlled-arm-motor\",\"display_username\":\"Warrior \",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":1,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"read\":true,\"user_title\":null,\"reply_to_user\":{\"id\":24594,\"username\":\"SLAB-Mr.Thomas\",\"name\":\"SLAB-Mr.Thomas\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/slab-mr.thomas/{size}/182153_2.png\"},\"bookmarked\":false,\"actions_summary\":[],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":60347,\"hidden\":false,\"trust_level\":1,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"post_url\":\"/t/feedforward-issue-with-a-sparkmax-controlled-arm-motor/469988/18\",\"custom_user_title\":null,\"reactions\":[],\"current_user_reaction\":null,\"reaction_users_count\":0,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":null},{\"id\":3416805,\"name\":\"Warrior \",\"username\":\"FRCnew\",\"avatar_template\":\"/letter_avatar_proxy/v4/letter/f/43a26b/{size}.png\",\"created_at\":\"2024-08-20T15:55:54.143Z\",\"cooked\":\"\\u003chr\\u003e\\n\\u003cp\\u003eUsing \\u003ccode\\u003eSupplier\\u0026lt;Double\\u0026gt;\\u003c/code\\u003e does seem like a better approach. We’ve always used a \\u003ccode\\u003edouble\\u003c/code\\u003e type for the parameter and passed a function that returns a \\u003ccode\\u003edouble\\u003c/code\\u003e, which is why we didn’t notice this issue. I still have some questions about feedforward: When the system reaches the setpoint, should we maintain the arm’s weight using just \\u003ccode\\u003ekG\\u003c/code\\u003e and \\u003cspan class=\\\"abbreviation\\\"\\u003ePID\\u003ctemplate class=\\\"tooltiptext\\\" data-text=\\\"Proportional Integral Derivative\\\"\\u003e\\u003c/template\\u003e\\u003c/span\\u003e, or is it sufficient to continuously run \\u003ccode\\u003earmFeedForwardControl()\\u003c/code\\u003e?\\u003c/p\\u003e\\n\\u003chr\\u003e\",\"post_number\":19,\"post_type\":1,\"posts_count\":20,\"updated_at\":\"2024-08-20T16:00:11.750Z\",\"reply_count\":1,\"reply_to_post_number\":16,\"quote_count\":0,\"incoming_link_count\":0,\"reads\":43,\"readers_count\":42,\"score\":13.6,\"yours\":false,\"topic_id\":469988,\"topic_slug\":\"feedforward-issue-with-a-sparkmax-controlled-arm-motor\",\"display_username\":\"Warrior \",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":1,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"read\":true,\"user_title\":null,\"reply_to_user\":{\"id\":22261,\"username\":\"paulonis\",\"name\":\"paulonis\",\"avatar_template\":\"/letter_avatar_proxy/v4/letter/p/5fc32e/{size}.png\"},\"bookmarked\":false,\"actions_summary\":[],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":60347,\"hidden\":false,\"trust_level\":1,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"post_url\":\"/t/feedforward-issue-with-a-sparkmax-controlled-arm-motor/469988/19\",\"custom_user_title\":null,\"reactions\":[],\"current_user_reaction\":null,\"reaction_users_count\":0,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":null},{\"id\":3416865,\"name\":\"paulonis\",\"username\":\"paulonis\",\"avatar_template\":\"/letter_avatar_proxy/v4/letter/p/5fc32e/{size}.png\",\"created_at\":\"2024-08-20T18:47:29.151Z\",\"cooked\":\"\\u003cp\\u003eYour armFeedForwardControl command would be better labeled armControlCommand, as you are combining feedforward and feedback control in it.  Similarly, your armFeedForward method is also combining feedforward and feedback control and might be better labeled armControl.\\u003c/p\\u003e\\n\\u003cp\\u003eBut to the point, the answer is yes, you should maintain the arm’s weight with kG and \\u003cspan class=\\\"abbreviation\\\"\\u003ePID\\u003ctemplate class=\\\"tooltiptext\\\" data-text=\\\"Proportional Integral Derivative\\\"\\u003e\\u003c/template\\u003e\\u003c/span\\u003e.  Also, yes, it is sufficient to continuously run armFeedForwardControl because what it is doing internally is maintaining the arm’s weight with kG and \\u003cspan class=\\\"abbreviation\\\"\\u003ePID\\u003ctemplate class=\\\"tooltiptext\\\" data-text=\\\"Proportional Integral Derivative\\\"\\u003e\\u003c/template\\u003e\\u003c/span\\u003e as long as the setpoint stays constant.\\u003c/p\\u003e\",\"post_number\":20,\"post_type\":1,\"posts_count\":20,\"updated_at\":\"2024-08-20T18:47:29.151Z\",\"reply_count\":0,\"reply_to_post_number\":19,\"quote_count\":0,\"incoming_link_count\":0,\"reads\":34,\"readers_count\":33,\"score\":21.8,\"yours\":false,\"topic_id\":469988,\"topic_slug\":\"feedforward-issue-with-a-sparkmax-controlled-arm-motor\",\"display_username\":\"paulonis\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":1,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"read\":true,\"user_title\":\"\",\"reply_to_user\":{\"id\":60347,\"username\":\"FRCnew\",\"name\":\"Warrior \",\"avatar_template\":\"/letter_avatar_proxy/v4/letter/f/43a26b/{size}.png\"},\"bookmarked\":false,\"actions_summary\":[{\"id\":2,\"count\":1}],\"moderator\":false,\"admin\":false,\"staff\":false,\"user_id\":22261,\"hidden\":false,\"trust_level\":2,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"post_url\":\"/t/feedforward-issue-with-a-sparkmax-controlled-arm-motor/469988/20\",\"custom_user_title\":null,\"reactions\":[{\"id\":\"heart\",\"type\":\"emoji\",\"count\":1}],\"current_user_reaction\":null,\"reaction_users_count\":1,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":null},{\"id\":3719519,\"name\":\"system\",\"username\":\"system\",\"avatar_template\":\"/uploads/default/original/4X/9/3/2/93234578e69f55873c63fc00fe2d0d85f23bce55.png\",\"created_at\":\"2025-08-20T18:47:36.344Z\",\"cooked\":\"\\u003cp\\u003eThis topic was automatically closed 365 days after the last reply. New replies are no longer allowed.\\u003c/p\\u003e\",\"post_number\":21,\"post_type\":3,\"posts_count\":20,\"updated_at\":\"2025-08-20T18:47:36.344Z\",\"reply_count\":0,\"reply_to_post_number\":null,\"quote_count\":0,\"incoming_link_count\":0,\"reads\":1,\"readers_count\":0,\"score\":0.2,\"yours\":false,\"topic_id\":469988,\"topic_slug\":\"feedforward-issue-with-a-sparkmax-controlled-arm-motor\",\"display_username\":\"system\",\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_bg_color\":null,\"flair_color\":null,\"flair_group_id\":null,\"badges_granted\":[],\"version\":1,\"can_edit\":false,\"can_delete\":false,\"can_recover\":false,\"can_see_hidden_post\":true,\"can_wiki\":false,\"read\":true,\"user_title\":\"\",\"bookmarked\":false,\"actions_summary\":[],\"moderator\":true,\"admin\":true,\"staff\":true,\"user_id\":-1,\"hidden\":false,\"trust_level\":4,\"deleted_at\":null,\"user_deleted\":false,\"edit_reason\":null,\"can_view_edit_history\":true,\"wiki\":false,\"action_code\":\"autoclosed.enabled\",\"post_url\":\"/t/feedforward-issue-with-a-sparkmax-controlled-arm-motor/469988/21\",\"custom_user_title\":null,\"reactions\":[],\"current_user_reaction\":null,\"reaction_users_count\":0,\"current_user_used_main_reaction\":false,\"can_accept_answer\":false,\"can_unaccept_answer\":false,\"accepted_answer\":false,\"topic_accepted_answer\":null}],\"stream\":[3416379,3416383,3416386,3416387,3416408,3416410,3416424,3416439,3416459,3416474,3416492,3416527,3416728,3416771,3416776,3416790,3416794,3416805,3416865,3719519]},\"timeline_lookup\":[[1,419],[4,418],[14,417],[20,52]],\"suggested_topics\":[{\"fancy_title\":\"Swerve Modules driving out of control\",\"id\":474561,\"title\":\"Swerve Modules driving out of control\",\"slug\":\"swerve-modules-driving-out-of-control\",\"posts_count\":4,\"reply_count\":2,\"highest_post_number\":4,\"image_url\":\"https://www.chiefdelphi.com/uploads/default/optimized/3X/d/6/d609d6fb740c551f839667994573618b13847a57_2_1024x394.png\",\"created_at\":\"2024-11-08T19:51:29.821Z\",\"last_posted_at\":\"2024-11-09T09:50:43.927Z\",\"bumped\":true,\"bumped_at\":\"2024-11-09T09:50:43.927Z\",\"archetype\":\"regular\",\"unseen\":false,\"pinned\":false,\"unpinned\":null,\"excerpt\":\"Problem Sometimes on enable (most of the time but not every time), the swerve modules would go really fast in a certain direction. This problem resolves itself on a power cycle (redeploying code does…\",\"visible\":true,\"closed\":false,\"archived\":false,\"bookmarked\":null,\"liked\":null,\"tags\":[],\"tags_descriptions\":{},\"like_count\":0,\"views\":309,\"category_id\":30,\"featured_link\":null,\"has_accepted_answer\":false,\"sidecar_installed\":true,\"include_dominant_colour\":false,\"topic_post_id\":3445120,\"topic_post_liked\":false,\"topic_post_can_like\":false,\"topic_post_can_unlike\":false,\"topic_post_bookmarked\":false,\"topic_post_is_current_users\":null,\"topic_post_number\":1,\"topic_post_user\":{\"id\":58215,\"username\":\"Kaicheng\",\"name\":\"Kaicheng Ouyang\",\"avatar_template\":\"/letter_avatar_proxy/v4/letter/k/c77e96/{size}.png\"},\"posters\":[{\"extras\":null,\"description\":\"Original Poster\",\"user\":{\"id\":58215,\"username\":\"Kaicheng\",\"name\":\"Kaicheng Ouyang\",\"avatar_template\":\"/letter_avatar_proxy/v4/letter/k/c77e96/{size}.png\",\"trust_level\":1}},{\"extras\":\"latest\",\"description\":\"Most Recent Poster\",\"user\":{\"id\":59306,\"username\":\"Tom_Neu\",\"name\":\"Tom\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/tom_neu/{size}/222407_2.png\",\"trust_level\":2}}]},{\"fancy_title\":\"Red Alliance April Tag Reference\",\"id\":493850,\"title\":\"Red Alliance April Tag Reference\",\"slug\":\"red-alliance-april-tag-reference\",\"posts_count\":7,\"reply_count\":3,\"highest_post_number\":7,\"image_url\":null,\"created_at\":\"2025-03-02T14:01:47.004Z\",\"last_posted_at\":\"2025-03-03T14:24:59.634Z\",\"bumped\":true,\"bumped_at\":\"2025-03-03T14:24:59.634Z\",\"archetype\":\"regular\",\"unseen\":false,\"pinned\":false,\"unpinned\":null,\"excerpt\":\"We are having a red alliance issue with our YAGSL implementation. We aren’t using Streamed Driver Input that is in the example but a custom TeleopDriveCommand. We are using the “always blue” coordin…\",\"visible\":true,\"closed\":false,\"archived\":false,\"bookmarked\":null,\"liked\":null,\"tags\":[],\"tags_descriptions\":{},\"like_count\":2,\"views\":363,\"category_id\":30,\"featured_link\":null,\"has_accepted_answer\":false,\"sidecar_installed\":true,\"include_dominant_colour\":false,\"topic_post_id\":3544823,\"topic_post_liked\":false,\"topic_post_can_like\":false,\"topic_post_can_unlike\":false,\"topic_post_bookmarked\":false,\"topic_post_is_current_users\":null,\"topic_post_number\":1,\"topic_post_user\":{\"id\":30875,\"username\":\"ericjanofski\",\"name\":\"ericjanofski\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/ericjanofski/{size}/73640_2.png\"},\"posters\":[{\"extras\":\"latest\",\"description\":\"Original Poster, Most Recent Poster\",\"user\":{\"id\":30875,\"username\":\"ericjanofski\",\"name\":\"ericjanofski\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/ericjanofski/{size}/73640_2.png\",\"trust_level\":2}},{\"extras\":null,\"description\":\"Frequent Poster\",\"user\":{\"id\":23320,\"username\":\"Owen_Busler\",\"name\":\"Owen Busler\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/owen_busler/{size}/7684_2.png\",\"trust_level\":2}},{\"extras\":null,\"description\":\"Frequent Poster\",\"user\":{\"id\":51410,\"username\":\"HarbringerOfAuroras\",\"name\":\"Maia\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/harbringerofauroras/{size}/165119_2.png\",\"trust_level\":2}},{\"extras\":null,\"description\":\"Frequent Poster\",\"user\":{\"id\":65,\"username\":\"Joe_Ross\",\"name\":\"Joe Ross\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/joe_ross/{size}/37_2.png\",\"moderator\":true,\"trust_level\":4}},{\"extras\":null,\"description\":\"Frequent Poster\",\"user\":{\"id\":51771,\"username\":\"jsjohn2000\",\"name\":\"Jason Johnson\",\"avatar_template\":\"/letter_avatar_proxy/v4/letter/j/a88e57/{size}.png\",\"trust_level\":2}}]},{\"fancy_title\":\"Joystick complaints in sim (robotpy)\",\"id\":481264,\"title\":\"Joystick complaints in sim (robotpy)\",\"slug\":\"joystick-complaints-in-sim-robotpy\",\"posts_count\":6,\"reply_count\":2,\"highest_post_number\":6,\"image_url\":null,\"created_at\":\"2025-01-12T20:59:47.736Z\",\"last_posted_at\":\"2025-01-12T23:27:44.996Z\",\"bumped\":true,\"bumped_at\":\"2025-01-12T23:27:44.996Z\",\"archetype\":\"regular\",\"unseen\":false,\"pinned\":false,\"unpinned\":null,\"excerpt\":\"\",\"visible\":true,\"closed\":false,\"archived\":false,\"bookmarked\":null,\"liked\":null,\"tags\":[\"python\"],\"tags_descriptions\":{},\"like_count\":2,\"views\":129,\"category_id\":30,\"featured_link\":null,\"has_accepted_answer\":true,\"sidecar_installed\":true,\"include_dominant_colour\":false,\"topic_post_id\":3480419,\"topic_post_liked\":false,\"topic_post_can_like\":false,\"topic_post_can_unlike\":false,\"topic_post_bookmarked\":false,\"topic_post_is_current_users\":null,\"topic_post_number\":3,\"topic_post_user\":{\"id\":65,\"username\":\"Joe_Ross\",\"name\":\"Joe Ross\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/joe_ross/{size}/37_2.png\"},\"posters\":[{\"extras\":\"latest\",\"description\":\"Original Poster, Most Recent Poster\",\"user\":{\"id\":32094,\"username\":\"CJ_Hill\",\"name\":\"CJ Hill\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/cj_hill/{size}/142363_2.png\",\"trust_level\":2}},{\"extras\":null,\"description\":\"Frequent Poster, Accepted Answer\",\"user\":{\"id\":65,\"username\":\"Joe_Ross\",\"name\":\"Joe Ross\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/joe_ross/{size}/37_2.png\",\"moderator\":true,\"trust_level\":4}},{\"extras\":null,\"description\":\"Frequent Poster\",\"user\":{\"id\":62573,\"username\":\"KfirNeuman\",\"name\":\"\",\"avatar_template\":\"/letter_avatar_proxy/v4/letter/k/d07c76/{size}.png\",\"trust_level\":2}}]},{\"fancy_title\":\"Trouble Getting SysId Logs\",\"id\":484777,\"title\":\"Trouble Getting SysId Logs\",\"slug\":\"trouble-getting-sysid-logs\",\"posts_count\":2,\"reply_count\":0,\"highest_post_number\":2,\"image_url\":\"https://www.chiefdelphi.com/uploads/default/original/3X/f/1/f1a37995cce70072a9a82c73889cedbf1e62d4cf.jpeg\",\"created_at\":\"2025-02-02T13:33:38.344Z\",\"last_posted_at\":\"2025-02-02T14:04:02.566Z\",\"bumped\":true,\"bumped_at\":\"2025-02-02T14:04:02.566Z\",\"archetype\":\"regular\",\"unseen\":false,\"pinned\":false,\"unpinned\":null,\"excerpt\":\"Hmm… I think we just need to call SignalLogger.start() Does anyone know if passing in SignalLogger to the logging portion of the sysid routine automatically do this?\",\"visible\":true,\"closed\":false,\"archived\":false,\"bookmarked\":null,\"liked\":null,\"tags\":[],\"tags_descriptions\":{},\"like_count\":0,\"views\":169,\"category_id\":30,\"featured_link\":null,\"has_accepted_answer\":true,\"sidecar_installed\":true,\"include_dominant_colour\":false,\"topic_post_id\":3499834,\"topic_post_liked\":false,\"topic_post_can_like\":false,\"topic_post_can_unlike\":false,\"topic_post_bookmarked\":false,\"topic_post_is_current_users\":null,\"topic_post_number\":2,\"topic_post_user\":{\"id\":62175,\"username\":\"sdas\",\"name\":\"Sreyan Das\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/sdas/{size}/267974_2.png\"},\"posters\":[{\"extras\":\"latest single\",\"description\":\"Original Poster, Most Recent Poster, Accepted Answer\",\"user\":{\"id\":62175,\"username\":\"sdas\",\"name\":\"Sreyan Das\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/sdas/{size}/267974_2.png\",\"trust_level\":2}}]},{\"fancy_title\":\"Phoenix 6 swerve Field centric facing angle drive not working\",\"id\":493936,\"title\":\"Phoenix 6 swerve Field centric facing angle drive not working\",\"slug\":\"phoenix-6-swerve-field-centric-facing-angle-drive-not-working\",\"posts_count\":4,\"reply_count\":2,\"highest_post_number\":4,\"image_url\":null,\"created_at\":\"2025-03-03T02:49:08.047Z\",\"last_posted_at\":\"2025-03-03T03:51:32.163Z\",\"bumped\":true,\"bumped_at\":\"2025-03-03T03:51:32.163Z\",\"archetype\":\"regular\",\"unseen\":false,\"pinned\":false,\"unpinned\":null,\"excerpt\":\"I dont see it here so I will assume its missing, you need to initialize and tune the Heading Controller of the request in order for it to public RobotContainer() { driveFacingAngle.Head…\",\"visible\":true,\"closed\":false,\"archived\":false,\"bookmarked\":null,\"liked\":null,\"tags\":[\"robot\",\"swerve\",\"phoenix-6\"],\"tags_descriptions\":{},\"like_count\":2,\"views\":110,\"category_id\":30,\"featured_link\":null,\"has_accepted_answer\":true,\"sidecar_installed\":true,\"include_dominant_colour\":false,\"topic_post_id\":3545466,\"topic_post_liked\":false,\"topic_post_like_count\":1,\"topic_post_can_like\":false,\"topic_post_can_unlike\":false,\"topic_post_bookmarked\":false,\"topic_post_is_current_users\":null,\"topic_post_number\":2,\"topic_post_user\":{\"id\":63738,\"username\":\"Rogerr079\",\"name\":\"Roger\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/rogerr079/{size}/222096_2.png\"},\"posters\":[{\"extras\":null,\"description\":\"Original Poster\",\"user\":{\"id\":56270,\"username\":\"v0ncent\",\"name\":\"Vincent Banks\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/v0ncent/{size}/258352_2.png\",\"trust_level\":2}},{\"extras\":null,\"description\":\"Frequent Poster, Accepted Answer\",\"user\":{\"id\":63738,\"username\":\"Rogerr079\",\"name\":\"Roger\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/rogerr079/{size}/222096_2.png\",\"trust_level\":2}},{\"extras\":\"latest\",\"description\":\"Most Recent Poster\",\"user\":{\"id\":48146,\"username\":\"bhall-ctre\",\"name\":\"Benjamin Hall\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/bhall-ctre/{size}/198180_2.png\",\"primary_group_name\":\"CTRE\",\"flair_name\":\"CTRE\",\"flair_url\":\"/uploads/default/original/3X/1/b/1bd2b430e1bb6427d1c6504ff6abcd31de851a6d.png\",\"flair_group_id\":57,\"trust_level\":2}}]}],\"tags\":[\"programming\"],\"tags_descriptions\":{},\"fancy_title\":\"Feedforward Issue with a SparkMAX-Controlled Arm Motor\",\"id\":469988,\"title\":\"Feedforward Issue with a SparkMAX-Controlled Arm Motor\",\"posts_count\":20,\"created_at\":\"2024-08-19T06:55:04.649Z\",\"views\":398,\"reply_count\":16,\"like_count\":7,\"last_posted_at\":\"2025-08-20T18:47:36.344Z\",\"visible\":true,\"closed\":true,\"archived\":false,\"has_summary\":false,\"archetype\":\"regular\",\"slug\":\"feedforward-issue-with-a-sparkmax-controlled-arm-motor\",\"category_id\":30,\"word_count\":3325,\"deleted_at\":null,\"user_id\":60347,\"featured_link\":null,\"pinned_globally\":false,\"pinned_at\":null,\"pinned_until\":null,\"image_url\":null,\"slow_mode_seconds\":0,\"draft\":null,\"draft_key\":\"topic_469988\",\"draft_sequence\":null,\"unpinned\":null,\"pinned\":false,\"current_post_number\":1,\"highest_post_number\":21,\"deleted_by\":null,\"actions_summary\":[{\"id\":4,\"count\":0,\"hidden\":false,\"can_act\":false},{\"id\":8,\"count\":0,\"hidden\":false,\"can_act\":false},{\"id\":10,\"count\":0,\"hidden\":false,\"can_act\":false},{\"id\":7,\"count\":0,\"hidden\":false,\"can_act\":false}],\"chunk_size\":20,\"bookmarked\":false,\"topic_timer\":null,\"message_bus_last_id\":0,\"participant_count\":6,\"show_read_indicator\":false,\"thumbnails\":null,\"slow_mode_enabled_until\":null,\"valid_reactions\":[\"heart\",\"laughing\",\"point_up\",\"+1\",\"-1\",\"100\",\"open_mouth\",\"cry\",\"question\",\"thinking\",\"call_me_hand\",\"hugs\",\"angry\"],\"user_chosen_thumbnail_url\":null,\"sidecar_installed\":true,\"can_vote\":false,\"vote_count\":0,\"user_voted\":false,\"discourse_zendesk_plugin_zendesk_id\":null,\"discourse_zendesk_plugin_zendesk_url\":\"https://your-url.zendesk.com/agent/tickets/\",\"details\":{\"can_edit\":false,\"notification_level\":1,\"participants\":[{\"id\":60347,\"username\":\"FRCnew\",\"name\":\"Warrior \",\"avatar_template\":\"/letter_avatar_proxy/v4/letter/f/43a26b/{size}.png\",\"post_count\":6,\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_color\":null,\"flair_bg_color\":null,\"flair_group_id\":null,\"trust_level\":1},{\"id\":22261,\"username\":\"paulonis\",\"name\":\"paulonis\",\"avatar_template\":\"/letter_avatar_proxy/v4/letter/p/5fc32e/{size}.png\",\"post_count\":5,\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_color\":null,\"flair_bg_color\":null,\"flair_group_id\":null,\"trust_level\":2},{\"id\":21715,\"username\":\"asid61\",\"name\":\"Anand Rajamani\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/asid61/{size}/7179_2.png\",\"post_count\":3,\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_color\":null,\"flair_bg_color\":null,\"flair_group_id\":null,\"trust_level\":2},{\"id\":24594,\"username\":\"SLAB-Mr.Thomas\",\"name\":\"SLAB-Mr.Thomas\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/slab-mr.thomas/{size}/182153_2.png\",\"post_count\":2,\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_color\":null,\"flair_bg_color\":null,\"flair_group_id\":null,\"trust_level\":2},{\"id\":57809,\"username\":\"levyishai\",\"name\":\"Yishai Levy\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/levyishai/{size}/264719_2.png\",\"post_count\":2,\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_color\":null,\"flair_bg_color\":null,\"flair_group_id\":null,\"trust_level\":2},{\"id\":12381,\"username\":\"Oblarg\",\"name\":\"Eli Barnett\",\"avatar_template\":\"/user_avatar/www.chiefdelphi.com/oblarg/{size}/161674_2.png\",\"post_count\":1,\"primary_group_name\":null,\"flair_name\":null,\"flair_url\":null,\"flair_color\":null,\"flair_bg_color\":null,\"flair_group_id\":null,\"trust_level\":2}],\"created_by\":{\"id\":60347,\"username\":\"FRCnew\",\"name\":\"Warrior \",\"avatar_template\":\"/letter_avatar_proxy/v4/letter/f/43a26b/{size}.png\"},\"last_poster\":{\"id\":-1,\"username\":\"system\",\"name\":\"system\",\"avatar_template\":\"/uploads/default/original/4X/9/3/2/93234578e69f55873c63fc00fe2d0d85f23bce55.png\"},\"links\":[{\"url\":\"https://codedocs.revrobotics.com/java/com/revrobotics/sparkpidcontroller#setReference(double,com.revrobotics.CANSparkBase.ControlType,int,double)\",\"title\":\"SparkPIDController (FRC-REVLib API)\",\"internal\":false,\"attachment\":false,\"reflection\":false,\"clicks\":8,\"user_id\":22261,\"domain\":\"codedocs.revrobotics.com\",\"root_domain\":\"revrobotics.com\"},{\"url\":\"https://www.chiefdelphi.com/t/arm-gravity-feedforward-w-neo-motors/454727\",\"title\":\"Arm Gravity Feedforward w NEO motors\",\"internal\":true,\"attachment\":false,\"reflection\":false,\"clicks\":4,\"user_id\":22261,\"domain\":\"www.chiefdelphi.com\",\"root_domain\":\"chiefdelphi.com\"},{\"url\":\"https://docs.wpilib.org/en/stable/docs/software/advanced-controls/introduction/tuning-vertical-arm.html\",\"title\":\"Tuning a Vertical Arm Position Controller — FIRST Robotics Competition documentation\",\"internal\":false,\"attachment\":false,\"reflection\":false,\"clicks\":2,\"user_id\":22261,\"domain\":\"docs.wpilib.org\",\"root_domain\":\"wpilib.org\"},{\"url\":\"https://www.reca.lc/arm\",\"title\":\"ReCalc\",\"internal\":false,\"attachment\":false,\"reflection\":false,\"clicks\":2,\"user_id\":22261,\"domain\":\"www.reca.lc\",\"root_domain\":\"reca.lc\"}]},\"bookmarks\":[]}"}
